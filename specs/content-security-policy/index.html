<!DOCTYPE html><html lang=en><head>
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
  <title>Content Security Policy</title>
  <link href=../default.css rel=stylesheet type=text/css>
  <style>
  body {
    background: url("https://www.w3.org/StyleSheets/TR/logo-ED") top left no-repeat white;
    background-attachment: fixed;
    color: black;
    font-family: sans-serif;
    margin: 0 auto;
    max-width: 50em;
    padding: 2em 1em 2em 70px;
  }
  :link { color: #00C; background: transparent }
  :visited { color: #609; background: transparent }
  a[href]:active { color: #C00; background: transparent }
  a[href]:hover { background: #ffa }

  a[href] img { border-style: none }

  h1, h2, h3, h4, h5, h6 { text-align: left }
  h1, h2, h3 { color: #005A9C; }
  h1 { font: 170% sans-serif }
  h2 { font: 140% sans-serif }
  h3 { font: 120% sans-serif }
  h4 { font: bold 100% sans-serif }
  h5 { font: italic 100% sans-serif }
  h6 { font: small-caps 100% sans-serif }

  .hide { display: none }

  div.head { margin-bottom: 1em }
  div.head h1 { margin-top: 2em; clear: both }
  div.head table { margin-left: 2em; margin-top: 2em }

  p.copyright { font-size: small }
  p.copyright small { font-size: small }

  pre { margin-left: 2em }
  dt { font-weight: bold }

  ul.toc, ol.toc {
    list-style: none;
  }
  </style>
<style>
      table {
        text-align: left;
        margin: 20px;
        width: 100%;
        border-collapse: collapse;
      }

      tbody tr:nth-child(odd) {
        background-color: #EEE;
      }

      th {
        border-bottom: 1px solid #999;
        padding: 0.5em;
      }

      td:first-child {
        width: 30%;
        padding-right: 1em;
      }

      td {
        vertical-align: top;
        padding: 0.5em;
      }

      tbody th {
        border: 0;
        background-color: #FFF;
      }

      tr.section {
        border-top: 1px solid #999;
        vertical-align: top;
      }
    </style>

    </head>
<body class=h-entry>
<div class=head>
  <p data-fill-with=logo><a class=logo href=http://www.w3.org/>
    <img alt=W3C height=48 src=https://www.w3.org/Icons/w3c_home width=72>
</a>
</p>
  <h1 class="p-name no-ref" id=title>Content Security Policy</h1>
  <h2 class="no-num no-toc no-ref heading settled" id=subtitle><span class=content>Editor’s Draft,
    <span class=dt-updated><span class=value-title title=20140819>19 August 2014</span></span></span></h2>
  <div data-fill-with=spec-metadata><dl>
	<dt>This version:
	<dd><a class=u-url href=https://w3c.github.io/webappsec/specs/content-security-policy/>https://w3c.github.io/webappsec/specs/content-security-policy/</a>
	<dt>Latest version:
	<dd><a href=http://www.w3c.org/TR/CSP/>http://www.w3c.org/TR/CSP/</a>
	<dt>Feedback:
	<dd><a href="mailto:public-webappsec@w3.org?subject=%5BCSP%5D%20feedback">public-webappsec@w3.org</a>
            with subject line
            “<kbd>[CSP] <var>… message topic …</var></kbd>”(<a href=http://lists.w3.org/Archives/Public/public-webappsec/ rel=discussion>archives</a>)
	<dt>Editors:
	<dd><dd class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:mkwst@google.com>Mike West</a> (<span class="p-org org">Google Inc.</span>)
	<dd><dd class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:w3c@adambarth.com>Adam Barth</a> (<span class="p-org org">Google Inc.</span>)
	<dd><dd class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:dveditz@mozilla.com>Dan Veditz</a> (<span class="p-org org">Mozilla Corporation</span>)
	<dt>Former Editors:
	<dd><dd class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:brandon@hackmill.com>Brandon Sterne</a> (<span class="p-org org">formerly of Mozilla Corporation</span>)
</dl>
</div>
  <div data-fill-with=warning></div>
  <p class=copyright data-fill-with=copyright><a href=http://www.w3.org/Consortium/Legal/ipr-notice#Copyright>Copyright</a> © 2014
  <a href=http://www.w3.org/><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
  (<a href=http://www.csail.mit.edu/><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
  <a href=http://www.ercim.eu/><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
  <a href=http://www.keio.ac.jp/>Keio</a>, <a href=http://ev.buaa.edu.cn/>Beihang</a>),

  All Rights Reserved.

  <abbr title="World Wide Web Consortium">W3C</abbr> <a href=http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer>liability</a>,
  <a href=http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks>trademark</a> and

  <a href=http://www.w3.org/Consortium/Legal/copyright-documents>document use</a>
  rules apply.
</p>
  <hr title="Separator for header">
</div>

<h2 class="no-num no-toc no-ref heading settled" id=abstract><span class=content>Abstract</span></h2>
<div class=p-summary data-fill-with=abstract><p>This document defines a policy language used to declare a set of content restrictions for a web resource, and a mechanism for transmitting the policy from a server to a client where the policy is enforced.</p>

</div>

<h2 class="no-num no-toc no-ref heading settled" id=status><span class=content>Status of this document</span></h2>
<div data-fill-with=status><p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

<p>
  <strong>Changes to this document may be tracked at
  <a href=https://github.com/w3c/webappsec>https://github.com/w3c/webappsec</a>.</strong>

<p>
	The (<a href=http://lists.w3.org/Archives/Public/public-webappsec/>archived</a>) public mailing list
	<a href="mailto:public-webappsec@w3.org?Subject=%5BCSP%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
	(see <a href=http://www.w3.org/Mail/Request>instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “CSP” in the subject,
	preferably like this:
	“[CSP] <em>…summary of comment…</em>”

<p>
	This document was produced by the
  <a href=http://www.w3.org/2011/webappsec/>Web Application Security Working Group</a>.

<p>
	This document was produced by a group operating under
	the <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/>5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href=http://www.w3.org/2004/01/pp-impl/49309/status rel=disclosure>public list of any patent disclosures</a>
	made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential>Essential Claim(s)</a>
	must disclose the information in accordance with <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure>section 6 of the W3C Patent Policy</a>.
</div>
<div data-fill-with=at-risk></div>

<h2 class="no-num no-toc no-ref heading settled" id=contents><span class=content>Table of Contents</span></h2>
<div data-fill-with=table-of-contents><ul class=toc>
	<li><a href=#intro><span class=secno>1</span> Introduction</a>
	<li><a href=#key-concepts><span class=secno>2</span> Key Concepts and Terminology</a>
	<li><a href=#policy-delivery><span class=secno>3</span> Policy Delivery</a>
		<ul class=toc>
		<li><a href=#content-security-policy-header-field><span class=secno>3.1</span>        <code>Content-Security-Policy</code> Header Field     </a>
		<li><a href=#content-security-policy-report-only-header-field><span class=secno>3.2</span>        <code>Content-Security-Policy-Report-Only</code> Header Field     </a>
		<li><a href=#delivery-html-meta-element><span class=secno>3.3</span>        HTML <code><span data-link-type=element title=meta>meta</span></code> Element     </a>
		<li><a href=#ch-csp-client-hint><span class=secno>3.4</span> The <code>CH-CSP</code> Client Hint</a>
		<li><a href=#enforcing-multiple-policies><span class=secno>3.5</span> Enforcing multiple policies.</a>
		<li><a href=#which-policy-applies><span class=secno>3.6</span> Policy applicability</a></ul>
	<li><a href=#syntax-and-algorithms><span class=secno>4</span> Syntax and Algorithms</a>
		<ul class=toc>
		<li><a href=#policy-syntax><span class=secno>4.1</span> Policy Syntax</a>
			<ul class=toc>
			<li><a href=#policy-parsing><span class=secno>4.1.1</span> Parsing Policies</a></ul>
		<li><a href=#source-list-syntax><span class=secno>4.2</span> Source List Syntax</a>
			<ul class=toc>
			<li><a href=#source-list-parsing><span class=secno>4.2.1</span> Parsing Source Lists</a>
			<li><a href=#match-source-expression><span class=secno>4.2.2</span> Matching Source Expressions</a>
				<ul class=toc>
				<li><a href=#source-list-guid-matching><span class=secno>4.2.2.1</span>            Security Considerations for GUID URI schemes         </a>
				<li><a href=#source-list-path-patching><span class=secno>4.2.2.2</span> Path Matching</a>
				<li><a href=#source-list-paths-and-redirects><span class=secno>4.2.2.3</span> Paths and Redirects</a></ul>
			<li><a href=#script-src-the-nonce-attribute><span class=secno>4.2.3</span>          The <code>nonce</code> attribute       </a>
			<li><a href=#source-list-valid-nonces><span class=secno>4.2.4</span> Valid Nonces</a>
			<li><a href=#source-list-valid-hashes><span class=secno>4.2.5</span> Valid Hashes</a></ul>
		<li><a href=#media-type-list><span class=secno>4.3</span> Media Type List</a>
			<ul class=toc>
			<li><a href=#media-type-list-parsing><span class=secno>4.3.1</span> Parsing</a>
			<li><a href=#media-type-list-matching><span class=secno>4.3.2</span> Matching</a></ul>
		<li><a href=#violation-reports><span class=secno>4.4</span> Reporting</a></ul>
	<li><a href=#processing-model><span class=secno>5</span> Processing Model</a>
		<ul class=toc>
		<li><a href=#processing-model-workers><span class=secno>5.1</span> Workers</a>
		<li><a href=#processing-model-iframe-srcdoc><span class=secno>5.2</span> <code>srcdoc</code> IFrames</a></ul>
	<li><a href=#script-interfaces><span class=secno>6</span> Script Interfaces</a>
		<ul class=toc>
		<li><a href=#securitypolicyviolationevent-interface><span class=secno>6.1</span>        <code>SecurityPolicyViolationEvent</code> Interface     </a>
		<li><a href=#securitypolicyviolationeventinit-interface><span class=secno>6.2</span>        <code>SecurityPolicyViolationEventInit</code> Interface     </a>
		<li><a href=#firing-securitypolicyviolationevent-events><span class=secno>6.3</span> Firing Violation Events</a></ul>
	<li><a href=#sec-directives><span class=secno>7</span> Directives</a>
		<ul class=toc>
		<li><a href=#directive-base-uri><span class=secno>7.1</span> <code>base-uri</code></a>
		<li><a href=#directive-child-src><span class=secno>7.2</span> <code>child-src</code></a>
			<ul class=toc>
			<li><a href=#directive-child-src-nested><span class=secno>7.2.1</span> Nested Browsing Contexts</a>
			<li><a href=#directive-child-src-workers><span class=secno>7.2.2</span> Workers</a></ul>
		<li><a href=#directive-connect-src><span class=secno>7.3</span> <code>connect-src</code></a>
			<ul class=toc>
			<li><a href=#connect-src-usage><span class=secno>7.3.1</span> Usage</a></ul>
		<li><a href=#directive-default-src><span class=secno>7.4</span> <code>default-src</code></a>
			<ul class=toc>
			<li><a href=#default-src-usage><span class=secno>7.4.1</span> Usage</a></ul>
		<li><a href=#directive-font-src><span class=secno>7.5</span> <code>font-src</code></a>
		<li><a href=#directive-form-action><span class=secno>7.6</span> <code>form-action</code></a>
		<li><a href=#directive-frame-ancestors><span class=secno>7.7</span> <code>frame-ancestors</code></a>
			<ul class=toc>
			<li><a href=#frame-ancestors-and-frame-options><span class=secno>7.7.1</span>          Relation to <code>X-Frame-Options</code>       </a>
			<li><a href=#frame-ancestors-multiple-source-values><span class=secno>7.7.2</span> Multiple Host Source Values</a></ul>
		<li><a href=#directive-frame-src><span class=secno>7.8</span> <code>frame-src</code></a>
		<li><a href=#directive-img-src><span class=secno>7.9</span> <code>img-src</code></a>
		<li><a href=#directive-media-src><span class=secno>7.10</span> <code>media-src</code></a>
		<li><a href=#directive-object-src><span class=secno>7.11</span> <code>object-src</code></a>
		<li><a href=#directive-plugin-types><span class=secno>7.12</span> <code>plugin-types</code></a>
			<ul class=toc>
			<li><a href=#plugin-types-usage><span class=secno>7.12.1</span> Usage</a>
			<li><a href=#plugin-types-predeclaration><span class=secno>7.12.2</span>          Predeclaration of expected media types       </a></ul>
		<li><a href=#directive-referrer><span class=secno>7.13</span> <code>referrer</code></a>
			<ul class=toc>
			<li><a href=#referrer-usage><span class=secno>7.13.1</span> Usage</a></ul>
		<li><a href=#directive-reflected-xss><span class=secno>7.14</span> <code>reflected-xss</code></a>
			<ul class=toc>
			<li><a href=#reflected-xss-and-x-xss-protection><span class=secno>7.14.1</span>          Relationship to <code>X-XSS-Protection</code>       </a></ul>
		<li><a href=#directive-report-uri><span class=secno>7.15</span> <code>report-uri</code></a>
		<li><a href=#directive-sandbox><span class=secno>7.16</span> <code>sandbox</code></a>
			<ul class=toc>
			<li><a href=#sandbox-usage><span class=secno>7.16.1</span> Usage</a></ul>
		<li><a href=#directive-script-src><span class=secno>7.17</span> <code>script-src</code></a>
			<ul class=toc>
			<li><a href=#script-src-nonce-usage><span class=secno>7.17.1</span>          Nonce usage for <code><span data-link-type=element title=script>script</span></code> elements       </a>
			<li><a href=#script-src-hash-usage><span class=secno>7.17.2</span>          Hash usage for <code><span data-link-type=element title=script>script</span></code> elements       </a></ul>
		<li><a href=#directive-style-src><span class=secno>7.18</span> <code>style-src</code></a>
			<ul class=toc>
			<li><a href=#style-src-nonce-usage><span class=secno>7.18.1</span>          Nonce usage for <code><span data-link-type=element title=style>style</span></code> elements       </a>
			<li><a href=#style-src-hash-usage><span class=secno>7.18.2</span>          Hash usage for <code><span data-link-type=element title=style>style</span></code> elements       </a></ul></ul>
	<li><a href=#examples><span class=secno>8</span> Examples</a>
		<ul class=toc>
		<li><a href=#example-policies><span class=secno>8.1</span> Sample Policy Definitions</a>
		<li><a href=#example-violation-report><span class=secno>8.2</span> Sample Violation Report</a></ul>
	<li><a href=#security-considerations><span class=secno>9</span> Security Considerations</a>
		<ul class=toc>
		<li><a href=#security-css-parsing><span class=secno>9.1</span> Cascading Style Sheet (CSS) Parsing</a>
		<li><a href=#security-violation-reports><span class=secno>9.2</span> Violation Reports</a></ul>
	<li><a href=#implementation-considerations><span class=secno>10</span> Implementation Considerations</a>
	<li><a href=#iana-considerations><span class=secno>11</span> IANA Considerations</a>
		<ul class=toc>
		<li><a href=#iana-content-security-policy><span class=secno>11.1</span> Content-Security-Policy</a>
		<li><a href=#iana-content-security-policy-report-only><span class=secno>11.2</span> Content-Security-Policy-Report-Only</a>
		<li><a href=#iana-ch-csp><span class=secno>11.3</span> CH-CSP</a></ul>
	<li><a href=#acknowledgements><span class=secno>12</span> Acknowledgements</a>
	<li><a href=#conformance><span class=secno></span> Conformance</a>
		<ul class=toc>
		<li><a href=#conventions><span class=secno></span> Document conventions</a>
		<li><a href=#conformant-algorithms><span class=secno></span> Conformant Algorithms</a>
		<li><a href=#conformance-classes><span class=secno></span> Conformance Classes</a></ul>
	<li><a href=#references><span class=secno></span>  References</a>
		<ul class=toc>
		<li><a href=#normative><span class=secno></span>  Normative References</a>
		<li><a href=#informative><span class=secno></span>  Informative References</a></ul>
	<li><a href=#index><span class=secno></span>  Index</a></ul></div>




<section>
  <h2 class="heading settled" data-level=1 id=intro><span class=secno>1 </span><span class=content>Introduction</span><a class=self-link href=#intro></a></h2>

<p><em>This section is not normative.</em></p>

<p>This document defines Content Security Policy, a mechanism web applications
  can use to mitigate a broad class of content injection vulnerabilities, such
  as cross-site scripting (XSS). Content Security Policy is a declarative policy
  that lets the authors (or server administrators) of a web application inform
  the client about the sources from which the application expects to load
  resources.</p>

<p>To mitigate XSS attacks, for example, a web application can declare that it
  only expects to load script from specific, trusted sources. This declaration
  allows the client to detect and block malicious scripts injected into the
  application by an attacker.</p>

<p>Content Security Policy (CSP) is not intended as a first line of defense
  against content injection vulnerabilities. Instead, CSP is best used as
  defense-in-depth, to reduce the harm caused by content injection attacks. As
  a first line of defense against content injection, server operators should
  validate their input and encode their output.</p>

<p>There is often a non-trivial amount of work required to apply CSP to an
  existing web application. To reap the greatest benefit, authors will need to
  move all inline script and style out-of-line, for example into external
  scripts, because the user agent cannot determine whether an inline script
  was injected by an attacker.</p>

<p>To take advantage of CSP, a web application opts into using CSP by supplying a
  <code>Content-Security-Policy</code> HTTP header. Such policies apply to the
  current resource representation only. To supply a policy for an entire site,
  the server needs to supply a policy with each resource representation.</p>
</section>


<section>
  <h2 class="heading settled" data-level=2 id=key-concepts><span class=secno>2 </span><span class=content>Key Concepts and Terminology</span><a class=self-link href=#key-concepts></a></h2>

<p>This section defines several terms used throughout the document.</p>

<p>The term <dfn data-dfn-type=dfn data-export="" id=security-policy title="security policy|policy">security policy<a class=self-link href=#security-policy></a></dfn>
  refers to either:</p>

  <ol>
    <li>a set of security preferences for restrictions within which
    the content can operate, or</li>
    <li>a fragment of text that codifies these preferences.</li>
  </ol>

<p>The security policies defined by this document are applied by a
  user agent on a <em>per-resource representation basis</em>.
  Specifically, when a user agent receives a policy along with the
  representation of a given resource, that policy applies to <em>that
  resource representation only</em>. This document often refers to
  that resource representation as the <dfn data-dfn-type=dfn data-export="" id=protected-resource>protected resource<a class=self-link href=#protected-resource></a></dfn>.</p>

<p>A <dfn data-dfn-type=dfn data-export="" id=security-policy-directive title="security policy directive|directive">security policy
  directive<a class=self-link href=#security-policy-directive></a></dfn> is a portion of a <a data-link-type=dfn href=#security-policy title=policy>policy</a> that declares the specific
  set of restrictions for a particular resource type, or which manipulates a
  specific aspect of a protected resource’s configuration. A server transmits
  its security policy for a particular protected resource as a collection of
  directives, such as <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self'</code>, each of which
  declares a specific set of restrictions for that resource as instantiated
  by the user agent. More details are provided in the
  <a data-section="" href=#sec-directives>§7 Directives</a> section.</p>

<p>A directive consists of a <dfn data-dfn-type=dfn data-noexport="" id=directive-name0>directive name<a class=self-link href=#directive-name0></a></dfn>, which
  indicates the privileges controlled by the directive, and a
  <dfn data-dfn-type=dfn data-noexport="" id=directive-value0>directive value<a class=self-link href=#directive-value0></a></dfn>, which specifies the restrictions the
  policy imposes on those privileges.</p>

  
  The term <dfn data-dfn-type=dfn data-noexport="" id=origin>origin<a class=self-link href=#origin></a></dfn> is defined in the Origin specification.
  <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc6454 title=biblio-RFC6454>[RFC6454]</a>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=globally-unique-identifier>globally unique identifier<a class=self-link href=#globally-unique-identifier></a></dfn> is defined in section 4 of
  the Origin specification. Note that URLs that do not use hierarchical
  elements as naming authorities have origins which are globally unique
  identifiers. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc6454 title=biblio-RFC6454>[RFC6454]</a></p>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=uri>URI<a class=self-link href=#uri></a></dfn> is defined in the URI specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-uri title=biblio-URI>[URI]</a></p>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=resource-representation>resource representation<a class=self-link href=#resource-representation></a></dfn> is defined
  <a href=http://tools.ietf.org/html/rfc7231#section-3>Section 3</a>
  of HTTP/1.1 -- Semantics and Content <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc7231 title=biblio-RFC7231>[RFC7231]</a></p>

<p>The terms <dfn data-dfn-type=dfn data-noexport="" id=json-object>JSON object<a class=self-link href=#json-object></a></dfn> and <dfn data-dfn-type=dfn data-noexport="" id=json-stringification>JSON stringification<a class=self-link href=#json-stringification></a></dfn> are
  defined in the JSON specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc4627 title=biblio-RFC4627>[RFC4627]</a></p>

<p>The <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#the-applet-element title=applet>applet</a></code>, <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#audio title=audio>audio</a></code>,
  <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code>, <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-iframe-element title=iframe>iframe</a></code>,
  <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-img-element title=img>img</a></code>, <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-link-element title=link>link</a></code>,
  <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code>, <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code>,
  <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-source-element title=source>source</a></code>, <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-track-element title=track>track</a></code>, and
  <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#video title=video>video</a></code> elements are defined in the HTML5
  specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=biblio-HTML5>[HTML5]</a></p>

<p>The terms <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#auxiliary-browsing-context title="auxiliary browsing contexts">auxiliary browsing contexts</a>,
  <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#opener-browsing-context title="opener browsing context">opener browsing context</a>, and <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing contexts">nested browsing contexts</a> are
  defined in the HTML5 specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=biblio-HTML5>[HTML5]</a></p>

<p>A <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#plugin title=plugin>plugin</a> is defined in the HTML5 specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=biblio-HTML5>[HTML5]</a></p>

<p>The <code><a class="production css" data-link-type=at-rule href=http://dev.w3.org/csswg/css-fonts-3/#at-font-face-rule title=@font-face>&lt;@font-face&gt;</a></code> Cascading Style Sheets (CSS) rule is defined
  in the CSS Fonts Module Level 3 specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-fonts title=biblio-CSS3-FONTS>[CSS3-FONTS]</a></p>

<p>The <code>XMLHttpRequest</code> object is defined in the
  <code>XMLHttpRequest</code> specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-xmlhttprequest title=biblio-XMLHTTPREQUEST>[XMLHTTPREQUEST]</a></p>

<p>The <code>WebSocket</code> object is defined in the <code>WebSocket</code>
  specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-websockets title=biblio-WEBSOCKETS>[WEBSOCKETS]</a></p>

<p>The <code>EventSource</code> object is defined in the <code>EventSource</code>
  specification. <a data-biblio-type=normative data-link-type=biblio href=#biblio-eventsource title=biblio-EVENTSOURCE>[EVENTSOURCE]</a></p>

<p>The Augmented Backus-Naur Form (ABNF) notation used in this document is
  specified in RFC5234. <a data-biblio-type=normative data-link-type=biblio href=#biblio-abnf title=biblio-ABNF>[ABNF]</a></p>

<p>This document also uses the ABNF extension "#rule" as defined in
  <a href=http://tools.ietf.org/html/rfc7230#section-7>Section 7</a>
  of HTTP/1.1 -- Message Syntax and Routing. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc7230 title=biblio-RFC7230>[RFC7230]</a></p>

<p>The following core rules are included by reference, as defined in
  <a href=http://tools.ietf.org/html/rfc5234#appendix-B.1>Appendix B.1</a>
  of <a data-biblio-type=normative data-link-type=biblio href=#biblio-abnf title=biblio-ABNF>[ABNF]</a>: <code>ALPHA</code> (letters), <code>DIGIT</code> (decimal
  0-9), <code>WSP</code> (white space) and <code>VCHAR</code> (printing
  characters).</p>

<p><dfn data-dfn-type=dfn data-noexport="" id=sha-256>SHA-256<a class=self-link href=#sha-256></a></dfn>, <dfn data-dfn-type=dfn data-noexport="" id=sha-384>SHA-384<a class=self-link href=#sha-384></a></dfn>, and <dfn data-dfn-type=dfn data-noexport="" id=sha-512>SHA-512<a class=self-link href=#sha-512></a></dfn> are the digest
  algorithms <a href=http://csrc.nist.gov/groups/STM/cavp/documents/shs/sha256-384-512.pdf>defined by the NIST</a>.</p>

<p>The <dfn data-dfn-type=dfn data-noexport="" id=runs-a-worker>runs a worker<a class=self-link href=#runs-a-worker></a></dfn> algorithm is
  <a href=http://www.w3.org/TR/workers/#run-a-worker>defined in the Web
  Workers spec</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-workers title=biblio-WORKERS>[WORKERS]</a></p>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=callable>callable<a class=self-link href=#callable></a></dfn> refers to an object whose interface
  has one or more <dfn data-dfn-type=dfn data-noexport="" id=callers>callers<a class=self-link href=#callers></a></dfn> as defined in the <a href=http://www.w3.org/TR/2010/WD-WebIDL-20101021/#idl-callers>Web
  IDL</a> specification <a data-biblio-type=normative data-link-type=biblio href=#biblio-webidl title=biblio-WEBIDL>[WEBIDL]</a>.</p>

<p>An <dfn data-dfn-type=dfn data-noexport="" id=http-200-response>HTTP 200 response<a class=self-link href=#http-200-response></a></dfn> is defined in
  <a href=http://tools.ietf.org/html/rfc7231#section-6.3.1>Section 6.3.1</a>
  of HTTP/1.1 -- Semantics and Content <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc7231 title=biblio-RFC7231>[RFC7231]</a></p>
</section>


<section>
  <h2 class="heading settled" data-level=3 id=policy-delivery><span class=secno>3 </span><span class=content>Policy Delivery</span><a class=self-link href=#policy-delivery></a></h2>

<p>The server delivers the policy to the user agent via an HTTP
  response header or an HTML <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a> element. Servers are
  informed that requests are subject to a policy via an HTTP request
  header.</p>

  <section>
    <h3 class="heading settled" data-level=3.1 id=content-security-policy-header-field><span class=secno>3.1 </span><span class=content>
      <code>Content-Security-Policy</code> Header Field
    </span><a class=self-link href=#content-security-policy-header-field></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-export="" id=content-security-policy>Content-Security-Policy<a class=self-link href=#content-security-policy></a></dfn></code> header field is
    the preferred mechanism for delivering a policy.</p>

    <pre>"Content-Security-Policy:" 1#<a data-link-type=dfn href=#policy-token title=policy-token>policy-token</a>
</pre>

<p>For example:</p>

    <pre class=example>Content-Security-Policy: script-src 'self'
</pre>

<p>A server MAY send more than one HTTP header field named
    <code>Content-Security-Policy</code> with a given resource
    representation.</p>

<p>A server MAY send different <code>Content-Security-Policy</code>
    header field values with different representations of the same
    resource or with different resources.</p>

<p>Upon receiving an HTTP response containing at least one
    <code>Content-Security-Policy</code> header field, the user agent
    MUST <a data-link-type=dfn href=#enforce title=enforce>enforce</a> each of the policies contained in each such
    header field.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=3.2 id=content-security-policy-report-only-header-field><span class=secno>3.2 </span><span class=content>
      <code>Content-Security-Policy-Report-Only</code> Header Field
    </span><a class=self-link href=#content-security-policy-report-only-header-field></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-export="" id=content-security-policy-report-only>Content-Security-Policy-Report-Only<a class=self-link href=#content-security-policy-report-only></a></dfn></code>
    header field lets servers experiment with policies by monitoring (rather
    than enforcing) a policy.</p>

    <pre>"Content-Security-Policy-Report-Only:" 1#<a data-link-type=dfn href=#policy-token title=policy-token>policy-token</a>
</pre>

<p>For example, server operators might wish to develop their
    security policy iteratively. The operators can deploy a report-only
    policy based on their best estimate of how their site behaves:</p>

    <pre class=example>Content-Security-Policy-Report-Only: script-src 'self'; report-uri /csp-report-endpoint/
</pre>

<p>If their site violates this policy the user agent will <a data-link-type=dfn href=#send-violation-reports title="send violation reports">send violation
    reports</a> to the URI specified in the policy’s <a data-link-type=dfn href=#report-uri title=report-uri>report-uri</a>
    directive, but allow the violating resources to load regardless. Once a site
    has confidence that the policy is appropriate, they can start enforcing the
    policy using the <code><a data-link-type=dfn href=#content-security-policy title=Content-Security-Policy>Content-Security-Policy</a></code> header field.</p>

<p>A server MAY send more than one HTTP header field named
    <code>Content-Security-Policy-Report-Only</code> with a given
    resource representation.</p>

<p>A server MAY send different
    <code>Content-Security-Policy-Report-Only</code> header field values
    with different representations of the same resource or with different
    resources.</p>

<p>Upon receiving an HTTP response containing at least one
    <code>Content-Security-Policy-Report-Only</code> header field, the
    user agent MUST <a data-link-type=dfn href=#monitor title=monitor>monitor</a> each of the policies
    contained in each such header field.</p>

<p class=note>Note: The <code><a data-link-type=dfn href=#content-security-policy-report-only title=Content-Security-Policy-Report-Only>Content-Security-Policy-Report-Only</a></code>
    header is <em>not</em> supported inside a <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code>
    element.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=3.3 id=delivery-html-meta-element><span class=secno>3.3 </span><span class=content>
      HTML <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code> Element
    </span><a class=self-link href=#delivery-html-meta-element></a></h3>

<p>The server MAY supply a policy in an HTML <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code>
    element with an <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-meta-http-equiv title=http-equiv>http-equiv</a></code> attribute that
    is a case insensitive match for the string
    "<code>Content-Security-Policy</code>". For example:</p>

    <pre class=example>&lt;meta http-equiv="Content-Security-Policy" content="script-src 'self'"&gt;
</pre>

    
    Add the following entry to the
    <a href=http://www.w3.org/TR/html5/document-metadata.html#pragma-directives>pragma directives</a>
    for the <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code> element:

    <dl>
      <dt>
        Content security policy
        (<code>http-equiv="content-security-policy"</code>)
      </dt>
      <dd>
        <ol>
          <li>If the Document’s <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-head-element title=head>head</a></code> element is
          not an ancestor of the <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code> element, abort
          these steps.</li>

          <li>If the <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code> element lacks a
          <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-meta-content title=content>content</a></code> attribute, abort these
          steps.</li>

          <li>Let <var>policy</var> be the value of the
          <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-meta-content title=content>content</a></code> attribute of the
          <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code> element.</li>

          <li>Let <var>directive-set</var> be the result of
          <a data-link-type=dfn href=#parse-the-policy title="parse the policy">parsing <var>policy</var></a>.</li>

          <li>Remove all occurrences of <code><a data-link-type=dfn href=#reflected-xss title=reflected-xss>reflected-xss</a></code>,
          <code><a data-link-type=dfn href=#report-uri title=report-uri>report-uri</a></code>, and <code><a data-link-type=dfn href=#sandbox title=sandbox>sandbox</a></code>
          directives from <var>directive-set</var>.</li>

          <li>Enforce each of the <a data-link-type=dfn href=#security-policy-directive title=directives>directives</a> in <var>directive-set</var>,
          as <a href=#sec-directives>defined for each directive type</a>.</li>
        </ol>
      </dd>
    </dl>

<p>Authors are <em>strongly encouraged</em> to place the
    <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code> element as early in the document as
    possible to reduce the risk of content injection before a protective
    policy can be read and enforced.</p>

<p class=note>Note: A <a data-link-type=dfn href=#security-policy title=policy>policy</a> specified via a <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code>
    element will be enforced along with any other policies active for the
    protected resource, regardless of where they’re specified. The general
    mechanism for determining the effect of enforcing multiple policies is
    detailed in the <a data-section="" href=#enforcing-multiple-policies>§3.5 Enforcing multiple policies.</a>
    section.</p>

<p class=note>Note: Modifications to the <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-meta-content title=content>content</a></code>
    attribute of a <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code> element after the
    element has been parsed will be ignored.</p>

<p class=note>Note: The <code><a data-link-type=dfn href=#content-security-policy-report-only title=Content-Security-Policy-Report-Only>Content-Security-Policy-Report-Only</a></code>
    header is <em>not</em> supported inside a <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code>
    element.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=3.4 id=ch-csp-client-hint><span class=secno>3.4 </span><span class=content>The <code>CH-CSP</code> Client Hint</span><a class=self-link href=#ch-csp-client-hint></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=ch-csp>CH-CSP<a class=self-link href=#ch-csp></a></dfn></code> header field indicates that a particular
    request is subject to a <a data-link-type=dfn href=#security-policy title=policy>policy</a>, and its value is defined by the
    following ABNF grammar:</p>

    <pre>"CH-CSP:" 1#<a data-link-type=dfn href=#hint-value title=hint-value>hint-value</a>
<dfn data-dfn-type=dfn data-noexport="" id=hint-value>hint-value<a class=self-link href=#hint-value></a></dfn> = *WSP "active"
</pre>

<p>If the user agent is <a data-link-type=dfn href=#monitor title=monitoring>monitoring</a> or <a data-link-type=dfn href=#enforce title=enforcing>enforcing</a> a <a data-link-type=dfn href=#security-policy title=policy>policy</a>
    that includes directives whose value is a <a data-link-type=dfn href=#source-list0 title="source list">source list</a>, and whose
    source list contains the  <code>'unsafe-redirect'</code> source expression,
    then the user agent MUST send a header field named <code>CH-CSP</code>
    along with requests for resources whose <a data-link-type=dfn href=#origin title=origin>origin</a> <em>does not</em>
    match the <a data-link-type=dfn href=#protected-resource title="protected resource">protected resource</a>’s origin. The value of this header MUST
    be <code>active</code>.</p>

<p>The user agent MAY choose to send this header only if the request is for a
    resource type which the active policy would effect. That is, given a policy
    of <code>img-src example.com 'unsafe-redirect'</code>, the user agent
    would send <code>CH-CSP: active</code> along with requests for images, but
    might choose not to send the header with requests for script.</p>

<p class=note>Note: The central reason for including this header is that it hints to a
    server that information about redirects might be leaked as a side-effect
    of a page’s active policy. If this header is present, a server might decline
    to redirect a logged-out user from <code>example.com</code> to
    <code>accounts.example.com</code>, for example, as a malicious embedder
    might otherwise be able to determine the user’s logged-in status.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=3.5 id=enforcing-multiple-policies><span class=secno>3.5 </span><span class=content>Enforcing multiple policies.</span><a class=self-link href=#enforcing-multiple-policies></a></h3>

<p><em>This section is not normative.</em></p>

<p>The above sections note that when multiple policies are present,
    each must be enforced or reported, according to its type. An example
    will help clarify how that ought to work in practice. The behavior of
    an <code>XMLHttpRequest</code> might seem unclear given a site
    that, for whatever reason, delivered the following HTTP headers:</p>

    <pre class=example>Content-Security-Policy: <a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self' http://example.com http://example.net;
                         <a data-link-type=dfn href=#connect-src title=connect-src>connect-src</a> 'none';
Content-Security-Policy: <a data-link-type=dfn href=#connect-src title=connect-src>connect-src</a> http://example.com/;
                         <a data-link-type=dfn href=#script-src title=script-src>script-src</a> http://example.com/
</pre>

<p>Is a connection to <code>example.com</code> allowed or not? The
    short answer is that the connection is not allowed. Enforcing both
    policies means that a potential connection would have to pass through
    both unscathed. Even though the second policy would allow this
    connection, the first policy contains <code><a data-link-type=dfn href=#connect-src title=connect-src>connect-src</a>
    'none'</code>, so its enforcement blocks the connection. The impact is
    that adding additional policies to the list of policies to enforce can
    only further restrict the capabilities of the protected resource.</p>

<p>To demonstrate that further, consider a script tag on this page.
    The first policy would lock scripts down to <code>'self'</code>,
    <code>http://example.com</code> and <code>http://example.net</code>
    via the <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a></code> directive. The second, however,
    would only allow script from <code>http://example.com/</code>. Script
    will only load if it meets both policy’s criteria: in this case, the only
    origin that can match is <code>http://example.com</code>, as both
    policies allow it.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=3.6 id=which-policy-applies><span class=secno>3.6 </span><span class=content>Policy applicability</span><a class=self-link href=#which-policy-applies></a></h3>

<p><em>This section is not normative.</em></p>

<p>Policies are associated with an <a data-link-type=dfn href=#protected-resource title="protected resource">protected resource</a>, and
    <a data-link-type=dfn href=#enforce title=enforce>enforced</a> or <a data-link-type=dfn href=#monitor title=monitored>monitored</a> for that resource.
    If a resource does not create a new execution context (for example, when
    including a script, image, or stylesheet into a document), then any policies
    delivered with that resource are discarded without effect. Its execution is
    subject to the policy or policies of the including context. The following
    table outlines examples of these relationships:</p>

    <table>
      <thead>
        <tr>
          <th colspan=2>Resource Type</th>
          <th>What <a data-link-type=dfn href=#security-policy title=policy>policy</a> applies?</th>
        <tr>
      </thead>
      <tbody>
        <tr class=section>
          <th rowspan=2>Top-level Contexts</th>

          <td>HTML as a new, top-level browsing context</td>
          <td>The policy delivered with the resource</td>
        </tr>
        <tr>
          <td>SVG, as a top-level document</td>
          <td>Policy delivered with the resource</td>
        </tr>

        <tr class=section>
          <th rowspan=3>Embedded Contexts</th>

          <td>
            Any resource included via <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-iframe-element title=iframe>iframe</a>,
            <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a>, or <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a>
          </td>
          <td>
            The policy of the embedding resource controls <em>what</em> may be
            embedded. The embedded resource, however, is controlled by the
            policy delivered with the resource, or the policy of the embedding
            resource if the embedded resource is a <a data-link-type=dfn href=#globally-unique-identifier title="globally unique identifier">globally unique
            identifier</a> (or a <a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-iframe-srcdoc title=srcdoc>srcdoc</a> frame).
          </td>
        </tr>
        <tr>
          <td>SVG, as an embedded document</td>
          <td>
            The policy delivered with the resource, or policy of the creating
            context if created from a <a data-link-type=dfn href=#globally-unique-identifier title="globally unique identifier">globally unique identifier</a>.
          </td>
        </tr>
        <tr>
          <td>
            JavaScript, as a Worker, Shared Worker or Service Worker
          </td>
          <td>
            The policy delivered with the resource, or policy of the creating
            context if created from a <a data-link-type=dfn href=#globally-unique-identifier title="globally unique identifier">globally unique identifier</a>
          </td>
        </tr>

        <tr class=section>
          <th rowspan=7>Subresources</th>

          <td>SVG, inlined via <a data-link-type=element href=https://svgwg.org/svg2-draft/struct.html#elementdef-svg title=svg>svg</a></td>
          <td>Policy of the including context</td>
        </tr>
        <tr>
          <td>SVG, as a resource document</td>
          <td>Policy of the including context</td>
        </tr>
        <tr>
          <td>HTML via XMLHttpRequest</td>
          <td>Policy of the context that performed the fetch</td>
        </tr>
        <tr>
          <td>Image via <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-img-element title=img>img</a> element</td>
          <td>Policy of the including context</td>
        </tr>
        <tr>
          <td>JavaScript via a <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a> element</td>
          <td>Policy of the including context</td>
        </tr>
        <tr>
          <td>SVG, via <a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-img-element title=img>img</a></td>
          <td>No policy; should be just as safe as JPG</td>
        </tr>
        <tr>
          <td>SVG, as a WebFont</td>
          <td>No policy; should be just as safe as WOFF</td>
        </tr>
      </tbody>
    </table>
  </section>
</section>


<section>
  <h2 class="heading settled" data-level=4 id=syntax-and-algorithms><span class=secno>4 </span><span class=content>Syntax and Algorithms</span><a class=self-link href=#syntax-and-algorithms></a></h2>
  <section>
    <h3 class="heading settled" data-level=4.1 id=policy-syntax><span class=secno>4.1 </span><span class=content>Policy Syntax</span><a class=self-link href=#policy-syntax></a></h3>

<p>A Content Security Policy consists of a U+003B SEMICOLON
    (<code>;</code>) delimited list of directives. Each <a data-link-type=dfn href=#security-policy-directive title=directive>directive</a>
    consists of a <a data-link-type=dfn href=#directive-name0 title="directive name">directive name</a> and (optionally) a
    <a data-link-type=dfn href=#directive-value0 title="directive value">directive value</a>, defined by the following ABNF:</p>

    <pre><dfn data-dfn-type=dfn data-noexport="" id=policy-token>policy-token<a class=self-link href=#policy-token></a></dfn>    = [ <a data-link-type=dfn href=#directive-token title=directive-token>directive-token</a> *( ";" [ <a data-link-type=dfn href=#directive-token title=directive-token>directive-token</a> ] ) ]
<dfn data-dfn-type=dfn data-noexport="" id=directive-token>directive-token<a class=self-link href=#directive-token></a></dfn> = *WSP [ <a data-link-type=dfn href=#directive-name title=directive-name>directive-name</a> [ WSP <a data-link-type=dfn href=#directive-value title=directive-value>directive-value</a> ] ]
<dfn data-dfn-type=dfn data-noexport="" id=directive-name>directive-name<a class=self-link href=#directive-name></a></dfn>  = 1*( ALPHA / DIGIT / "-" )
<dfn data-dfn-type=dfn data-noexport="" id=directive-value>directive-value<a class=self-link href=#directive-value></a></dfn> = *( WSP / &lt;VCHAR except ";" and ","&gt; )
</pre>

    <section>
      <h4 class="heading settled" data-level=4.1.1 id=policy-parsing><span class=secno>4.1.1 </span><span class=content>Parsing Policies</span><a class=self-link href=#policy-parsing></a></h4>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=parse-the-policy>parse the policy<a class=self-link href=#parse-the-policy></a></dfn> <var>policy</var>, the user agent MUST
      use an algorithm equivalent to the following:</p>

      <ol>
        <li>Let the <var>set of directives</var> be the empty set.</li>

        <li>For each non-empty token returned by
        <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#strictly-split-a-string title="strictly split a string">strictly splitting</a>
        the string <var>policy</var> on the character U+003B SEMICOLON
        (<code>;</code>):
          <ol>
            <li><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#skip-whitespace title="Skip whitespace">Skip whitespace</a>.</li>

            <li><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#collect-a-sequence-of-characters title="Collect a sequence of characters">Collect a sequence of characters</a> that are
            not <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#space-character title="space characters">space characters</a>. The collected characters
            are the <var>directive name</var>.</li>

            <li>If there are characters remaining in <var>token</var>,
            skip ahead exactly one character (which must be a
            <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#space-character title="space character">space character</a>).</li>

            <li>The remaining characters in <var>token</var> (if any) are
            the <var>directive value</var>.</li>

            <li>If the <var>set of directives</var> already contains a
            directive whose name is a case insensitive match for
            <var>directive name</var>, ignore this instance of the directive
            and continue to the next token.</li>

            <li>Add a <var>directive</var> to the <var>set of
            directives</var> with name <var>directive name</var> and value
            <var>directive value</var>.</li>
          </ol>
        </li>

        <li>Return the <var>set of directives</var>.
      </ol>
    </section>
  </section>

  <section>
    <h3 class="heading settled" data-level=4.2 id=source-list-syntax><span class=secno>4.2 </span><span class=content>Source List Syntax</span><a class=self-link href=#source-list-syntax></a></h3>

<p>Many CSP directives use a value consisting of a <dfn data-dfn-type=dfn data-noexport="" id=source-list0>source
    list<a class=self-link href=#source-list0></a></dfn>, defined in the ABNF grammar below.</p>

<p>Each <dfn data-dfn-type=dfn data-noexport="" id=source-expression0>source expression<a class=self-link href=#source-expression0></a></dfn> in the source list represents a
    location from which content of the specified type can be retrieved.
    For example, the source expression <code>'none'</code> represents
    the empty set of URIs, and the source expression
    <code>'unsafe-inline'</code> represents content supplied inline in the
    resource itself.</p>

    <pre><dfn data-dfn-type=dfn data-noexport="" id=source-list>source-list<a class=self-link href=#source-list></a></dfn>       = *WSP [ <a data-link-type=dfn href=#source-expression title=source-expression>source-expression</a> *( 1*WSP <a data-link-type=dfn href=#source-expression title=source-expression>source-expression</a> ) *WSP ]
                  / *WSP "'none'" *WSP
<dfn data-dfn-type=dfn data-noexport="" id=source-expression>source-expression<a class=self-link href=#source-expression></a></dfn> = <a data-link-type=dfn href=#scheme-source title=scheme-source>scheme-source</a> / <a data-link-type=dfn href=#host-source title=host-source>host-source</a> / <a data-link-type=dfn href=#keyword-source title=keyword-source>keyword-source</a> / <a data-link-type=dfn href=#nonce-source title=nonce-source>nonce-source</a> / <a data-link-type=dfn href=#hash-source title=hash-source>hash-source</a>
<dfn data-dfn-type=dfn data-noexport="" id=scheme-source>scheme-source<a class=self-link href=#scheme-source></a></dfn>     = <a data-link-type=dfn href=#scheme-part title=scheme-part>scheme-part</a> ":"
<dfn data-dfn-type=dfn data-noexport="" id=host-source>host-source<a class=self-link href=#host-source></a></dfn>       = [ <a data-link-type=dfn href=#scheme-part title=scheme-part>scheme-part</a> "://" ] <a data-link-type=dfn href=#host-part title=host-part>host-part</a> [ <a data-link-type=dfn href=#port-part title=port-part>port-part</a> ] [ <a data-link-type=dfn href=#path-part title=path-part>path-part</a> ]
<dfn data-dfn-type=dfn data-noexport="" id=keyword-source>keyword-source<a class=self-link href=#keyword-source></a></dfn>    = "'self'" / "'unsafe-inline'" / "'unsafe-eval'" / "'unsafe-redirect'"
<dfn data-dfn-type=dfn data-noexport="" id=base64-value>base64-value<a class=self-link href=#base64-value></a></dfn>      = 1*( ALPHA / DIGIT / "+" / "/" )*2( "=" )
<dfn data-dfn-type=dfn data-noexport="" id=nonce-value>nonce-value<a class=self-link href=#nonce-value></a></dfn>       = <a data-link-type=dfn href=#base64-value title=base64-value>base64-value</a>
<dfn data-dfn-type=dfn data-noexport="" id=hash-value>hash-value<a class=self-link href=#hash-value></a></dfn>        = <a data-link-type=dfn href=#base64-value title=base64-value>base64-value</a>
<dfn data-dfn-type=dfn data-noexport="" id=nonce-source>nonce-source<a class=self-link href=#nonce-source></a></dfn>      = "'nonce-" <a data-link-type=dfn href=#nonce-value title=nonce-value>nonce-value</a> "'"
<dfn data-dfn-type=dfn data-noexport="" id=hash-algo>hash-algo<a class=self-link href=#hash-algo></a></dfn>         = "sha256" / "sha384" / "sha512"
<dfn data-dfn-type=dfn data-noexport="" id=hash-source>hash-source<a class=self-link href=#hash-source></a></dfn>       = "'" <a data-link-type=dfn href=#hash-algo title=hash-algo>hash-algo</a> "-" <a data-link-type=dfn href=#hash-value title=hash-value>hash-value</a> "'"
<dfn data-dfn-type=dfn data-noexport="" id=scheme-part>scheme-part<a class=self-link href=#scheme-part></a></dfn>       = &lt;scheme production from <a href=http://tools.ietf.org/html/rfc3986#section-3.1>RFC 3986, section 3.1</a>&gt;
<dfn data-dfn-type=dfn data-noexport="" id=host-part>host-part<a class=self-link href=#host-part></a></dfn>         = "*" / [ "*." ] 1*<a data-link-type=dfn href=#host-char title=host-char>host-char</a> *( "." 1*<a data-link-type=dfn href=#host-char title=host-char>host-char</a> )
<dfn data-dfn-type=dfn data-noexport="" id=host-char>host-char<a class=self-link href=#host-char></a></dfn>         = ALPHA / DIGIT / "-"
<dfn data-dfn-type=dfn data-noexport="" id=path-part>path-part<a class=self-link href=#path-part></a></dfn>         = &lt;path production from <a href=http://tools.ietf.org/html/rfc3986#section-3.3>RFC 3986, section 3.3</a>&gt;
<dfn data-dfn-type=dfn data-noexport="" id=port-part>port-part<a class=self-link href=#port-part></a></dfn>         = ":" ( *DIGIT / "*" )
</pre>

<p>If the policy contains a <code><a data-link-type=dfn href=#nonce-source title=nonce-source>nonce-source</a></code> expression, the
    server MUST generate a fresh value for the <code><a data-link-type=dfn href=#nonce-value title=nonce-value>nonce-value</a></code>
    directive at random and independently each time it transmits a policy.
    This requirement ensures that the <code><a data-link-type=dfn href=#nonce-value title=nonce-value>nonce-value</a></code> is
    difficult for an attacker to predict.</p>

<p>The <code><a data-link-type=dfn href=#host-char title=host-char>host-char</a></code> production intentionally contains only
    ASCII characters; internationalized domain names cannot be entered
    directly into a policy string, but instead MUST be Punycode-encoded
    <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc3492 title=biblio-RFC3492>[RFC3492]</a>. For example, the domain <code>üüüüüü.de</code> would be
    encoded as <code>xn--tdaaaaaa.de</code>.</p>

    <section>
      <h4 class="heading settled" data-level=4.2.1 id=source-list-parsing><span class=secno>4.2.1 </span><span class=content>Parsing Source Lists</span><a class=self-link href=#source-list-parsing></a></h4>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=parse-a-source-list>parse a source list<a class=self-link href=#parse-a-source-list></a></dfn>
      <var>source list</var>, the user agent MUST use an algorithm
      equivalent to the following:</p>

      <ol>
        <li><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#strip-leading-and-trailing-whitespace title="Strip leading and trailing whitespace">Strip leading and trailing whitespace</a> from
        <var>source list</var>.</li>

        <li>If <var>source list</var> is a case insensitive match
        for the string <code>'none'</code> (including the quotation
        marks), return the empty set.</li>

        <li>Let <var>set of source expressions</var> be the empty
        set.</li>

        <li>For each token returned by
        <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#split-a-string-on-spaces title="split a string on spaces">splitting <var>source
        list</var> on spaces</a>, if the token matches the grammar for
        <code><a data-link-type=dfn href=#source-expression title=source-expression>source-expression</a></code>, add the token to the <var>set
        of source expressions</var>.</li>

      <li>Return the <var>set of source expressions</var>.</li>
      </ol>

<p class=note>Note: Characters like U+003B SEMICOLON (<code>;</code>) and
      U+002C COMMA (<code>,</code>) cannot appear in source expressions
      directly: if you’d like to include these characters in a source
      expression, they must be <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#percent-encode title="percent encode">percent
      encoded</a> as <code>%3B</code> and <code>%2C</code> respectively.</p>
    </section>

    <section>
      <h4 class="heading settled" data-level=4.2.2 id=match-source-expression><span class=secno>4.2.2 </span><span class=content>Matching Source Expressions</span><a class=self-link href=#match-source-expression></a></h4>

<p>A URI is said to <dfn data-dfn-type=dfn data-noexport="" id=match-a-source-expression>match a source expression<a class=self-link href=#match-a-source-expression></a></dfn> if the following
      algorithm returns <em>does match</em>:</p>

      <ol>
        <li>Normalize the URI according to
        <a href=http://tools.ietf.org/html/rfc3986#section-6>Section 6 of
        RFC3986</a>.</li>

        <li>If the source expression a consists of a single U+002A ASTERISK
        character (<code>*</code>), and the URI’s scheme is not of a type
        designating a <a data-link-type=dfn href=#globally-unique-identifier title="globally unique identifier">globally unique identifier</a>, (such as
        <code>blob:</code>, <code>data:</code>, or <code>filesystem:</code>)
        then return <em>does match</em>.</li>

        <li>If the source expression matches the grammar for
        <code><a data-link-type=dfn href=#scheme-source title=scheme-source>scheme-source</a></code>:
          <ol>
            <li>If the URI’s scheme is a case-insensitive match for the
            source expression’s <code><a data-link-type=dfn href=#scheme-part title=scheme-part>scheme-part</a></code>, return
            <em>does match</em>.</li>

            <li>Otherwise, return <em>does not match</em>.</li>
          </ol>
        </li>
        <li>If the source expression matches the grammar for
        <code><a data-link-type=dfn href=#host-source title=host-source>host-source</a></code>:
          <ol>
            <li>If the URI does <strong>not</strong> contain a host, then
            return <em>does not match</em>.</li>

            <li>Let <var>uri-scheme</var>, <var>uri-host</var>, and
            <var>uri-port</var> be the scheme, host, and port of the URI,
            respectively. If the URI does not have a port, then let
            <var>uri-port</var> be the default port for
            <var>uri-scheme</var>. Let <var>uri-path</var> be
            the path of the URI after
            <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#percent-decode title="percent decode">decoding
            percent-encoded characters</a>. If the URI does not have a
            path, then let <var>uri-path</var> be the U+002F SOLIDUS
            character (<code>/</code>).</li>

            <li>If the source expression has a <code><a data-link-type=dfn href=#scheme-part title=scheme-part>scheme-part</a></code>
            that is not a case insensitive match for <var>uri-scheme</var>,
            then return <em>does not match</em>.</li>

            <li>If the source expression does <strong>not</strong> have a
            scheme, return <em>does not match</em> if
              <ol>
                <li>the scheme of the protected resource’s URI is a case
                insensitive match for <code>HTTP</code>, and
                <var>uri-scheme</var> is <strong>not</strong> a case
                insensitive match for either <code>HTTP</code> or
                <code>HTTPS</code></li>
                <li>the scheme of the protected resource’s URI is
                <strong>not</strong> a case insensitive match for
                <code>HTTP</code>, and <var>uri-scheme</var> is
                <strong>not</strong> a case insensitive match
                for the scheme of the protected resource’s URI.</li>
              </ol>
            </li>

            <li>If the first character of the source expression’s
            <code><a data-link-type=dfn href=#host-part title=host-part>host-part</a></code> is an U+002A ASTERISK character
            (<code>*</code>) and the remaining characters, including the
            leading U+002E FULL STOP character (<code>.</code>), are not a
            case insensitive match for the rightmost characters of
            <var>uri-host</var>, then return <em>does not match</em>.</li>

            <li>If the first character of the source expression’s
            <code><a data-link-type=dfn href=#host-part title=host-part>host-part</a></code> is <em>not</em> an U+002A ASTERISK
            character (<code>*</code>) and <var>uri-host</var> is not a
            case insensitive match for the source expression’s
            <code><a data-link-type=dfn href=#host-part title=host-part>host-part</a></code>, then return <em>does not
            match</em>.</li>

            <li>If the source expression does <strong>not</strong> contain
            a <code>port-part</code> and <var>uri-port</var> is not the
            default port for <var>uri-scheme</var>, then return <em>does not
            match</em>.</li>

            <li>If the source expression does contain a
            <code>port-part</code>, then return <em>does not match</em> if
              <ol>
                <li><code><a data-link-type=dfn href=#port-part title=port-part>port-part</a></code> does <strong>not</strong>
                contain an U+002A ASTERISK character (<code>*</code>),
                and</li>

                <li><code><a data-link-type=dfn href=#port-part title=port-part>port-part</a></code> does <strong>not</strong>
                represent the same number as <var>uri-port</var>.</li>
              </ol>
            </li>

            <li>If the source expression contains a non-empty
            <code><a data-link-type=dfn href=#path-part title=path-part>path-part</a></code>, and the URI is <em>not</em> the
            result of a redirect, then:
              <ol>
                <li>Let <var>decoded-path</var> be the result of
                <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#percent-decode title="percent decode">decoding
                <code>path-part</code>’s percent-encoded characters</a>.</li>

                <li>If the final character of <var>decoded-path</var> is
                the U+002F SOLIDUS character (<code>/</code>), and
                <var>decoded-path</var> is not a prefix of
                <var>uri-path</var>, then return <em>does not
                match</em>.</li>

                <li>If the final character of <var>decoded-path</var> is
                not the U+002F SOLIDUS character (<code>/</code>),
                and <var>decoded-path</var> is not an exact match for
                <var>uri-path</var> then return <em>does not
                match</em>.</li>
              </ol>
            </li>

            <li>Otherwise, return <em>does match</em>.</li>
          </ol>
        </li>

        <li>If the source expression is a case insensitive
        match for <code>'self'</code> (including the quotation marks),
        then:
          <ol>
            <li>Return <em>does match</em> if the URI has the same scheme,
            host, and port as the protected resource’s URI (using the
            default port for the appropriate scheme if either or both URIs
            are missing ports).</li>
          </ol>
        </li>

        <li>Otherwise, return <em>does not match</em>.</li>
      </ol>

<p>A URI is said to <dfn data-dfn-type=dfn data-noexport="" id=match-a-source-list>match a source list<a class=self-link href=#match-a-source-list></a></dfn> if the following
      conditions are met:</p>

      <ol>
        <li>
          The URI <a data-link-type=dfn href=#match-a-source-expression title="match a source expression">matches at least one
          source expression</a> in the set of source expressions obtained by
          <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the source list</a>.
        </li>
        <li>
          At least one of the following is true:

          <ol>
            <li>
              The URI is one of  <strong>not</strong> the result of a redirect.
            </li>
            <li>
              The set of source expressions obtained by
              <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the source list</a>
              contains the source expression <code>'unsafe-redirect'</code>.
            </li>
            <li>
              The source list is the U+002A ASTERISK character (<code>*</code>).
            </li>
          </ol>
        </li>
      </ol>

<p class=note>Note: No URIs match an empty set of source expressions, such as the set
      obtained by parsing the source list <code>'none'</code>.</p>

      <section class=informative>
        <h5 class="heading settled" data-level=4.2.2.1 id=source-list-guid-matching><span class=secno>4.2.2.1 </span><span class=content>
          Security Considerations for GUID URI schemes
        </span><a class=self-link href=#source-list-guid-matching></a></h5>

<p><em>This section is not normative.</em></p>

<p>As defined above, special URI schemes that refer to specific pieces of
        unique content, such as "data:", "blob:" and "filesystem:" are
        excluded from matching a policy of <code>*</code> and must be
        explicitly listed. Policy authors should note that the content of
        such URIs is often derived from a response body or execution in a
        Document context, which may be unsafe. Especially for the
        <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a></code> and <code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code>
        directives, policy authors should be aware that allowing "data:" URIs
        is equivalent to <code>unsafe-inline</code> and allowing "blob:" or
        "filesystem:" URIs is equivalent to <code>unsafe-eval</code>.</p>
      </section>

      <section class=informative>
        <h5 class="heading settled" data-level=4.2.2.2 id=source-list-path-patching><span class=secno>4.2.2.2 </span><span class=content>Path Matching</span><a class=self-link href=#source-list-path-patching></a></h5>

<p><em>This section is not normative.</em></p>

<p>The rules for matching source expressions that contain paths
        are simpler than they look: paths that end with the <code>'/'</code>
        character match all files in a directory and its subdirectories. Paths
        that do not end with the <code>'/'</code> character match only one
        specific file. A few examples should make this clear:</p>

        <ol>
          <li>The source expression <code>example.com</code> has no path,
          and therefore matches any file served from that host.</li>

          <li>The source expression <code>example.com/scripts/</code>
          matches any file in the <code>scripts</code> directory of
          <code>example.com</code>, and any of its subdirectories. For
          example, both <code>https://example.com/scripts/file.js</code>
          and <code>https://example.com/scripts/js/file.js</code> would
          match.</li>

          <li>The source expression
          <code>example.com/scripts/file.js</code> matches only the file
          named <code>file.js</code> in the <code>scripts</code> directory
          of <code>example.com</code>.</li>

          <li>Likewise, the source expression <code>example.com/js</code>
          matches only the file named <code>js</code>. In particular, note
          that it would not match files inside a directory named
          <code>js</code>. Files like <code>example.com/js/file.js</code>
          would be matched only if the source expression ended with a
          trailing "/", as in <code>example.com/js/</code>.</li>
        </ol>

<p class=note>Note: Query strings have no impact on matching: the source
        expression <code>example.com/file?key=value</code> matches all of
        <code>https://example.com/file</code>,
        <code>https://example.com/file?key=value</code>,
        <code>https://example.com/file?key=notvalue</code>, and
        <code>https://example.com/file?notkey=notvalue</code>.</p>
      </section>
      <section class=informative>
        <h5 class="heading settled" data-level=4.2.2.3 id=source-list-paths-and-redirects><span class=secno>4.2.2.3 </span><span class=content>Paths and Redirects</span><a class=self-link href=#source-list-paths-and-redirects></a></h5>

<p>To avoid leaking path information cross-origin (as discussed
        in Egor Homakov’s
        <a href=http://homakov.blogspot.de/2014/01/using-content-security-policy-for-evil.html>Using Content-Security-Policy for Evil</a>),
        the matching algorithm ignores the path component of a source
        expression if the resource being loaded is the result of a
        redirect. For example, given a page with an active policy of
        <code><a data-link-type=dfn href=#img-src title=img-src>img-src</a> example.com not-example.com/path</code>:</p>

        <ul>
          <li>Directly loading <code>https://not-example.com/not-path</code>
          would fail, as it doesn’t match the policy.</li>
          <li>Directly loading <code>https://example.com/redirector</code>
          would pass, as it matches <code>example.com</code>.</li>
          <li>Assuming that <code>https://example.com/redirector</code>
          delivered a redirect response pointing to <code>https://not-example.com/not-path</code>,
          the load would succeed, as the initial URL matches <code>example.com</code>,
          and the redirect target matches <code>not-example.com/path</code>
          if we ignore its path component.</li>
        </ul>

<p>This restriction reduces the granularity of a document’s
        policy when redirects are in play, which isn’t wonderful, but
        given that we certainly don’t want to allow brute-forcing paths
        after redirects, it seems a reasonable compromise.</p>

<p>The relatively long thread
        <a href=http://lists.w3.org/Archives/Public/public-webappsec/2014Feb/0036.html>"Remove paths from CSP?"</a>
        from public-webappsec@w3.org has more detailed discussion around
        alternate proposals.</p>
      </section>
    </section>

    <section>
      <h4 class="heading settled" data-level=4.2.3 id=script-src-the-nonce-attribute><span class=secno>4.2.3 </span><span class=content>
        The <code>nonce</code> attribute
      </span><a class=self-link href=#script-src-the-nonce-attribute></a></h4>

<p>Nonce sources require a new attribute to be added to both
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> and <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-style-element title=style>style</a></code>
      elements: <code><dfn data-dfn-type=element-attr data-export="" id=element-attrdef-nonce>nonce<a class=self-link href=#element-attrdef-nonce></a></dfn></code>.</p>

      <pre class=idl>partial interface <a class=idl-code data-global-name="" data-link-type=interface href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#htmlscriptelement title=HTMLScriptElement>HTMLScriptElement</a> {
  attribute DOMString <a class=idl-code data-global-name="HTMLScriptElement<interface>/nonce<attribute>" data-link-for=HTMLScriptElement data-link-type=attribute data-type="DOMString " href=#dom-htmlscriptelement-nonce title=nonce>nonce</a>;
};
</pre>
      <dl data-dfn-for=HTMLScriptElement>
        <dt><dfn class=idl-code data-dfn-for=HTMLScriptElement data-dfn-type=attribute data-export="" id=dom-htmlscriptelement-nonce>nonce<a class=self-link href=#dom-htmlscriptelement-nonce></a></dfn></dt>
        <dd>This attribute <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#reflect title=reflects>reflects</a> the value of the
        element’s <code><a data-link-type=element-attr href=#element-attrdef-nonce title=nonce>nonce</a></code> content attribute.</dd>
      </dl>
      <pre class=idl>partial interface <a class=idl-code data-global-name="" data-link-type=interface href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#htmlstyleelement title=HTMLStyleElement>HTMLStyleElement</a> {
  attribute DOMString <a class=idl-code data-global-name="HTMLStyleElement<interface>/nonce<attribute>" data-link-for=HTMLStyleElement data-link-type=attribute data-type="DOMString " href=#dom-htmlstyleelement-nonce title=nonce>nonce</a>;
};
</pre>
      <dl data-dfn-for=HTMLStyleElement>
        <dt><dfn class=idl-code data-dfn-for=HTMLStyleElement data-dfn-type=attribute data-export="" id=dom-htmlstyleelement-nonce>nonce<a class=self-link href=#dom-htmlstyleelement-nonce></a></dfn></dt>
        <dd>This attribute <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#reflect title=reflects>reflects</a> the value of the
        element’s <code><a data-link-type=element-attr href=#element-attrdef-nonce title=nonce>nonce</a></code> content attribute.</dd>
      </dl>

    </section>

    <section>
      <h4 class="heading settled" data-level=4.2.4 id=source-list-valid-nonces><span class=secno>4.2.4 </span><span class=content>Valid Nonces</span><a class=self-link href=#source-list-valid-nonces></a></h4>

<p>An element has a <dfn data-dfn-type=dfn data-noexport="" id=valid-nonce>valid nonce<a class=self-link href=#valid-nonce></a></dfn> for a <var>set of source
      expressions</var> if the value of the element’s
      <code><a data-link-type=element-attr href=#element-attrdef-nonce title=nonce>nonce</a></code> attribute after
      <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#strip-leading-and-trailing-whitespace title="strip leading and trailing whitespace">stripping
      leading and trailing whitespace</a> is a case-sensitive match for the
      <code><a data-link-type=dfn href=#nonce-value title=nonce-value>nonce-value</a></code> component of at least one
      <code><a data-link-type=dfn href=#nonce-source title=nonce-source>nonce-source</a></code> expression in <var>set of source
      expressions</var>.</p>
    </section>

    <section>
      <h4 class="heading settled" data-level=4.2.5 id=source-list-valid-hashes><span class=secno>4.2.5 </span><span class=content>Valid Hashes</span><a class=self-link href=#source-list-valid-hashes></a></h4>

<p>An <dfn data-dfn-type=dfn data-noexport="" id=elements-content>element’s content<a class=self-link href=#elements-content></a></dfn> is <a data-link-spec=HTML5 data-link-type=dfn href="http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#the-script-block's-source" title="the script block’s source">the script block’s
      source</a> for <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> elements, or the
      value of the element’s
      <code><a class=idl-code data-link-for=Node data-link-type=attribute href=http://dom.spec.whatwg.org/#dom-node-textcontent title=textContent>textContent</a></code>
      IDL attribute for non-<code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> elements such as
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-style-element title=style>style</a></code>.</p>

<p>The <dfn data-dfn-type=dfn data-noexport="" id=digest-of-elements-content>digest of <var>element</var>’s content<a class=self-link href=#digest-of-elements-content></a></dfn> for is the result
      of applying an <var>algorithm</var> to the <a data-link-type=dfn href=#elements-content title="element’s content">element’s content</a>.</p>

<p>To determine whether <var>element</var> has a <dfn data-dfn-type=dfn data-noexport="" id=valid-hash>valid hash<a class=self-link href=#valid-hash></a></dfn> for
      a <var>set of source expressions</var>, execute the following steps:</p>

      <ol>
        <li>Let <var>hashes</var> be a list of all
        <code><a data-link-type=dfn href=#hash-source title=hash-source>hash-source</a></code> expressions in <var>set of source
        expressions</var>.</li>

        <li>For each <var>hash</var> in <var>hashes</var>:
          <ol>
            <li>Let <var>algorithm</var> be:
              <ul>
                <li><a data-link-type=dfn href=#sha-256 title=SHA-256>SHA-256</a> if the <code><a data-link-type=dfn href=#hash-algo title=hash-algo>hash-algo</a></code>
                component of <var>hash</var> is a case-insensitive match for
                the string "sha256"</li>

                <li><a data-link-type=dfn href=#sha-384 title=SHA-384>SHA-384</a> if the <code><a data-link-type=dfn href=#hash-algo title=hash-algo>hash-algo</a></code>
                component of <var>hash</var> is a case-insensitive match for
                the string "sha384"</li>

                <li><a data-link-type=dfn href=#sha-512 title=SHA-512>SHA-512</a> if the <code><a data-link-type=dfn href=#hash-algo title=hash-algo>hash-algo</a></code>
                component of <var>hash</var> is a case-insensitive match for
                the string "sha512"</li>
              </ul>
            </li>

            <li>Let <var>expected</var> be the <code><a data-link-type=dfn href=#hash-value title=hash-value>hash-value</a></code>
            component of <var>hash</var>.</li>

            <li>Let <var>actual</var> be the
            <a href=http://tools.ietf.org/html/rfc4648#section-4>base64
            encoding</a> of the binary <a data-link-type=dfn href=#digest-of-elements-content title="digest of element’s content">digest of <var>element</var>’s
            content</a> using the <var>algorithm</var> algorithm.</li>

            <li>If <var>actual</var> is a case-sensitive match for
            <var>expected</var>, return <strong>true</strong> and abort these
            steps.</li>
          </ol>
        </li>
        <li>Return <strong>false</strong>.</li>
      </ol>

<p class=note>Note: If an element has an invalid hash, it would be helpful
      if the user agent reported the failure to the author by adding
      a warning message containing the <var>actual</var> hash value.</p>
    </section>
  </section>
  <section>
    <h3 class="heading settled" data-level=4.3 id=media-type-list><span class=secno>4.3 </span><span class=content>Media Type List</span><a class=self-link href=#media-type-list></a></h3>

<p>The <code><a data-link-type=dfn href=#plugin-types title=plugin-types>plugin-types</a></code> directive uses a value consisting
    of a <dfn data-dfn-type=dfn data-noexport="" id=media-type-list0>media type list<a class=self-link href=#media-type-list0></a></dfn>.</p>

<p>Each <dfn data-dfn-type=dfn data-noexport="" id=media-type0>media type<a class=self-link href=#media-type0></a></dfn> in the media type list represents a specific
    type of resource that can be retrieved and used to instantiate a
    <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#plugin title=plugin>plugin</a> in the protected resource.</p>

    <pre><dfn data-dfn-type=dfn data-noexport="" id=media-type-list1>media-type-list<a class=self-link href=#media-type-list1></a></dfn>   = <a data-link-type=dfn href=#media-type title=media-type>media-type</a> *( 1*WSP <a data-link-type=dfn href=#media-type title=media-type>media-type</a> )
<dfn data-dfn-type=dfn data-noexport="" id=media-type>media-type<a class=self-link href=#media-type></a></dfn>        = &lt;type from RFC 2045&gt; "/" &lt;subtype from RFC 2045&gt;
</pre>

    <section>
      <h4 class="heading settled" data-level=4.3.1 id=media-type-list-parsing><span class=secno>4.3.1 </span><span class=content>Parsing</span><a class=self-link href=#media-type-list-parsing></a></h4>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=parse-a-media-type-list>parse a media type list<a class=self-link href=#parse-a-media-type-list></a></dfn> <var>media type list</var>, the
      user agent MUST use an algorithm equivalent to the following:</p>

      <ol>
        <li>Let the <var>set of media types</var> be the empty set.</li>

        <li>For each token returned by
        <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#split-a-string-on-spaces title="split a string on spaces">splitting
        <var>media type list</var> on spaces</a>, if the token matches the
        grammar for <code><a data-link-type=dfn href=#media-type title=media-type>media-type</a></code>, add the token to the
        <var>set of media types</var>. Otherwise ignore the token.</li>

        <li>Return the <var>set of media types</var>.</li>
      </ol>
    </section>

    <section>
      <h4 class="heading settled" data-level=4.3.2 id=media-type-list-matching><span class=secno>4.3.2 </span><span class=content>Matching</span><a class=self-link href=#media-type-list-matching></a></h4>

<p>A media type <dfn data-dfn-type=dfn data-noexport="" id=match-a-media-type-list title="match a media type list">matches a media type
      list<a class=self-link href=#match-a-media-type-list></a></dfn> if, and only if, the media type is a case-insensitive match for
      at least one token in the set of media types obtained by
      <a data-link-type=dfn href=#parse-a-media-type-list title="parse a media type list">parsing the media type list</a>.</p>
    </section>
  </section>
  <section>
    <h3 class="heading settled" data-level=4.4 id=violation-reports><span class=secno>4.4 </span><span class=content>Reporting</span><a class=self-link href=#violation-reports></a></h3>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=strip-uri-for-reporting title="strip uri for reporting|stripped for reporting">strip
    <var>uri</var> for reporting<a class=self-link href=#strip-uri-for-reporting></a></dfn>, the user agent MUST use an
    algorithm equivalent to the following:</p>

    <ol>
      <li>If the <a data-link-type=dfn href=#origin title=origin>origin</a> of <var>uri</var> is a <a data-link-type=dfn href=#globally-unique-identifier title="globally unique identifier">globally unique
      identifier</a> (for example, <var>uri</var> has a scheme of
      <code>data</code>, <code>blob</code>, or <code>filesystem</code>), then
      abort these steps, and return the ASCII serialization of
      <var>uri</var>’s scheme.</li>

      <li>If the <a data-link-type=dfn href=#origin title=origin>origin</a> of <var>uri</var> is not the same as the
      <a data-link-type=dfn href=#origin title=origin>origin</a> of the protected resource, then abort these steps, and
      return the
      <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#ascii-serialization-of-an-origin title="ascii serialization of an origin">ASCII
      serialization of <var>uri</var>’s origin</a>.</li>

      <li>Return <var>uri</var>, with any <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#concept-url-fragment title=fragment>fragment</a>
      component removed.</li>
    </ol>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=generate-a-violation-report-object title="generate a violation report object|generating a violation report object">generate a violation report object<a class=self-link href=#generate-a-violation-report-object></a></dfn>,
    the user agent MUST use an algorithm equivalent to the following:</p>

    <ol>
      <li>Prepare a JSON object <var>violation</var> with the
      following keys and values:

        <dl>
          <dt id=violation-report-blocked-uri><a class=self-link href=#violation-report-blocked-uri></a>blocked-uri</dt>
          <dd>The originally requested URI of the resource that was
          prevented from loading, <a data-link-type=dfn href=#strip-uri-for-reporting title="stripped for reporting">stripped for reporting</a>,
          or the empty string if the resource has no URI (inline script and
          inline style, for example).</dd>

          <dt id=violation-report-document-uri><a class=self-link href=#violation-report-document-uri></a>document-uri</dt>
          <dd>The <a data-link-spec=HTML5 data-link-type=dfn href="http://www.w3.org/html/wg/drafts/html/CR/dom.html#the-document's-address" title="the document’s address">address</a>
          of the protected resource, <a data-link-type=dfn href=#strip-uri-for-reporting title="stripped for reporting">stripped for reporting</a>.</dd>

          <dt id=violation-report-effective-directive><a class=self-link href=#violation-report-effective-directive></a>effective-directive</dt>
          <dd>The name of the policy directive that was violated. This will
          contain the <a data-link-type=dfn href=#security-policy-directive title=directive>directive</a> whose enforcement triggered the
          violation (e.g. "<code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code>") even if that
          directive does not explicitly appear in the policy, but is
          implicitly activated via the <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a></code>
          directive.</dd>

          <dt id=violation-report-original-policy><a class=self-link href=#violation-report-original-policy></a>original-policy</dt>
          <dd>The original <a data-link-type=dfn href=#security-policy title=policy>policy</a>, as received by the user agent.</dd>

          <dt id=violation-report-referrer><a class=self-link href=#violation-report-referrer></a>referrer</dt>
          <dd>The <a class=idl-code data-link-for=Document data-link-type=attribute href=http://www.w3.org/html/wg/drafts/html/CR/dom.html#dom-document-referrer title=referrer>referrer</a> attribute of the protected
          resource, or the empty string if the protected resource has no
          referrer.</dd>

          <dt id=violation-report-status-code><a class=self-link href=#violation-report-status-code></a>status-code</dt>
          <dd>The <code>status-code</code> of the HTTP response that
          contained the protected resource, if the protected resource was
          obtained over HTTP. Otherwise, the number 0.</dd>

          <dt id=violation-report-violated-directive><a class=self-link href=#violation-report-violated-directive></a>violated-directive</dt>
          <dd>The policy directive that was violated, as it appears in the
          policy. This will contain the <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a></code> directive
          in the case of violations caused by falling back to the
          <a data-link-type=dfn href=#default-sources title="default sources">default sources</a> when enforcing
          a directive.</dd>
        </dl>
      </li>

      <li>If a specific line or a specific file can be identified as the
      cause of the violation (for example, script execution that violates
      the <code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code> directive), the user agent MAY add the
      following keys and values to <var>violation</var>:

        <dl>
          <dt id=violation-report-source-file><a class=self-link href=#violation-report-source-file></a><dfn data-dfn-type=dfn data-noexport="" id=source-file>source-file<a class=self-link href=#source-file></a></dfn></dt>
          <dd>The URI of the resource where the violation occurred,
          <a data-link-type=dfn href=#strip-uri-for-reporting title="stripped for reporting">stripped for reporting</a>.</dd>

          <dt id=violation-report-line-number><a class=self-link href=#violation-report-line-number></a>line-number</dt>
          <dd>The line number in <code><a data-link-type=dfn href=#source-file title=source-file>source-file</a></code> on which
          the violation occurred.</dd>

          <dt id=violation-report-column-number><a class=self-link href=#violation-report-column-number></a>column-number</dt>
          <dd>The column number in <code><a data-link-type=dfn href=#source-file title=source-file>source-file</a></code> on which
          the violation occurred.</dd>
        </dl>
      </li>
      <li>Return <var>violation</var>.</li>
    </ol>

<p class=note>Note: <code>blocked-uri</code> will not contain the final location of a
    resource that was blocked after one or more redirects. It instead will
    contain only the location that the protected resource requested, before
    any redirects were followed.</p>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=send-violation-reports>send violation reports<a class=self-link href=#send-violation-reports></a></dfn>, the user agent MUST use an
    algorithm equivalent to the following:</p>

    <ol>
      <li>Prepare a <a data-link-type=dfn href=#json-object title="JSON object">JSON object</a> <var>report object</var> with a single
      key, <code>csp-report</code>, whose value is the result of <a data-link-type=dfn href=#generate-a-violation-report-object title="generating a violation report object">generating
      a violation report object</a>.</li>

      <li>Let <var>report body</var> be the <a data-link-type=dfn href=#json-stringification title="JSON stringification">JSON stringification</a> of
      <var>report object</var>.</li>

      <li>For each <var>report URI</var> in the <a data-link-type=dfn href=#set-of-report-uris title="set of report URIs">set of report URIs</a>:
        <ol>
          <li>If the user agent has already sent a violation report for
          the protected resource to <var>report URI</var>, and that report
          contained an entity body that exactly matches
          <var>report body</var>, the user agent MAY abort these
          steps and continue to the next <var>report URI</var>.</li>

          <li><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/webappapis.html#queue-a-task title="Queue a task">Queue a task</a> to <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetch>fetch</a>
          <var>report URI</var> from the origin of the protected resource,
          with the synchronous flag <em>not</em> set, using HTTP method
          <code>POST</code>, with a <code>Content-Type</code> header field
          of <code>application/csp-report</code>, and an entity body
          consisting of <var>report body</var>. If the origin of
          <var>report URI</var> is <strong>not</strong> the same as the
          origin of the protected resource, the block cookies flag MUST also
          be set. The user agent MUST NOT follow redirects when fetching this
          resource. (Note: The user agent ignores the fetched resource.)
          The <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/webappapis.html#task-source title="task source">task source</a> for these
          <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/webappapis.html#concept-task title=tasks>tasks</a> is the <dfn data-dfn-type=dfn data-noexport="" id=content-security-policy-task-source>Content Security Policy task
          source<a class=self-link href=#content-security-policy-task-source></a></dfn>.</li>
        </ol>
      </li>
    </ol>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=report-a-violation>report a violation<a class=self-link href=#report-a-violation></a></dfn>, the user agent MUST:</p>

    <ol>
      <li><a data-link-type=dfn href=#fire-a-violation-event title="Fire a violation event">Fire a violation event</a> at the protected resource’s
      <code><a class=idl-code data-link-spec=HTML5 data-link-type=interface href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#dom-document title=Document>Document</a></code>.</li>

      <li>If the <a data-link-type=dfn href=#set-of-report-uris title="set of report URIs">set of report URIs</a> is non-empty, <a data-link-type=dfn href=#send-violation-reports title="send violation reports">send violation
      reports</a> to each.</li>
    </ol>

<p class=note>Note: This section of the specification should not be interpreted
    as limiting user agents' ability to apply restrictions to violation
    reports in order to limit data leakage above and beyond what these
    algorithms specify.</p>
  </section>
</section>

<section>
  <h2 class="heading settled" data-level=5 id=processing-model><span class=secno>5 </span><span class=content>Processing Model</span><a class=self-link href=#processing-model></a></h2>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=enforce>enforce<a class=self-link href=#enforce></a></dfn> a policy, the user agent MUST <a data-link-type=dfn href=#parse-the-policy title="parse the policy">parse the policy</a>
  and enforce each of the directives contained in the policy, where the
  specific requirements for enforcing each directive are defined separately
  for each directive (See <a data-section="" href=#sec-directives>§7 Directives</a>, below).</p>

<p>Generally speaking, enforcing a directive prevents the protected
  resource from performing certain actions, such as loading scripts from
  URIs other than those indicated in a source list. These restrictions
  make it more difficult for an attacker to abuse an injection
  vulnerability in the resource because the attacker will be unable to
  usurp the resource’s privileges that have been restricted in this
  way.</p>

<p class=note>Note: User agents may allow users to modify or bypass policy enforcement
  through user preferences, bookmarklets, third-party additions to the user
  agent, and other such mechanisms.</p>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=monitor>monitor<a class=self-link href=#monitor></a></dfn> a policy, the user agent MUST <a data-link-type=dfn href=#parse-the-policy title="parse the policy">parse the policy</a>
  and monitor each of the directives contained in the policy.</p>

<p>Monitoring a directive does not prevent the protected resource from
  undertaking any actions. Instead, any actions that would have been
  prevented by the directives are allowed, but a violation report is
  <a data-link-type=dfn href=#report-a-violation title="report a violation">generated and reported</a> to the
  developer of the web application. Monitoring a policy is useful for
  testing whether enforcing the policy will cause the web application to
  malfunction.</p>

<p>A server MAY cause user agents to monitor one policy while enforcing
  another policy by returning both <code><a data-link-type=dfn href=#content-security-policy title=Content-Security-Policy>Content-Security-Policy</a></code>
  and <code><a data-link-type=dfn href=#content-security-policy-report-only title=Content-Security-Policy-Report-Only>Content-Security-Policy-Report-Only</a></code> header fields.
  For example, if a server operator may wish to <a data-link-type=dfn href=#enforce title=enforce>enforce</a> one policy but
  experiment with a stricter policy, she can monitor the stricter policy while
  enforcing the original policy. Once the server operator is satisfied that
  the stricter policy does not break the web application, the server operator
  can start enforcing the stricter policy.</p>

<p>If the user agent monitors or enforces a policy that does not contain any
  directives, the user agent SHOULD report a warning message in the
  developer console.</p>

<p>If the user agent <a data-link-type=dfn href=#monitor title=monitors>monitors</a> or <a data-link-type=dfn href=#enforce title=enforces>enforces</a> a policy that contains
  an unrecognized directive, the user agent SHOULD report a warning message
  in the developer console indicating the name of the unrecognized directive.</p>

<p>If the user agent <a data-link-type=dfn href=#monitor title=monitors>monitors</a> or <a data-link-type=dfn href=#enforce title=enforces>enforces</a> a policy that contains
  a directive that contains a <a data-link-type=dfn href=#source-list0 title="source list">source list</a>, then the user agent MUST set
  a <code><a data-link-type=dfn href=#ch-csp title=CH-CSP>CH-CSP</a></code> Client Hint when requesting cross-origin
  resources, as described in the <a data-section="" href=#ch-csp-client-hint>§3.4 The <code>CH-CSP</code> Client Hint</a>
  section.</p>

  <section>
    <h3 class="heading settled" data-level=5.1 id=processing-model-workers><span class=secno>5.1 </span><span class=content>Workers</span><a class=self-link href=#processing-model-workers></a></h3>

<p>Whenever a user agent <a data-link-type=dfn href=#runs-a-worker title="runs a worker">runs a worker</a>:</p>

    <ul>
      <li>If the worker’s script’s origin is a <a data-link-type=dfn href=#globally-unique-identifier title="globally unique identifier">globally unique identifier</a>
      (for example, the worker’s script’s URL has a scheme of
      <code>data</code>, <code>blob</code>, or <code>filesystem</code>), then:
      <ul>
        <li>If the user agent is enforcing a CSP policy for the <var>owner
        document</var>, the user agent MUST enforce the CSP policy for the
        worker.</li>

        <li>If the user agent is monitoring a CSP policy for the <var>owner
        document</var>, the user agent MUST monitor the CSP policy for the
        worker.</li>
      </ul></li>
      <li>Otherwise:
        <ul>
          <li>If the worker’s script is delivered with a
          <code>Content-Security-Policy</code> HTTP header containing the
          value <var>policy</var>, the user agent MUST <a data-link-type=dfn href=#enforce title=enforce>enforce</a>
          <var>policy</var> for the worker.</li>

          <li>If the worker’s script is delivered with a
          <code>Content-Security-Policy-Report-Only</code> HTTP header
          containing the value <var>policy</var>, the user agent MUST
          <a data-link-type=dfn href=#monitor title=monitor>monitor</a> <var>policy</var> for the worker.</li>
        </ul>
      </li>
    </ul>
  </section>

  <section>
    <h3 class="heading settled" data-level=5.2 id=processing-model-iframe-srcdoc><span class=secno>5.2 </span><span class=content><code>srcdoc</code> IFrames</span><a class=self-link href=#processing-model-iframe-srcdoc></a></h3>

<p>Whenever a user agent creates <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#an-iframe-srcdoc-document title="an iframe srcdoc document">an <code>iframe</code>
    <code>srcdoc</code> document</a> in a browsing context nested in the
    protected resource, if the user agent is <a data-link-type=dfn href=#enforce title=enforcing>enforcing</a> any <a data-link-type=dfn href=#security-policy title=policies>policies</a>
    for the protected resource, the user agent MUST <a data-link-type=dfn href=#enforce title=enforce>enforce</a> those
    <a data-link-type=dfn href=#security-policy title=policies>policies</a> on the <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-iframe-element title=iframe>iframe</a></code>
    <code>srcdoc</code> document as well.</p>

<p>Whenever a user agent creates <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#an-iframe-srcdoc-document title="an iframe srcdoc document">an <code>iframe</code>
    <code>srcdoc</code> document</a> in a browsing context nested in the
    protected resource, if the user agent is monitoring any policies for the
    protected resource, the user agent MUST <a data-link-type=dfn href=#monitor title=monitor>monitor</a> those policies on
    the <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-iframe-element title=iframe>iframe</a></code> <code>srcdoc</code> document as well.</p>
  </section>
</section>

<section>
  <h2 class="heading settled" data-level=6 id=script-interfaces><span class=secno>6 </span><span class=content>Script Interfaces</span><a class=self-link href=#script-interfaces></a></h2>

  <section>
    <h3 class="heading settled" data-level=6.1 id=securitypolicyviolationevent-interface><span class=secno>6.1 </span><span class=content>
      <code>SecurityPolicyViolationEvent</code> Interface
    </span><a class=self-link href=#securitypolicyviolationevent-interface></a></h3>

    <pre class=idl>[Constructor(DOMString <dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent/SecurityPolicyViolationEvent() data-dfn-type=argument data-export="" data-global-name="SecurityPolicyViolationEvent<interface>/SecurityPolicyViolationEvent()<method>/type<argument>" id=dom-securitypolicyviolationevent-securitypolicyviolationevent-type>type<a class=self-link href=#dom-securitypolicyviolationevent-securitypolicyviolationevent-type></a></dfn>, optional <a data-link-type=idl href=#dictdef-securitypolicyviolationeventinit title=SecurityPolicyViolationEventInit>SecurityPolicyViolationEventInit</a> <dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent/SecurityPolicyViolationEvent() data-dfn-type=argument data-export="" data-global-name="SecurityPolicyViolationEvent<interface>/SecurityPolicyViolationEvent()<method>/eventinitdict<argument>" id=dom-securitypolicyviolationevent-securitypolicyviolationevent-eventinitdict>eventInitDict<a class=self-link href=#dom-securitypolicyviolationevent-securitypolicyviolationevent-eventinitdict></a></dfn>)]
interface <dfn class=idl-code data-dfn-type=interface data-export="" data-global-name="" id=dom-securitypolicyviolationevent>SecurityPolicyViolationEvent<a class=self-link href=#dom-securitypolicyviolationevent></a></dfn> : <a data-link-type=idl href=http://dom.spec.whatwg.org/#event title=Event>Event</a> {
    readonly    attribute DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/documenturi<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-securitypolicyviolationevent-documenturi title=documentURI>documentURI</a>;
    readonly    attribute DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/referrer<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-securitypolicyviolationevent-referrer title=referrer>referrer</a>;
    readonly    attribute DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/blockeduri<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-securitypolicyviolationevent-blockeduri title=blockedURI>blockedURI</a>;
    readonly    attribute DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/violateddirective<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-securitypolicyviolationevent-violateddirective title=violatedDirective>violatedDirective</a>;
    readonly    attribute DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/effectivedirective<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-securitypolicyviolationevent-effectivedirective title=effectiveDirective>effectiveDirective</a>;
    readonly    attribute DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/originalpolicy<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-securitypolicyviolationevent-originalpolicy title=originalPolicy>originalPolicy</a>;
    readonly    attribute DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/sourcefile<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="DOMString " href=#dom-securitypolicyviolationevent-sourcefile title=sourceFile>sourceFile</a>;
    readonly    attribute long      <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/linenumber<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="long      " href=#dom-securitypolicyviolationevent-linenumber title=lineNumber>lineNumber</a>;
    readonly    attribute long      <a class=idl-code data-global-name="SecurityPolicyViolationEvent<interface>/columnnumber<attribute>" data-link-for=SecurityPolicyViolationEvent data-link-type=attribute data-readonly="" data-type="long      " href=#dom-securitypolicyviolationevent-columnnumber title=columnNumber>columnNumber</a>;
};
</pre>
    <dl data-dfn-for=SecurityPolicyViolationEvent>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-documenturi>documentURI<a class=self-link href=#dom-securitypolicyviolationevent-documenturi></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-document-uri><code>document-uri</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-referrer>referrer<a class=self-link href=#dom-securitypolicyviolationevent-referrer></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-referrer><code>referrer</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-blockeduri>blockedURI<a class=self-link href=#dom-securitypolicyviolationevent-blockeduri></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-blocked-uri><code>blocked-uri</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-violateddirective>violatedDirective<a class=self-link href=#dom-securitypolicyviolationevent-violateddirective></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-violated-directive><code>violated-directive</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-effectivedirective>effectiveDirective<a class=self-link href=#dom-securitypolicyviolationevent-effectivedirective></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-effective-directive><code>effective-directive</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-originalpolicy>originalPolicy<a class=self-link href=#dom-securitypolicyviolationevent-originalpolicy></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-original-policy><code>original-policy</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-sourcefile>sourceFile<a class=self-link href=#dom-securitypolicyviolationevent-sourcefile></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-source-file><code>source-file</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-linenumber>lineNumber<a class=self-link href=#dom-securitypolicyviolationevent-linenumber></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-line-number><code>line-number</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEvent data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationevent-columnnumber>columnNumber<a class=self-link href=#dom-securitypolicyviolationevent-columnnumber></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-column-number><code>column-number</code></a> property of violation reports for a description of this property.</dd>
    </dl>
  </section>
  <section>
    <h3 class="heading settled" data-level=6.2 id=securitypolicyviolationeventinit-interface><span class=secno>6.2 </span><span class=content>
      <code>SecurityPolicyViolationEventInit</code> Interface
    </span><a class=self-link href=#securitypolicyviolationeventinit-interface></a></h3>

    <pre class=idl>dictionary <dfn class=idl-code data-dfn-type=dictionary data-export="" data-global-name="" id=dictdef-securitypolicyviolationeventinit>SecurityPolicyViolationEventInit<a class=self-link href=#dictdef-securitypolicyviolationeventinit></a></dfn> : <a data-link-type=idl href=http://dom.spec.whatwg.org/#eventinit title=EventInit>EventInit</a> {
    DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/documenturi<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="DOMString " href=#dom-securitypolicyviolationeventinit-documenturi title=documentURI>documentURI</a>;
    DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/referrer<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="DOMString " href=#dom-securitypolicyviolationeventinit-referrer title=referrer>referrer</a>;
    DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/blockeduri<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="DOMString " href=#dom-securitypolicyviolationeventinit-blockeduri title=blockedURI>blockedURI</a>;
    DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/violateddirective<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="DOMString " href=#dom-securitypolicyviolationeventinit-violateddirective title=violatedDirective>violatedDirective</a>;
    DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/effectivedirective<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="DOMString " href=#dom-securitypolicyviolationeventinit-effectivedirective title=effectiveDirective>effectiveDirective</a>;
    DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/originalpolicy<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="DOMString " href=#dom-securitypolicyviolationeventinit-originalpolicy title=originalPolicy>originalPolicy</a>;
    DOMString <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/sourcefile<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="DOMString " href=#dom-securitypolicyviolationeventinit-sourcefile title=sourceFile>sourceFile</a>;
    long      <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/linenumber<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="long      " href=#dom-securitypolicyviolationeventinit-linenumber title=lineNumber>lineNumber</a>;
    long      <a class=idl-code data-global-name="SecurityPolicyViolationEventInit<interface>/columnnumber<attribute>" data-link-for=SecurityPolicyViolationEventInit data-link-type=attribute data-type="long      " href=#dom-securitypolicyviolationeventinit-columnnumber title=columnNumber>columnNumber</a>;
};
</pre>
    <dl data-dfn-for=SecurityPolicyViolationEventInit>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-documenturi>documentURI<a class=self-link href=#dom-securitypolicyviolationeventinit-documenturi></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-document-uri><code>document-uri</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-referrer>referrer<a class=self-link href=#dom-securitypolicyviolationeventinit-referrer></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-referrer><code>referrer</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-blockeduri>blockedURI<a class=self-link href=#dom-securitypolicyviolationeventinit-blockeduri></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-blocked-uri><code>blocked-uri</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-violateddirective>violatedDirective<a class=self-link href=#dom-securitypolicyviolationeventinit-violateddirective></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-violated-directive><code>violated-directive</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-effectivedirective>effectiveDirective<a class=self-link href=#dom-securitypolicyviolationeventinit-effectivedirective></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-effective-directive><code>effective-directive</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-originalpolicy>originalPolicy<a class=self-link href=#dom-securitypolicyviolationeventinit-originalpolicy></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-original-policy><code>original-policy</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-sourcefile>sourceFile<a class=self-link href=#dom-securitypolicyviolationeventinit-sourcefile></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-source-file><code>source-file</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-linenumber>lineNumber<a class=self-link href=#dom-securitypolicyviolationeventinit-linenumber></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-line-number><code>line-number</code></a> property of violation reports for a description of this property.</dd>
      <dt><dfn class=idl-code data-dfn-for=SecurityPolicyViolationEventInit data-dfn-type=attribute data-export="" id=dom-securitypolicyviolationeventinit-columnnumber>columnNumber<a class=self-link href=#dom-securitypolicyviolationeventinit-columnnumber></a></dfn></dt>
      <dd>Refer to the <a href=#violation-report-column-number><code>column-number</code></a> property of violation reports for a description of this property.</dd>
    </dl>
  </section>
  <section>
    <h3 class="heading settled" data-level=6.3 id=firing-securitypolicyviolationevent-events><span class=secno>6.3 </span><span class=content>Firing Violation Events</span><a class=self-link href=#firing-securitypolicyviolationevent-events></a></h3>

<p>To <dfn data-dfn-type=dfn data-noexport="" id=fire-a-violation-event>fire a violation event<a class=self-link href=#fire-a-violation-event></a></dfn>, the user agent MUST use an algorithm
    equivalent to the following:</p>

    <ol>
      <li>Let <var>report object</var> be the result of <a data-link-type=dfn href=#generate-a-violation-report-object title="generating a violation report object">generating a
      violation report object</a>.</li>

      <li><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/webappapis.html#queue-a-task title="Queue a task">Queue a task</a> to
      <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#concept-event-fire title=firing>fire an event</a> named
      <code>securitypolicyviolation</code> using the
      <code><a class=idl-code data-link-type=interface href=#dom-securitypolicyviolationevent title=SecurityPolicyViolationEvent>SecurityPolicyViolationEvent</a></code> interface
      with the following initializations:

        <ul>
          <li><code>blockedURI</code> MUST be initialized to the value of
          <var>report object</var>’s <code>blocked-uri</code> key.</li>

          <li><code>documentURI</code> MUST be initialized to the value of
          <var>report object</var>’s <code>document-uri</code> key.</li>

          <li><code>effectiveDirective</code> MUST be initialized to the value of
          <var>report object</var>’s <code>effective-directive</code> key.</li>

          <li><code>originalPolicy</code> MUST be initialized to the value of
          <var>report object</var>’s <code>original-policy</code> key.</li>

          <li><code>referrer</code> MUST be initialized to the value of
          <var>report object</var>’s <code>referrer</code> key.</li>

          <li><code>violatedDirective</code> MUST be initialized to the value of
          <var>report object</var>’s <code>violated-directive</code> key.</li>

          <li><code>sourceFile</code> MUST be initialized to the value of
          <var>report object</var>’s <code>source-file</code> key.</li>

          <li><code>lineNumber</code> MUST be initialized to the value of
          <var>report object</var>’s <code>line-number</code> key.</li>

          <li><code>columnNumber</code> MUST be initialized to the value of
          <var>report object</var>’s <code>column-number</code> key.</li>
        </ul>
      </li>
    </ol>

<p>The <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/webappapis.html#task-source title="task source">task source</a> for these <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/webappapis.html#concept-task title=tasks>tasks</a>
    is the <a data-link-type=dfn href=#content-security-policy-task-source title="Content Security Policy task source">Content Security Policy task source</a>.</p>
  </section>
</section>

<section>
  <h2 class="heading settled" data-level=7 id=sec-directives><span class=secno>7 </span><span class=content>Directives</span><a class=self-link href=#sec-directives></a></h2>

<p>This section describes the content security policy directives
  introduced in this specification. Directive names are case insensitive.</p>

<p>In order to protect against Cross-Site Scripting (XSS), web
  application authors SHOULD include:</p>

  <ul>
    <li>both the <code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code> and
    <code><a data-link-type=dfn href=#object-src title=object-src>object-src</a></code> directives, or</li>

    <li>include a <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a></code> directive, which covers both
    scripts and plugins.</li>
  </ul>

<p>In either case, authors SHOULD NOT include either
  <code>'unsafe-inline'</code> or <code>data:</code> as valid sources in
  their policies. Both enable XSS attacks by allowing code to be included
  directly in the document itself; they are best avoided completely.</p>

<p>Redirects are another area of potential concern. Authors SHOULD NOT include
  <code>'unsafe-redirect'</code> as valid sources in their policies. It makes
  it more difficult to reason about the complete set of resources that a policy
  allows, especially given the path behavior outlined in the
  <a data-section="" href=#source-list-paths-and-redirects>§4.2.2.3 Paths and Redirects</a> section.</p>


  <section>
    <h3 class="heading settled" data-level=7.1 id=directive-base-uri><span class=secno>7.1 </span><span class=content><code>base-uri</code></span><a class=self-link href=#directive-base-uri></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=base-uri>base-uri<a class=self-link href=#base-uri></a></dfn></code> directive restricts the URIs that can
    be used to specify the <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#document-base-url title="document base URL">document base URL</a>. The syntax for
    the name and value of the directive are described by the following ABNF
    grammar:</p>

    <pre>directive-name    = "base-uri"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-base-uris>allowed base URIs<a class=self-link href=#allowed-base-uris></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>base-uri</code> directive’s
    value as a source list</a>.</p>

<p>Step 4 of the algorithm defined in HTML5 to obtain a
    <em>document’s base URL</em> MUST be changed to:</p>

    <ol start=4>
      <li>If the previous step was not successful, or the result of the
      previous step does not <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a>
      the <a data-link-type=dfn href=#allowed-base-uris title="allowed base URIs">allowed base URIs</a>, then the <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#document-base-url title="document base URL">document base URL</a>
      is <var>fallback base URL</var>. Otherwise, it is the result of the
      previous step.</li>
    </ol>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.2 id=directive-child-src><span class=secno>7.2 </span><span class=content><code>child-src</code></span><a class=self-link href=#directive-child-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=child-src>child-src<a class=self-link href=#child-src></a></dfn></code> directive governs the creation of
    <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing contexts">nested browsing contexts</a> as well as Worker execution
    contexts. The syntax for the name and value of the directive are described
    by the following ABNF grammar:</p>

    <pre>directive-name    = "child-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-child-sources>allowed child sources<a class=self-link href=#allowed-child-sources></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>child-src</code>
    directive’s value as a source list</a> if a <code>child-src</code>
    directive is explicitly specified, and otherwise to the
    <a data-link-type=dfn href=#default-sources title="default sources">default sources</a>.</p>

    <section>
      <h4 class="heading settled" data-level=7.2.1 id=directive-child-src-nested><span class=secno>7.2.1 </span><span class=content>Nested Browsing Contexts</span><a class=self-link href=#directive-child-src-nested></a></h4>

<p>To enforce the <code>child-src</code> directive the user agent MUST
      enforce the <code><a data-link-type=dfn href=#frame-src title=frame-src>frame-src</a></code> directive.</p>
    </section>

    <section>
      <h4 class="heading settled" data-level=7.2.2 id=directive-child-src-workers><span class=secno>7.2.2 </span><span class=content>Workers</span><a class=self-link href=#directive-child-src-workers></a></h4>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URL while processing the
      <code>Worker</code> or <code>SharedWorker</code> constructors
      <a data-biblio-type=normative data-link-type=biblio href=#biblio-workers title=biblio-WORKERS>[WORKERS]</a>, the user agent MUST act as if there was a fatal network
      error and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>
      if the URI does not <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the
      <a data-link-type=dfn href=#allowed-child-sources title="allowed child sources">allowed child sources</a>.</p>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.3 id=directive-connect-src><span class=secno>7.3 </span><span class=content><code>connect-src</code></span><a class=self-link href=#directive-connect-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=connect-src>connect-src<a class=self-link href=#connect-src></a></dfn></code> directive restricts which URIs the
    protected resource can load using script interfaces. The syntax for the name
    and value of the directive are described by the following ABNF grammar:</p>

    <pre>directive-name    = "connect-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-connection-targets>allowed connection targets<a class=self-link href=#allowed-connection-targets></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>connect-src</code>
    directive’s value as a source list</a> if the policy contains an
    explicit <code>connect-src</code> directive, or otherwise to the
    <a data-link-type=dfn href=#default-sources title="default sources">default sources</a>.</p>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI in the course of one of the
    following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-connection-targets title="allowed connection targets">allowed connection
    targets</a>, the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      
      <li>Processing the <a href=http://www.w3.org/TR/XMLHttpRequest/#the-send()-method><code>send()</code>
      method</a> of an <code>XMLHttpRequest</code> object.</li>

      <li>Processing the <a href=http://dev.w3.org/html5/websockets/#websocket><code>WebSocket</code>
      constructor</a>.</li>

      <li>Processing the <a href=http://dev.w3.org/html5/eventsource/#eventsource><code>EventSource</code>
      constructor</a>.</li>

      <li>Sending a beacon via the <a href=https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/Beacon/Overview.html#sec-sendBeacon-method><code>sendBeacon()</code></a> method <a data-biblio-type=normative data-link-type=biblio href=#biblio-beacon title=biblio-BEACON>[BEACON]</a></li>
    </ul>
    <section class=informative>
      <h4 class="heading settled" data-level=7.3.1 id=connect-src-usage><span class=secno>7.3.1 </span><span class=content>Usage</span><a class=self-link href=#connect-src-usage></a></h4>

<p><em>This section is not normative.</em></p>

<p>JavaScript offers a few mechanisms that directly connect to an
      external server to send or receive information. <code>EventSource</code>
      maintains an open HTTP connection to a server in order to receive push
      notifications, <code>WebSockets</code> open a bidirectional communication
      channel between your browser and a server, and <code>XMLHttpRequest</code>
      makes arbitrary HTTP requests on your behalf. These are powerful APIs that
      enable useful functionality, but also provide tempting avenues for data
      exfiltration.</p>

<p>The <code>connect-src</code> directive allows you to ensure that
      these sorts of connections are only opened to origins you trust.
      Sending a policy that defines a list of source expressions for this
      directive is straightforward. For example, to limit connections to
      only <code>example.com</code>, send the following header:</p>

<pre>Content-Security-Policy: <a data-link-type=dfn href=#connect-src title=connect-src>connect-src</a> example.com</pre>

<p>All of the following will fail with the preceding directive in
      place:</p>

      <ul>
        <li><code>new WebSocket("wss://evil.com/");</code></li>
        <li><code>(new XMLHttpRequest()).open("GET", "https://evil.com/", true);</code></li>
        <li><code>new EventSource("https://evil.com");</code></li>
      </ul>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.4 id=directive-default-src><span class=secno>7.4 </span><span class=content><code>default-src</code></span><a class=self-link href=#directive-default-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=default-src>default-src<a class=self-link href=#default-src></a></dfn></code> directive sets a default
    source list for a number of directives. The syntax for the name and
    value of the directive are described by the following ABNF grammar:</p>

    <pre>directive-name    = "default-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>Let the <dfn data-dfn-type=dfn data-noexport="" id=default-sources>default sources<a class=self-link href=#default-sources></a></dfn> be the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>default-src</code>
    directive’s value as a source list</a> if a <code>default-src</code>
    directive is explicitly specified, and otherwise the U+002A ASTERISK
    character (*).</p>

<p>To enforce the <code>default-src</code> directive, the user agent
    MUST enforce the following directives:</p>

    <ul>
      <li><code><a data-link-type=dfn href=#child-src title=child-src>child-src</a></code></li>
      <li><code><a data-link-type=dfn href=#connect-src title=connect-src>connect-src</a></code></li>
      <li><code><a data-link-type=dfn href=#font-src title=font-src>font-src</a></code></li>
      <li><code><a data-link-type=dfn href=#img-src title=img-src>img-src</a></code></li>
      <li><code><a data-link-type=dfn href=#media-src title=media-src>media-src</a></code></li>
      <li><code><a data-link-type=dfn href=#object-src title=object-src>object-src</a></code></li>
      <li><code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code></li>
      <li><code><a data-link-type=dfn href=#style-src title=style-src>style-src</a></code></li>
    </ul>

<p>If not specified explicitly in the policy, the directives listed
    above will use the <a data-link-type=dfn href=#default-sources title="default sources">default sources</a> as their source list.</p>

    <section>
      <h4 class="heading settled" data-level=7.4.1 id=default-src-usage><span class=secno>7.4.1 </span><span class=content>Usage</span><a class=self-link href=#default-src-usage></a></h4>

<p><em>This section is not normative.</em></p>

<p><code>default-src</code>, as the name implies, serves as a default
      source list which the other source list-style directives will use as
      a fallback if they’re not otherwise explicitly set. That is, consider
      the following policy declaration:</p>

<pre>Content-Security-Policy: <a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self'</pre>

<p>Under this policy, fonts, frames, images, media, objects, scripts,
      and styles will all only load from the same origin as the protected
      resource, and connections will only be made to the same origin. Adding
      a more specific declaration to the policy would completely override
      the default source list for that resource type.</p>

<pre>Content-Security-Policy: <a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self'; <a data-link-type=dfn href=#script-src title=script-src>script-src</a> example.com</pre>

<p>Under this new policy, fonts, frames, and etc. continue to be load
      from the same origin, but scripts will <em>only</em> load from
      <code>example.com</code>. There’s no inheritance; the
      <code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code> directive sets the allowed sources of
      script, and the default list is not used for that resource type.</p>

<p>Given this behavior, one good way of building a policy for a site
      would be to begin with a <code>default-src</code> of
      <code>'none'</code>, and to build up a policy from there that contains
      only those resource types which are actually in use for the page you’d
      like to protect. If you don’t use webfonts, for instance, there’s no
      reason to specify a source list for <code><a data-link-type=dfn href=#font-src title=font-src>font-src</a></code>;
      specifying only those resource types a page uses ensures that the
      possible attack surface for that page remains as small as possible.</p>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.5 id=directive-font-src><span class=secno>7.5 </span><span class=content><code>font-src</code></span><a class=self-link href=#directive-font-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=font-src>font-src<a class=self-link href=#font-src></a></dfn></code> directive restricts from where the
    protected resource can load fonts. The syntax for the name and value
    of the directive are described by the following ABNF grammar:</p>

    <pre>directive-name    = "font-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-font-sources>allowed font sources<a class=self-link href=#allowed-font-sources></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>font-src</code>
    directive’s value as a source list</a> if the policy contains an
    explicit <code>font-src</code>, or otherwise to the
    <a data-link-type=dfn href=#default-sources title="default sources">default sources</a>.</p>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI in the course of one of the
    following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-font-sources title="allowed font sources">allowed font sources</a>,
    the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      <li>Requesting data for display in a font, such as when processing
      the <a class="production css" data-link-type=at-rule href=http://dev.w3.org/csswg/css-fonts-3/#at-font-face-rule title=@font-face>&lt;@font-face&gt;</a> Cascading Style Sheets (CSS) rule.</li>
    </ul>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.6 id=directive-form-action><span class=secno>7.6 </span><span class=content><code>form-action</code></span><a class=self-link href=#directive-form-action></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=form-action>form-action<a class=self-link href=#form-action></a></dfn></code> restricts which URIs can be used as
    the action of HTML <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/forms.html#the-form-element title=form>form</a></code> elements. The syntax for the name and
    value of the directive are described by the following ABNF grammar:</p>

    <pre>directive-name    = "form-action"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-form-actions>allowed form actions<a class=self-link href=#allowed-form-actions></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>form-action</code>
    directive’s value as a source list</a>.</p>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI in the course of one of the
    following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-form-actions title="allowed form actions">allowed form actions</a>,
    the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      <li>Processing an HTML <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/forms.html#the-form-element title=form>form</a></code> element.</li>
      <li>Pinging an endpoint during <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#hyperlink-auditing>hyperlink auditing</a></li>
    </ul>

<p class=note>Note: <code>form-action</code> does not fall back to the <a data-link-type=dfn href=#default-sources title="default sources">default
    sources</a> when the directive is not defined. That is, a policy that
    defines <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'none'</code> but not
    <code>form-action</code> will still allow form submissions to any
    target.</p>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.7 id=directive-frame-ancestors><span class=secno>7.7 </span><span class=content><code>frame-ancestors</code></span><a class=self-link href=#directive-frame-ancestors></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=frame-ancestors>frame-ancestors<a class=self-link href=#frame-ancestors></a></dfn></code> directive indicates whether the
    user agent should allow embedding the resource using a
    <code><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#frame title=frame>frame</a></code>, <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-iframe-element title=iframe>iframe</a></code>,
    <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code>, <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code> or
    <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#the-applet-element title=applet>applet</a></code> tag, or equivalent
    functionality in non-HTML resources. Resources can use this directive to
    avoid many UI Redressing <a data-biblio-type=informative data-link-type=biblio href=#biblio-uiredress title=biblio-UIREDRESS>[UIREDRESS]</a> attacks by avoiding being embedded
    into potentially hostile contexts.</p>

<p>The syntax for the name and value of the directive are described by the
    following ABNF grammar:</p>

    <pre>directive-name  = "frame-ancestors"
directive-value = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-frame-ancestors>allowed frame ancestors<a class=self-link href=#allowed-frame-ancestors></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>frame-ancestors</code>
    directive’s value as a source list</a>. If a <code>frame-ancestors</code>
    directive is not explicitly included in the policy, then <a data-link-type=dfn href=#allowed-frame-ancestors title="allowed frame ancestors">allowed frame
    ancestors</a> is "<code>*</code>".</p>

<p>To enforce the <code>frame-ancestors</code> directive, whenever the
    user agent would load the protected resource into a <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing context">nested browsing
    context</a>, the user agent MUST perform the following steps:</p>

    <ol>
      <li>Let <var>nestedContext</var> be the nested browsing context into
      which the protected resource is being loaded.</li>

      <li>Let <var>ancestorList</var> be the list of all
      <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#ancestor-browsing-context title=ancestors>ancestors</a> of <var>nestedContext</var>.</li>

      <li>For each <var>ancestorContext</var> in <var>ancestorList</var>:
        <ol>
          <li>Let <var>document</var> be <var>ancestorContext</var>’s
          <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#active-document title="active document">active document</a>.</li>

          <li>If <var>document</var>’s URL does not
          <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-frame-ancestors title="allowed frame ancestors">allowed frame
          ancestors</a>, the user agent MUST:
            <ol>
              <li>Abort loading the protected resource.</li>

              <li>Act as if it received an empty <a data-link-type=dfn href=#http-200-response title="HTTP 200 response">HTTP 200 response</a>.</li>

              <li><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#parse-a-sandboxing-directive title="Parse a sandboxing directive">Parse a sandboxing directive</a> using the
              empty string as the <em>input</em> and the newly created
              document’s <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#forced-sandboxing-flag-set title="forced sandboxing flag set">forced sandboxing flag set</a> as the
              <em>output</em>.</li>
            </ol>
          </li>
        </ol>
      </li>
    </ol>

<p>Steps 2.2 and 2.3 ensure that the blocked frame appears to be a
    normal cross-origin document’s load. If these steps are ignored,
    leakage of a document’s policy state is possible. The user agent MAY
    implement these steps by instead redirecting the user to friendly
    error page in a unique origin which provides the option of opening
    the blocked page in a new <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing context</a>.</p>

<p>The <code>frame-ancestors</code> directive MUST be ignored
    when <a data-link-type=dfn href=#monitor title=monitoring>monitoring</a> a policy, and when a contained in a
    policy defined via a <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#meta title=meta>meta</a></code> element.</p>

<p class=note>Note: <code><a data-link-type=dfn href=#frame-ancestors title=frame-ancestors>frame-ancestors</a></code> does not fall back to the
    <a data-link-type=dfn href=#default-sources title="default sources">default sources</a> when the directive is not defined. That is, a policy
    that defines <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'none'</code> but not
    <code>frame-ancestors</code> will still allow the resource to be framed from
    anywhere.</p>

<p>When generating a violation report for a <code>frame-ancestors</code>
    violation, the user agent MUST NOT include the value of the embedding
    ancestor as a <code>blocked-uri</code> value unless it is same-origin with
    the protected resource, as disclosing the value of cross-origin ancestors
    is a violation of the Same-Origin Policy.</p>

    <section>
      <h4 class="heading settled" data-level=7.7.1 id=frame-ancestors-and-frame-options><span class=secno>7.7.1 </span><span class=content>
        Relation to <code>X-Frame-Options</code>
      </span><a class=self-link href=#frame-ancestors-and-frame-options></a></h4>

<p>This directive is similar to the <code>X-Frame-Options</code> header that
      several user agents have implemented. The <code>'none'</code> source
      expression is roughly equivalent to that header’s <code>DENY</code>,
      <code>'self'</code> to <code>SAMEORIGIN</code>, and so on. The major
      difference is that many user agents implement <code>SAMEORIGIN</code> such
      that it only matches against the top-level document’s location. This
      directive checks each ancestor. If any ancestor doesn’t match, the load
      is cancelled. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc7034 title=biblio-RFC7034>[RFC7034]</a></p>

<p>The <code>frame-ancestors</code> directive <em>obsoletes</em> the
      <code>X-Frame-Options</code> header.  If a resource has both policies,
      the <code>frame-ancestors</code> policy SHOULD be enforced and the
      <code>X-Frame-Options</code> policy SHOULD be ignored.</p>
    </section>

    <section class=informative id=multiple-host-source-values>
      <h4 class="heading settled" data-level=7.7.2 id=frame-ancestors-multiple-source-values><span class=secno>7.7.2 </span><span class=content>Multiple Host Source Values</span><a class=self-link href=#frame-ancestors-multiple-source-values></a></h4>

<p><em>This section is not normative.</em></p>

<p>Multiple source-list expressions are allowed in a single policy (in contrast
      to <code>X-Frame-Options</code>, which allows only one) to enable
      scenarios involving embedded application components that are multiple levels
      below the top-level browsing context.</p>

<p>Many common scenarios for permissioned embedding (e.g. embeddable payment,
      sharing or social apps) involve potentially many hundreds or thousands of
      valid <code>source-list</code> expressions, but it is strongly recommended
      against accommodating such scenarios with a static
      <code>frame-ancestors</code> directive listing multiple values. In such
      cases it is beneficial to generate this value dynamically, based on an
      HTTP Referer header or an explicitly passed-in value, to allow only the
      sources necessary for each given embedding of the resource.</p>

<p>Consider a service providing a payments application at
      <code>https://payments/makeEmbedded</code>. The service allows this resource
      to be embedded by both merchant Alice and merchant Bob, who compete with each
      other. Sending:</p>

      <pre>Content-Security-Policy: <a data-link-type=dfn href=#frame-ancestors title=frame-ancestors>frame-ancestors</a> https://alice https://bob
</pre>

<p>would allow Bob to re-frame Alice’s resource and create fraudulent clicks,
      perhaps discrediting Alice with her customers or the payments service. If the
      payments service used additional information (e.g. as part of a URL like
      <code>https://payments/makeEmbedded?merchant=alice</code>) to send
      individually-tailored headers listing only the source-list expressions
      needed by each merchant, this attack would be eliminated.</p>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.8 id=directive-frame-src><span class=secno>7.8 </span><span class=content><code>frame-src</code></span><a class=self-link href=#directive-frame-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=frame-src>frame-src<a class=self-link href=#frame-src></a></dfn></code> directive is <em>deprecated</em>.
    Authors who wish to govern nested browsing contexts SHOULD use the
    <code>child-src</code> directive instead.</p>

<p>The <code>frame-src</code> directive restricts from where the
    protected resource can embed frames. The syntax for the name
    and value of the directive are described by the following ABNF
    grammar:</p>

    <pre>directive-name    = "frame-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-frame-sources>allowed frame sources<a class=self-link href=#allowed-frame-sources></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>frame-src</code>
    directive’s value as a source list</a> if the policy contains an
    explicit <code>frame-src</code>, or otherwise to the list of
    <a data-link-type=dfn href=#allowed-child-sources title="allowed child sources">allowed child sources</a>.</p>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI in the course of one of the
    following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-frame-sources title="allowed frame sources">allowed frame sources</a>,
    the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      <li>Requesting data for display in a <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing context">nested browsing context</a> in the
      protected resource created by an <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-iframe-element title=iframe>iframe</a></code> or
      a <code><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#frame title=frame>frame</a></code> element.</li>

      <li><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#navigate title=Navigated>Navigated</a> such a <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing context">nested browsing context</a>.</li>
    </ul>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.9 id=directive-img-src><span class=secno>7.9 </span><span class=content><code>img-src</code></span><a class=self-link href=#directive-img-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=img-src>img-src<a class=self-link href=#img-src></a></dfn></code> directive restricts from where the
    protected resource can load images. The syntax for the name and value
    of the directive are described by the following ABNF grammar:</p>

    <pre>directive-name    = "img-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-image-sources>allowed image sources<a class=self-link href=#allowed-image-sources></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>img-src</code>
    directive’s value as a source list</a> if the policy contains an
    explicit <code>img-src</code>, or otherwise to the list of
    <a data-link-type=dfn href=#default-sources title="default sources">default sources</a>.</p>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI in the course of one of the
    following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-image-sources title="allowed image sources">allowed image sources</a>,
    the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      
      <li>Requesting data for an image, such as when processing the
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-img-src title=src>src</a></code> or
      <code>srcset</code> attributes of an
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-img-element title=img>img</a></code> element, the
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-img-src title=src>src</a></code> attribute of an
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/forms.html#the-input-element title=input>input</a></code> element with a type of
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/forms.html#attr-input-type-image-keyword title=image>image</a></code>,
      the <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-video-poster title=poster>poster</a></code> attribute of a
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#video title=video>video</a></code> element,
      the <span class=css>url()</span>, <a class="production css" data-link-type=function href=http://dev.w3.org/csswg/css-images-4/#funcdef-image title=image()>&lt;image()&gt;</a> or <a class="production css" data-link-type=function href=http://dev.w3.org/csswg/css-images-4/#funcdef-image-set title=image-set()>&lt;image-set()&gt;</a> values on any
      Cascading Style Sheets (CSS)
      property that is capable of loading an image <a data-biblio-type=normative data-link-type=biblio href=#biblio-css4-images title=biblio-CSS4-IMAGES>[CSS4-IMAGES]</a>, or
      the <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-base-href title=href>href</a></code> attribute of a
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-link-element title=link>link</a></code> element with an image-related
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-link-rel title=rel>rel</a></code> attribute, such as
      <code><a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/links.html#rel-icon-0 title=icon>icon</a></code>.</li>
    </ul>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.10 id=directive-media-src><span class=secno>7.10 </span><span class=content><code>media-src</code></span><a class=self-link href=#directive-media-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=media-src>media-src<a class=self-link href=#media-src></a></dfn></code> directive restricts from where the
    protected resource can load video, audio, and associated text tracks.
    The syntax for the name and value of the directive are described by the
    following ABNF grammar:</p>

    <pre>directive-name    = "media-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-media-sources>allowed media sources<a class=self-link href=#allowed-media-sources></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>media-src</code>
    directive’s value as a source list</a> if the policy contains an
    explicit <code>media-src</code>, or otherwise to the list of
    <a data-link-type=dfn href=#default-sources title="default sources">default sources</a>.</p>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI in the course of one of the
    following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-media-sources title="allowed media sources">allowed media sources</a>,
    the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      <li>Requesting data for a video or audio clip, such as when
      processing the <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-img-src title=src>src</a></code> attribute of a
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#video title=video>video</a></code>, <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#audio title=audio>audio</a></code>,
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-source-element title=source>source</a></code>, or <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-track-element title=track>track</a></code>
      elements.</li>
    </ul>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.11 id=directive-object-src><span class=secno>7.11 </span><span class=content><code>object-src</code></span><a class=self-link href=#directive-object-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=object-src>object-src<a class=self-link href=#object-src></a></dfn></code> directive restricts from where
    the protected resource can load plugins. The syntax for the name and value
    of the directive are described by the following ABNF grammar:</p>

    <pre>directive-name    = "object-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-object-sources>allowed object sources<a class=self-link href=#allowed-object-sources></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>object-src</code>
    directive’s value as a source list</a> if the policy contains an
    explicit <code>object-src</code>, or otherwise to the list of
    <a data-link-type=dfn href=#default-sources title="default sources">default sources</a>.</p>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI in the course of one of the
    following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-object-sources title="allowed object sources">allowed object sources</a>,
    the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      <li>Requesting data for a plugin, such as when processing the
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-object-data title=data>data</a></code> attribute of an
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code> element, the
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-img-src title=src>src</a></code> attribute of an
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code> elements, or the
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#attr-object-code title=code>code</a></code> or
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#attr-object-archive title=archive>archive</a></code> attributes of an
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#the-applet-element title=applet>applet</a></code> element.</li>

      <li>Requesting data for display in a <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing context">nested browsing context</a>
      in the protected resource created by an <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code>
      or an <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code> element.</li>

      <li>Navigating such a <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing context">nested browsing context</a>.</li>
    </ul>

<p>It is not required that the consumer of the element’s data be a
    <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#plugin title=plugin>plugin</a> in order for the <code>object-src</code> directive to be
    enforced. Data for any <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code>,
    <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code>, or <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#the-applet-element title=applet>applet</a></code>
    element MUST match the <a data-link-type=dfn href=#allowed-object-sources title="allowed object sources">allowed object sources</a> in order to be fetched.
    This is true even when the element data is semantically equivalent to
    content which would otherwise be restricted by one of the other
    <a data-section="" href=#sec-directives>directives</a>, such as an
    <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code> element with a <code>text/html</code>
    MIME type.</p>

<p>Whenever the user agent would load a <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#plugin title=plugin>plugin</a> without an associated
    URI (e.g., because the <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code> element lacked a
    <code>data</code> attribute), if the protected resource’s URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-object-sources title="allowed object sources">allowed object sources</a>,
    the user agent MUST NOT load the plugin.</p>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.12 id=directive-plugin-types><span class=secno>7.12 </span><span class=content><code>plugin-types</code></span><a class=self-link href=#directive-plugin-types></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=plugin-types>plugin-types<a class=self-link href=#plugin-types></a></dfn></code> directive restricts the set
    of plugins that can be invoked by the protected resource by limiting
    the types of resources that can be embedded. The syntax for the name
    and value of the directive are described by the following ABNF
    grammar:</p>

    <pre>directive-name    = "plugin-types"
directive-value   = media-type-list
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-plugin-media-types>allowed plugin media types<a class=self-link href=#allowed-plugin-media-types></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-media-type-list title="parse a media type list">parsing the <code>plugin-types</code>
    directive’s value as a media type list</a>.</p>

<p>Whenever the user agent would instantiate a <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#plugin title=plugin>plugin</a>
    to handle <var>resource</var> while enforcing the <code>plugin-types</code>
    directive, the user agent MUST instead act as though the plugin reported an
    error <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a> if any of the following
    conditions hold:</p>

    <ul>
        <li>The plugin is embedded into the protected resource via an
        <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code> or
        <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code> element that does not explicitly
        declare a <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#mime-type title="MIME type">MIME type</a> via a
        <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-link-type title=type>type</a></code> attribute.</li>

        <li><var>resource</var>’s media type does not
        <a data-link-type=dfn href=#match-a-media-type-list title="match a media type list">match</a> the list of <a data-link-type=dfn href=#allowed-plugin-media-types title="allowed plugin media types">allowed
        plugin media types</a>.</li>

        <li>The plugin is embedded into the protected resource via an
        <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code> or
        <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code> element, and the media type declared
        in the element’s <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-link-type title=type>type</a></code> attribute is not
        a case-insensitive match for the <var>resource</var>’s media
        type.</li>

        <li>The plugin is embedded into the protected resource via an
        <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/obsolete.html#the-applet-element title=applet>applet</a></code> element, and <var>resource</var>’s
        media type is not a case-insensitive match for
        <code>application/x-java-applet</code>.</li>
    </ul>

<p class=note>Note: In any of these cases, acting as though the plugin reported an
    error will cause the user agent to display the <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/dom.html#fallback-content title="fallback content">fallback
    content</a>.</p>

<p>Whenever the user agent creates a <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#plugin-document title="plugin document">plugin document</a> in a
    <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing context">nested browsing context</a> in the <a data-link-type=dfn href=#protected-resource title="protected resource">protected resource</a>, if the user
    agent is enforcing any <code>plugin-types</code> directives for the
    protected resource, the user agent MUST <a data-link-type=dfn href=#enforce title=enforce>enforce</a> those
    <code>plugin-types</code> directives on the plugin document as well.</p>

<p>Whenever the user agent creates a <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#plugin-document title="plugin document">plugin document</a> in a
    <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#nested-browsing-context title="nested browsing context">nested browsing context</a> in the <a data-link-type=dfn href=#protected-resource title="protected resource">protected resource</a>, if the user
    agent is monitoring any <code>plugin-types</code> directives for the
    protected resource, the user agent MUST <a data-link-type=dfn href=#monitor title=monitor>monitor</a> those
    <code>plugin-types</code> directives on the plugin document as well.</p>

    <section class=informative>
      <h4 class="heading settled" data-level=7.12.1 id=plugin-types-usage><span class=secno>7.12.1 </span><span class=content>Usage</span><a class=self-link href=#plugin-types-usage></a></h4>

<p><em>This section is not normative.</em></p>

<p>The <code>plugin-types</code> directive whitelists a certain set
      of MIME types that can be embedded in a protected resource. For
      example, a site might want to ensure that PDF content loads, but that
      no other plugins can be instantiated. The following directive would
      satisfy that requirement:</p>

<pre>Content-Security-Policy: <a data-link-type=dfn href=#plugin-types title=plugin-types>plugin-types</a> application/pdf</pre>

<p>Resources embedded via an <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code> or
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code> element delivered with an
      <code>application/pdf</code> content type would be rendered in the
      appropriate plugin; resources delivered with some other content type
      would be blocked. Multiple types can be specified, in any order. If the
      site decided to additionally allow Flash at some point in the future, it
      could do so with the following directive:</p>

<pre>Content-Security-Policy: <a data-link-type=dfn href=#plugin-types title=plugin-types>plugin-types</a> application/pdf application/x-shockwave-flash</pre>

<p class=note>Note: Wildcards are not accepted in the <code>plugin-types</code>
      directive. Only the resource types explicitly listed in the directive
      will be allowed.</p>
  </section>
  <section class=informative>
      <h4 class="heading settled" data-level=7.12.2 id=plugin-types-predeclaration><span class=secno>7.12.2 </span><span class=content>
        Predeclaration of expected media types
      </span><a class=self-link href=#plugin-types-predeclaration></a></h4>

<p><em>This section is not normative.</em></p>

<p>Enforcing the <code>plugin-types</code> directive requires that
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-object-element title=object>object</a></code> and <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-embed-element title=embed>embed</a></code>
      elements declare the expected media type of the resource they include via
      the <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-link-type title=type>type</a></code> attribute. If an author expects
      to load a PDF, she could specify this as follows:</p>

<pre>&lt;object data="<var>resource</var>" type="application/pdf"&gt;&lt;/object&gt;</pre>

<p>If <var>resource</var> isn’t actually a PDF file, it won’t
      load. This prevents certain types of attacks that rely on serving
      content that unexpectedly invokes a plugin other than that which the
      author intended.</p>

<p class=note>Note: <var>resource</var> will not load in this scenario even
      if its media type is otherwise whitelisted: resources will only load
      when their media type is whitelisted <em>and</em> matches the
      declared type in their containing element.</p>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.13 id=directive-referrer><span class=secno>7.13 </span><span class=content><code>referrer</code></span><a class=self-link href=#directive-referrer></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=referrer>referrer<a class=self-link href=#referrer></a></dfn></code> directive specifies the referrer
    policy <a data-biblio-type=normative data-link-type=biblio href=#biblio-referrer title=biblio-REFERRER>[REFERRER]</a> that the user agent applies when determining what
    referrer information should be included with requests made, and with
    <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#browsing-context title="browsing contexts">browsing contexts</a> created from the context of the
    protected resource. The syntax for the name and value of the directive
    are described by the following ABNF grammar:</p>

    <pre>directive-name    = "referrer"
directive-value   = "no-referrer" / "no-referrer-when-downgrade" / "origin" / "origin-when-cross-origin" / "unsafe-url"
</pre>

<p class=note>Note: The directive name does not share the HTTP header’s misspelling.</p>

<p>When <a data-link-type=dfn href=#enforce title=enforcing>enforcing</a> the <code>referrer</code> directive, the user agent
    MUST execute <a data-biblio-type=normative data-link-type=biblio href=#biblio-referrer title=biblio-REFERRER>[REFERRER]</a>'s
    <a href=http://w3c.github.io/webappsec/specs/referrer-policy/#set-referrer-policy>Set <var>environment</var>’s referrer policy to <var>policy</var>.</a>
    algorithm on the <a data-link-type=dfn href=#protected-resource title="protected resource">protected resource</a>’s <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#javascript-global-environment title="JavaScript global environment">JavaScript global
    environment</a> using the <code>referrer</code> directive’s value.</p>

    <section class=informative>
      <h4 class="heading settled" data-level=7.13.1 id=referrer-usage><span class=secno>7.13.1 </span><span class=content>Usage</span><a class=self-link href=#referrer-usage></a></h4>

<p><em>This section is not normative.</em></p>

<p>A protected resource can prevent referrer leakage by specifying
      <code>no-referrer</code> as the value of its policy’s
      <code>referrer</code> directive:</p>

      <pre>Content-Security-Policy: referrer no-referrer;
</pre>

<p>This will cause all requests made from the protected resource’s
      context to have an empty <code>Referer</code> [sic] header.</p>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.14 id=directive-reflected-xss><span class=secno>7.14 </span><span class=content><code>reflected-xss</code></span><a class=self-link href=#directive-reflected-xss></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=reflected-xss>reflected-xss<a class=self-link href=#reflected-xss></a></dfn></code> directive instructs a user agent
    to activate or deactivate any heuristics used to filter or block
    reflected cross-site scripting attacks. The syntax for the name and
    value of the directive are described by the following ABNF grammar:</p>

    <pre>directive-name    = "reflected-xss"
directive-value   = "allow" / "block" / "filter"
</pre>

<p>A user agent with support for XSS protection MUST enforce this
    directive as follows:</p>

    <ul>
      <li>If the value of the directive is <code>allow</code>, the user
      agent MUST disable its active protections against reflected cross-site
      scripting attacks for the protected resource.</li>

      <li>If the value of the directive is <code>filter</code>, the user
      agent MUST enable its active protections against reflected cross-site
      scripting attacks for the protected resource. This might result in
      filtering script that is believed to be reflected being filtered or
      selectively blocking script execution.</li>

      <li>If the value of the directive is <code>block</code>, the user
      agent MUST stop rendering the protected resource upon detection of
      reflected script, and instead act as if there was a fatal network
      error and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a
      violation</a>:
    </ul>

<p>If the user agent’s active protections against reflected cross-site
    scripting attacks detect or prevent script execution, the user agent
    MUST <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>.</p>

<p class=note>Note: The <code>reflected-xss</code> directive will be ignored if
    contained within a
    <a href=#delivery-html-meta-element><code>meta</code> element</a>.</p>

    <section class=informative>
      <h4 class="heading settled" data-level=7.14.1 id=reflected-xss-and-x-xss-protection><span class=secno>7.14.1 </span><span class=content>
        Relationship to <code>X-XSS-Protection</code>
      </span><a class=self-link href=#reflected-xss-and-x-xss-protection></a></h4>

<p>This directive is meant to subsume the functionality provided by
      the proprietary <code>X-XSS-Protection</code> HTTP header which is
      supported by a number of user agents. Roughly speaking:</p>

      <ul>
        <li><code>reflected-xss allow</code> is equivalent to
        <code>X-XSS-Protection: 0</code></li>
        <li><code>reflected-xss filter</code> is equivalent to
        <code>X-XSS-Protection: 1</code></li>
        <li><code>reflected-xss block</code> is equivalent to
        <code>X-XSS-Protection: 1; mode=block</code></li>
      </ul>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.15 id=directive-report-uri><span class=secno>7.15 </span><span class=content><code>report-uri</code></span><a class=self-link href=#directive-report-uri></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=report-uri>report-uri<a class=self-link href=#report-uri></a></dfn></code> directive specifies a URI to
    which the user agent sends reports about policy violation. The syntax
    for the name and value of the directive are described by the following
    ABNF grammar:</p>

    <pre>directive-name    = "report-uri"
directive-value   = <a data-link-type=dfn href=#uri-reference title=uri-reference>uri-reference</a> *( 1*WSP <a data-link-type=dfn href=#uri-reference title=uri-reference>uri-reference</a> )
<dfn data-dfn-type=dfn data-noexport="" id=uri-reference>uri-reference<a class=self-link href=#uri-reference></a></dfn>     = &lt;URI-reference from RFC 3986&gt;
</pre>

<p>The <dfn data-dfn-type=dfn data-noexport="" id=set-of-report-uris>set of report URIs<a class=self-link href=#set-of-report-uris></a></dfn> is the value of the
    <code>report-uri</code> directive, each resolved relative to the
    protected resource’s URI.</p>

<p>The process of sending violation reports to the URIs specified in
    this directive’s value is defined in this document’s
    <a data-section="" href=#violation-reports>§4.4 Reporting</a> section.</p>

<p class=note>Note: The <code>report-uri</code> directive will be ignored if contained
    within a <a href=#delivery-html-meta-element><code>meta</code>
    element</a>.</p>
  </section>
  <section>
    <h3 class="heading settled" data-level=7.16 id=directive-sandbox><span class=secno>7.16 </span><span class=content><code>sandbox</code></span><a class=self-link href=#directive-sandbox></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=sandbox>sandbox<a class=self-link href=#sandbox></a></dfn></code> directive specifies an HTML
    sandbox policy that the user agent applies to the protected resource.
    The syntax for the name and value of the directive are described by
    the following ABNF grammar:</p>

    <pre>directive-name    = "sandbox"
directive-value   = "" / sandbox-token *( 1*WSP <a data-link-type=dfn href=#sandbox-token title=sandbox-token>sandbox-token</a> )
<dfn data-dfn-type=dfn data-noexport="" id=sandbox-token>sandbox-token<a class=self-link href=#sandbox-token></a></dfn>     = &lt;token from RFC 7230&gt;
</pre>

<p>When enforcing the <code>sandbox</code> directive, the user agent
    MUST <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#parse-a-sandboxing-directive title="parse a sandboxing directive">parse a sandboxing directive</a> using the
    <code>directive-value</code> as the <em>input</em> and protected
    resource’s <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#forced-sandboxing-flag-set title="forced sandboxing flag set">forced sandboxing flag set</a>
    as the output. <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=biblio-HTML5>[HTML5]</a></p>

<p class=note>Note: The <code>sandbox</code> directive will be ignored when
    <a data-link-type=dfn href=#monitor title=monitoring>monitoring</a> a policy, and when contained in a policy defined via a
    <a href=#delivery-html-meta-element><code>meta</code> element</a>.</p>

    <section class=informative>
      <h4 class="heading settled" data-level=7.16.1 id=sandbox-usage><span class=secno>7.16.1 </span><span class=content>Usage</span><a class=self-link href=#sandbox-usage></a></h4>

<p><em>This section is not normative.</em></p>

      <p>HTML5 defines a <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-iframe-sandbox title=sandbox>sandbox</a></code> attribute for
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-iframe-element title=iframe>iframe</a></code> elements, intended to allow web authors
      to reduce the risk of including potentially untrusted content by imposing
      restrictions on that content’s abilities. When the attribute is set,
      the content is forced into a unique origin, prevented from submitting
      forms, running script, creating or navigating other browsing contexts,
      and prevented from running plugins. These restrictions can be loosened
      by setting certain flags as the attribute’s value.

<p>The <code>sandbox</code> directive allows any resource, framed or
      not, to ask for the same sorts of restrictions to be applied to
      itself.</p>

<p>For example, a message board or email system might provide
      downloads of arbitrary attachments provided by other users. Attacks
      that rely on tricking a client into rendering one of these attachments
      could be mitigated by requesting that resources only be rendered in a
      very restrictive sandbox. Sending the <code>sandbox</code> directive
      with an empty value establishes such an environment:</p>

<pre>Content-Security-Policy: <a data-link-type=dfn href=#sandbox title=sandbox>sandbox</a></pre>

<p>More trusted resources might be allowed to run in an environment
      with fewer restrictions by adding <code>allow-*</code> flags to the
      directive’s value. For example, you can allow a page that you trust
      to run script, while ensuring that it isn’t treated as same-origin
      with the rest of your site. This can be accomplished by sending the
      <code>sandbox</code> directive with the
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#attr-iframe-sandbox-allow-scripts title=allow-scripts>allow-scripts</a></code> flag:</p>

<pre>Content-Security-Policy: <a data-link-type=dfn href=#sandbox title=sandbox>sandbox</a> <a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#attr-iframe-sandbox-allow-scripts title=allow-scripts>allow-scripts</a></pre>

<p>The set of flags available to the CSP directive should match those
      available to the <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#the-iframe-element title=iframe>iframe</a></code> attribute.
      Currently, those include:</p>

      <ul>
        <li><code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#attr-iframe-sandbox-allow-forms title=allow-forms>allow-forms</a></code></li>
        <li><code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#attr-iframe-sandbox-allow-pointer-lock title=allow-pointer-lock>allow-pointer-lock</a></code></li>
        <li><code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#attr-iframe-sandbox-allow-popups title=allow-popups>allow-popups</a></code></li>
        <li><code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#attr-iframe-sandbox-allow-same-origin title=allow-same-origin>allow-same-origin</a></code></li>
        <li><code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#attr-iframe-sandbox-allow-scripts title=allow-scripts>allow-scripts</a></code>, and</li>
        <li><code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/browsers.html#attr-iframe-sandbox-allow-top-navigation title=allow-top-navigation>allow-top-navigation</a></code></li>
      </ul>

<p class=note>Note: Like the rest of Content Security Policy, the <code>sandbox</code>
      directive is meant as a defense-in-depth. Web authors would be well-served
      to use it <em>in addition to</em> standard sniffing-mitigation and
      privilege-reduction techniques.</p>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.17 id=directive-script-src><span class=secno>7.17 </span><span class=content><code>script-src</code></span><a class=self-link href=#directive-script-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=script-src>script-src<a class=self-link href=#script-src></a></dfn></code> directive restricts which scripts the
    protected resource can execute. The directive also controls other resources,
    such as XSLT style sheets <a data-biblio-type=normative data-link-type=biblio href=#biblio-xslt title=biblio-XSLT>[XSLT]</a>, which can cause the user agent to
    execute script. The syntax for the name and value of the directive are
    described by the following ABNF grammar:</p>

    <pre>directive-name    = "script-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-script-sources>allowed script sources<a class=self-link href=#allowed-script-sources></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>script-src</code>
    directive’s value as a source list</a> if the policy contains an
    explicit <code>script-src</code>, or otherwise to the <a data-link-type=dfn href=#default-sources title="default sources">default
    sources</a>.</p>

<p>If <code>'unsafe-inline'</code> is <strong>not</strong> in the
    list of <a data-link-type=dfn href=#allowed-script-sources title="allowed script sources">allowed script sources</a>, or if at least one
    <code><a data-link-type=dfn href=#nonce-source title=nonce-source>nonce-source</a></code> or <code><a data-link-type=dfn href=#hash-source title=hash-source>hash-source</a></code> is
    present in the list of <a data-link-type=dfn href=#allowed-script-sources title="allowed script sources">allowed script sources</a>:</p>

    <ul>
      <li>Whenever the user agent would execute an inline script from a
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> element that lacks a <a data-link-type=dfn href=#valid-nonce title="valid nonce">valid nonce</a>
      <em>and</em> lacks a <a data-link-type=dfn href=#valid-hash title="valid hash">valid hash</a> for the <a data-link-type=dfn href=#allowed-script-sources title="allowed script sources">allowed script
      sources</a>, instead the user agent MUST NOT execute script, <em>and</em>
      MUST <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>.</li>

      <li>Whenever the user agent would execute an inline script from an
      inline event handler, instead the user agent MUST NOT execute script,
      <em>and</em> MUST <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>.</li>

      <li>Whenever the user agent would execute script contained in a
      <code>javascript</code> URI, instead the user agent MUST NOT execute
      the script, <em>and</em> MUST <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>.</li>
    </ul>

<p>If <code>'unsafe-eval'</code> is <strong>not</strong> in <a data-link-type=dfn href=#allowed-script-sources title="allowed script sources">allowed script
    sources</a>:</p>

    <ul>
      <li>Instead of evaluating their arguments, both operator
      <code>eval</code> and function <code>eval</code> <a data-biblio-type=normative data-link-type=biblio href=#biblio-ecma-262 title=biblio-ECMA-262>[ECMA-262]</a>
      MUST throw an <code>EvalError</code> exception.</li>

      <li>When called as a constructor, the function <code>Function</code>
      <a data-biblio-type=normative data-link-type=biblio href=#biblio-ecma-262 title=biblio-ECMA-262>[ECMA-262]</a> MUST throw an <code>EvalError</code> exception.</li>

      <li>When called with a first argument that is not <a data-link-type=dfn href=#callable title=callable>callable</a> (a
      string, for example), the
      <code><a class=idl-code data-link-for=WindowTimers data-link-type=method href=http://www.w3.org/html/wg/drafts/html/CR/webappapis.html#dom-windowtimers-settimeout title=setTimeout()>setTimeout()</a></code> function MUST
      return zero without creating a timer.</li>

      <li>When called with a first argument that is not <a data-link-type=dfn href=#callable title=callable>callable</a> (a
      string, for example), the
      <code><a class=idl-code data-link-for=WindowTimers data-link-type=method href=http://www.w3.org/html/wg/drafts/html/CR/webappapis.html#dom-windowtimers-setinterval title=setInterval()>setInterval()</a></code> function MUST
      return zero without creating a timer.</li>
    </ul>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI (including when following redirects)
    in the course of one of the following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-script-sources title="allowed script sources">allowed script sources</a>,
    the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      <li>Requesting a script while processing the
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-img-src title=src>src</a></code> attribute
      of a <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> element that lacks a
      <a data-link-type=dfn href=#valid-nonce title="valid nonce">valid nonce</a> for the <a data-link-type=dfn href=#allowed-script-sources title="allowed script sources">allowed script sources</a>.</li>

      <li>Requesting a script while invoking the <code>importScripts</code>
      method on a WorkerGlobalScope object. <a data-biblio-type=normative data-link-type=biblio href=#biblio-workers title=biblio-WORKERS>[WORKERS]</a></li>

      <li>Requesting an HTML component, such as
      when processing the <code>href</code> attribute of a <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-link-element title=link>link</a></code>
      element with a <code>rel</code> attribute containing the token
      <code>import</code>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-html-imports title=biblio-HTML-IMPORTS>[HTML-IMPORTS]</a></li>

      <li>Requesting an Extensible Stylesheet Language Transformations
      (XSLT) <a data-biblio-type=normative data-link-type=biblio href=#biblio-xslt title=biblio-XSLT>[XSLT]</a>, such as when processing the
      <code>&lt;?xml-stylesheet?&gt;</code> processing directive in an XML
      document <a data-biblio-type=normative data-link-type=biblio href=#biblio-xml11 title=biblio-XML11>[XML11]</a>, the <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-base-href title=href>href</a></code> attributes
      on <code>&lt;xsl:include&gt;</code> and <code>&lt;xsl:import&gt;</code>
      elements.</li>
    </ul>

    <section class=informative>
      <h4 class="heading settled" data-level=7.17.1 id=script-src-nonce-usage><span class=secno>7.17.1 </span><span class=content>
        Nonce usage for <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> elements
      </span><a class=self-link href=#script-src-nonce-usage></a></h4>

<p><em>This section is not normative.</em></p>

<p>The <code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code> directive lets developers specify
      exactly which script elements on a page were intentionally included
      for execution. Ideally, developers would avoid inline script entirely
      and whitelist scripts by URL. However, in some cases, removing inline
      scripts can be difficult or impossible. For those cases, developers can
      whitelist scripts using a randomly generated nonce.</p>

<p>Usage is straightforward. For <em>each</em> request, the server
      generates a unique value at random, and includes it in the
      <code>Content-Security-Policy</code> header:</p>

      <pre>Content-Security-Policy: <a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self';
                         <a data-link-type=dfn href=#script-src title=script-src>script-src</a> 'self' https://example.com 'nonce-<em>$RANDOM</em>'
</pre>

<p>This same value is then applied as a <code>nonce</code> attribute
      to each <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> element that ought to be
      executed. For example, if the server generated the random value
      <code>Nc3n83cnSAd3wc3Sasdfn939hc3</code>,  the server would send the
      following policy:</p>

      <pre>Content-Security-Policy: <a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self';
                         <a data-link-type=dfn href=#script-src title=script-src>script-src</a> 'self' https://example.com 'nonce-Nc3n83cnSAd3wc3Sasdfn939hc3'
</pre>

<p>Script elements can then execute either because their
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/embedded-content-0.html#attr-img-src title=src>src</a></code> URLs are whitelisted or because
      they have a <a data-link-type=dfn href=#valid-nonce title="valid nonce">valid nonce</a>:</p>

      <pre>&lt;script&gt;
alert("Blocked because the policy doesn’t have 'unsafe-inline'.")
&lt;/script&gt;
&lt;script nonce="EDNnf03nceIOfn39fn3e9h3sdfa"&gt;
alert("Still blocked because nonce is wrong.")
&lt;/script&gt;
&lt;script nonce="Nc3n83cnSAd3wc3Sasdfn939hc3"&gt;
alert("Allowed because nonce is valid.")
&lt;/script&gt;
&lt;script src="https://example.com/allowed-because-of-src.js"&gt;&lt;/script&gt;
&lt;script nonce="EDNnf03nceIOfn39fn3e9h3sdfa"
    src="https://elsewhere.com/blocked-because-nonce-is-wrong.js"&gt;&lt;/script&gt;
&lt;script nonce="Nc3n83cnSAd3wc3Sasdfn939hc3"
    src="https://elsewhere.com/allowed-because-nonce-is-valid.js"&gt;&lt;/script&gt;
</pre>

<p>Note that the nonce’s value is <em>not</em> a hash or signature
      that verifies the contents of the script resources. It’s quite simply
      a random string that informs the user agent which scripts were
      intentionally included in the page.</p>

<p>Script elements with the proper nonce execute, regardless of
      whether they’re inline or external. Script elements without the
      proper nonce don’t execute unless their URLs are whitelisted.
      Even if an attacker is able to inject markup into the protected
      resource, the attack will be blocked by the attacker’s inability
      to guess the random value.</p>
    </section>
    <section class=informative>
      <h4 class="heading settled" data-level=7.17.2 id=script-src-hash-usage><span class=secno>7.17.2 </span><span class=content>
        Hash usage for <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> elements
      </span><a class=self-link href=#script-src-hash-usage></a></h4>

<p><em>This section is not normative.</em></p>

<p>The <code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code> directive lets developers whitelist a
      particular inline script by specifying its hash as an allowed source
      of script.</p>

<p>Usage is straightforward. The server computes the hash of a
      particular script block’s contents, and includes the base64 encoding
      of that value in the <code>Content-Security-Policy</code> header:</p>

      <pre>Content-Security-Policy: <a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self';
                         <a data-link-type=dfn href=#script-src title=script-src>script-src</a> 'self' https://example.com 'sha256-<var>base64 encoded hash</var>'
</pre>

<p>Each inline script block’s contents are hashed, and compared against
      the whitelisted value. If there’s a match, the script is executed. For
      example, the SHA-256 digest of <code>alert('Hello, world.');</code> is
      <code>YWIzOWNiNzJjNDRlYzc4MTgwMDhmZDlkOWI0NTAyMjgyY2MyMWJlMWUyNjc1ODJlYWJhNjU5MGU4NmZmNGU3OAo=</code>.
      If the server sent the following header:</p>

      <pre>Content-Security-Policy: <a data-link-type=dfn href=#script-src title=script-src>script-src</a> 'sha256-YWIzOWNiNzJjNDRlYzc4MTgwMDhmZDlkOWI0NTAyMjgyY2MyMWJlMWUyNjc1ODJlYWJhNjU5MGU4NmZmNGU3OAo='
</pre>

<p>Then the following script tag would result in script execution:</p>

      <pre>&lt;script&gt;alert('Hello, world.');&lt;/script&gt;
</pre>

<p>Whitespace is significant. The following scripts blocks would not hash to
      the same value, and would therefore <em>not</em> execute:</p>

      <pre>&lt;script&gt; alert('Hello, world.');&lt;/script&gt;
&lt;script&gt;alert('Hello, world.'); &lt;/script&gt;
&lt;script&gt; alert('Hello, world.'); &lt;/script&gt;
&lt;script&gt;
alert('Hello, world.');
&lt;/script&gt;
</pre>

<p>Note also that the hash applies <em>only</em> to inline script. An
      externalized script containing the value
      <code>alert('Hello, world.');</code> would <em>not</em> execute if its
      origin was not whitelisted as a valid source of script.</p>
    </section>
  </section>


  <section>
    <h3 class="heading settled" data-level=7.18 id=directive-style-src><span class=secno>7.18 </span><span class=content><code>style-src</code></span><a class=self-link href=#directive-style-src></a></h3>

<p>The <code><dfn data-dfn-type=dfn data-noexport="" id=style-src>style-src<a class=self-link href=#style-src></a></dfn></code> directive restricts which styles the
    user may applies to the protected resource. The syntax for the name and
    value of the directive are described by the following ABNF grammar:</p>

    <pre>directive-name    = "style-src"
directive-value   = <a data-link-type=dfn href=#source-list title=source-list>source-list</a>
</pre>

<p>The term <dfn data-dfn-type=dfn data-noexport="" id=allowed-style-sources>allowed style sources<a class=self-link href=#allowed-style-sources></a></dfn> refers to the result of
    <a data-link-type=dfn href=#parse-a-source-list title="parse a source list">parsing the <code>style-src</code>
    directive’s value as a source list</a> if the policy contains an
    explicit <code>style-src</code>, or otherwise to the <a data-link-type=dfn href=#default-sources title="default sources">default sources</a>.</p>

<p>If <code>'unsafe-inline'</code> is <strong>not</strong> in the
    list of <a data-link-type=dfn href=#allowed-style-sources title="allowed style sources">allowed style sources</a>, or if at least one
    <code><a data-link-type=dfn href=#nonce-source title=nonce-source>nonce-source</a></code> or <code><a data-link-type=dfn href=#hash-source title=hash-source>hash-source</a></code>
    is present in the list of <a data-link-type=dfn href=#allowed-style-sources title="allowed style sources">allowed style sources</a>:</p>

    <ul>
      <li>Whenever the user agent would apply style from a
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-style-element title=style>style</a></code> element that lacks a
      <a data-link-type=dfn href=#valid-nonce title="valid nonce">valid nonce</a> <em>and</em> lacks a <a data-link-type=dfn href=#valid-hash title="valid hash">valid hash</a> for the
      <a data-link-type=dfn href=#allowed-style-sources title="allowed style sources">allowed style sources</a>, instead the user agent <code>MUST</code>
      ignore the style, <em>and</em> MUST <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>.</li>

      <li>Whenever the user agent would apply style from a
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-style-element title=style>style</a></code> attribute, instead the user agent
      <code>MUST</code> ignore the style, <em>and</em> MUST <a data-link-type=dfn href=#report-a-violation title="report a violation">report a
      violation</a>.</li>
    </ul>

<p class=note>Note: These restrictions on inline do not prevent the user agent
    from applying style from an external stylesheet (e.g., found via
    <code>&lt;link rel="stylesheet" ...&gt;</code>).</p>

<p>If <code>'unsafe-eval'</code> is <strong>not</strong> in <a data-link-type=dfn href=#allowed-style-sources title="allowed style sources">allowed style
    sources</a>, then:</p>

    <ul>
      <li>Whenever the user agent would invoke the Cascading Style Sheets
      Object Model algorithms
      <a data-link-spec=CSSOM data-link-type=dfn href=http://dev.w3.org/csswg/cssom-1/#insert-a-css-rule title="insert a CSS rule">insert a CSS rule</a>, <a data-link-spec=CSSOM data-link-type=dfn href=http://dev.w3.org/csswg/cssom-1/#parse-a-css-rule title="parse a CSS rule">parse a CSS rule</a>,
      or <a data-link-spec=CSSOM data-link-type=dfn href=http://dev.w3.org/csswg/cssom-1/#parse-a-css-declaration-block title="parse a CSS declaration block">parse a CSS declaration block</a>,
      instead the user agent MUST throw a <a data-link-spec=HTML5 data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#securityerror title=SecurityError>SecurityError</a>
      exception <em>and</em> terminate the algorithm. This would include,
      for example, all invocations of CSSOM’s various <code>cssText</code>
      setters and <code>insertRule</code> methods. <a data-biblio-type=normative data-link-type=biblio href=#biblio-cssom title=biblio-CSSOM>[CSSOM]</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=biblio-HTML5>[HTML5]</a></li>
    </ul>

<p>Whenever the user agent <a data-link-type=dfn href=http://www.w3.org/html/wg/drafts/html/CR/infrastructure.html#fetch title=fetches>fetches</a> a URI in the course of one of the
    following activities, if the URI does not
    <a data-link-type=dfn href=#match-a-source-list title="match a source list">match</a> the <a data-link-type=dfn href=#allowed-style-sources title="allowed style sources">allowed style sources</a>,
    the user agent MUST act as if there was a fatal network error
    and no resource was obtained, <em>and</em> <a data-link-type=dfn href=#report-a-violation title="report a violation">report a violation</a>:</p>

    <ul>
      <li>Requesting external style sheets, such as when processing the
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-base-href title=href>href</a></code> attribute of a <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-link-element title=link>link</a></code> element with a
      <code><a data-link-type=element-attr href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#attr-link-rel title=rel>rel</a></code> attribute containing the token
      <code>stylesheet</code> or when processing the <a class="production css" data-link-type=at-rule href=http://dev.w3.org/csswg/css-cascade-3/#at-ruledef-import title=@import>&lt;@import&gt;</a>
      directive in a stylesheet.</li>
      
    </ul>

<p class=note>Note: The <code>style-src</code> directive does not restrict the
    use of XSLT. XSLT is restricted by the <code><a data-link-type=dfn href=#script-src title=script-src>script-src</a></code>
    directive because the security consequences of including an untrusted
    XSLT stylesheet are similar to those incurred by including an
    untrusted script.</p>

    <section class=informative>
      <h4 class="heading settled" data-level=7.18.1 id=style-src-nonce-usage><span class=secno>7.18.1 </span><span class=content>
        Nonce usage for <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-style-element title=style>style</a></code> elements
      </span><a class=self-link href=#style-src-nonce-usage></a></h4>

<p><em>This section is not normative.</em></p>

<p>See the <a href=#script-src-nonce-usage><code>script-src</code>
      nonce usage information</a> for detail; the application of nonces
      to <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-style-element title=style>style</a></code> elements is similar enough to avoid
      repetition here.</p>
    </section>
    <section class=informative>
      <h4 class="heading settled" data-level=7.18.2 id=style-src-hash-usage><span class=secno>7.18.2 </span><span class=content>
        Hash usage for <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-style-element title=style>style</a></code> elements
      </span><a class=self-link href=#style-src-hash-usage></a></h4>

<p><em>This section is not normative.</em></p>

<p>See the <a href=#script-src-hash-usage><code>script-src</code>
      hash usage information</a> for detail; the application of hashes
      to <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/document-metadata.html#the-style-element title=style>style</a></code> elements is similar enough to avoid
      repetition here.</p>
    </section>
  </section>
</section>


<section>
  <h2 class="heading settled" data-level=8 id=examples><span class=secno>8 </span><span class=content>Examples</span><a class=self-link href=#examples></a></h2>

  <section class=informative>
    <h3 class="heading settled" data-level=8.1 id=example-policies><span class=secno>8.1 </span><span class=content>Sample Policy Definitions</span><a class=self-link href=#example-policies></a></h3>

<p>This section provides some sample use cases and supporting <a data-link-type=dfn href=#security-policy title=policies>policies</a>.</p>

    <div class=example>
      A server wishes to load resources only from its own origin:

<pre>Content-Security-Policy: <a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self'</pre>
    </div>

    <div class=example>
      An auction site wishes to load images from any URI, plugin content from a
      list of trusted media providers (including a content distribution network),
      and scripts only from a server under its control hosting sanitized
      ECMAScript:

      <pre>Content-Security-Policy:
    <a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self'; img-src *;
    <a data-link-type=dfn href=#object-src title=object-src>object-src</a> media1.example.com media2.example.com *.cdn.example.com;
    <a data-link-type=dfn href=#script-src title=script-src>script-src</a> trustedscripts.example.com
</pre>
    </div>

    <div class=example>
      An online banking site wishes to ensure that all of the content in its pages
      is loaded over TLS to prevent attackers from eavesdropping on insecure
      content requests:

<pre>Content-Security-Policy: <a data-link-type=dfn href=#default-src title=default-src>default-src</a> https: 'unsafe-inline' 'unsafe-eval'</pre>

<p>This policy allows inline content (such as inline
      <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> elements), use of <code>eval</code>,
      and loading resources over <code>https</code>. Note: This policy does
      not provide any protection from cross-site scripting vulnerabilities.</p>
    </div>

    <div class=example>
      A website that relies on inline <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> elements
      wishes to ensure that script is only executed from its own origin, and those
      elements it intentionally inserted inline:

<pre>Content-Security-Policy: <a data-link-type=dfn href=#script-src title=script-src>script-src</a> 'self' 'nonce-<em>$RANDOM</em>';</pre>

<p>The inline <code><a data-link-type=element href=http://www.w3.org/html/wg/drafts/html/CR/scripting-1.html#script title=script>script</a></code> elements would then only
      execute if they contained a matching <code><a data-link-type=element-attr href=#element-attrdef-nonce title=nonce>nonce</a></code>
      attribute:</p>

<pre>&lt;script nonce="<em>$RANDOM</em>"&gt;...&lt;/script&gt;</pre>
    </div>
  </section>

  <section class=informative>
    <h3 class="heading settled" data-level=8.2 id=example-violation-report><span class=secno>8.2 </span><span class=content>Sample Violation Report</span><a class=self-link href=#example-violation-report></a></h3>

<p>This section contains an example violation report the user agent
    might sent to a server when the protected resource violations a sample
    policy.</p>

<p>In the following example, the user agent rendered a representation
    of the resource <code>http://example.org/page.html</code> with the
    following policy:</p>

<pre><a data-link-type=dfn href=#default-src title=default-src>default-src</a> 'self'; <a data-link-type=dfn href=#report-uri title=report-uri>report-uri</a> http://example.org/csp-report.cgi</pre>

<p>The protected resource loaded an image from
    <code>http://evil.example.com/image.png</code>, violating the
    policy.</p>

    <pre>{
  "csp-report": {
    "document-uri": "http://example.org/page.html",
    "referrer": "http://evil.example.com/haxor.html",
    "blocked-uri": "http://evil.example.com/image.png",
    "violated-directive": "default-src 'self'",
    "effective-directive": "img-src",
    "original-policy": "default-src 'self'; report-uri http://example.org/csp-report.cgi"
  }
}
</pre>
  </section>
</section>


<section>
  <h2 class="heading settled" data-level=9 id=security-considerations><span class=secno>9 </span><span class=content>Security Considerations</span><a class=self-link href=#security-considerations></a></h2>
  <section>
    <h3 class="heading settled" data-level=9.1 id=security-css-parsing><span class=secno>9.1 </span><span class=content>Cascading Style Sheet (CSS) Parsing</span><a class=self-link href=#security-css-parsing></a></h3>

<p>The <code><a data-link-type=dfn href=#style-src title=style-src>style-src</a></code> directive restricts the locations from
    which the protected resource can load styles. However, if the user agent uses a
    lax CSS parsing algorithm, an attacker might be able to trick the user
    agent into accepting malicious "stylesheets" hosted by an otherwise
    trustworthy origin.</p>

<p>These attacks are similar to the <a href=http://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html>CSS
    cross-origin data leakage</a> attack described by Chris Evans in 2009.
    User agents SHOULD defend against both attacks using the same
    mechanism: stricter CSS parsing rules for style sheets with improper
    MIME types.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=9.2 id=security-violation-reports><span class=secno>9.2 </span><span class=content>Violation Reports</span><a class=self-link href=#security-violation-reports></a></h3>

<p>The violation reporting mechanism in this document has been
    designed to mitigate the risk that a malicious web site could use
    violation reports to probe the behavior of other servers. For example,
    consider a malicious web site that white lists <code>https://example.com</code>
    as a source of images. If the malicious site attempts to load
    <code>https://example.com/login</code> as an image, and the
    <code>example.com</code> server redirects to an identity provider (e.g.,
    <code>idenityprovider.example.net</code>), CSP will block the request.
    If violation reports contained the full blocked URI, the violation
    report might contain sensitive information contained in the redirected URI,
    such as session identifiers or purported identities. For this reason, the
    user agent includes only the origin of the blocked URI.</p>
  </section>
</section>


<section>
  <h2 class="heading settled" data-level=10 id=implementation-considerations><span class=secno>10 </span><span class=content>Implementation Considerations</span><a class=self-link href=#implementation-considerations></a></h2>

<p>The <code><a data-link-type=dfn href=#content-security-policy title=Content-Security-Policy>Content-Security-Policy</a></code> header is an end-to-end
  header. It is processed and enforced at the client and, therefore,
  SHOULD NOT be modified or removed by proxies or other intermediaries not
  in the same administrative domain as the resource.</p>

<p>The originating administrative domain for a resource might wish to
  apply a <code><a data-link-type=dfn href=#content-security-policy title=Content-Security-Policy>Content-Security-Policy</a></code> header outside of the
  immediate context of an application. For example, a large organization
  might have many resources and applications managed by different
  individuals or teams but all subject to a uniform organizational
  standard. In such situations, a <code><a data-link-type=dfn href=#content-security-policy title=Content-Security-Policy>Content-Security-Policy</a></code>
  header might be added or combined with an existing one at a network-edge
  security gateway device or web application firewall. To enforce multiple
  policies, the administrator SHOULD combine the policy into a single header.
  An administrator might wish to use different combination algorithms
  depending on his or her intended semantics.</p>

<p>One sensible policy combination algorithm is to start by allowing a
  default set of sources and then letting individual upstream resource
  owners expand the set of allowed sources by including additional origins.
  In this approach, the resultant policy is the union of all allowed
  origins in the input policies.</p>

<p>Another sensible policy combination algorithm is to intersect the
  given policies. This approach enforces that content comes from a certain
  whitelist of origins, for example, preventing developers from including
  third-party scripts or content in violation of organizational standards
  and practices. In this approach, the combination algorithm forms the
  combined policy by removing disallowed hosts from the policies supplied
  by upstream resource owners.</p>

<p>Interactions between the <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a></code> and other directives
  SHOULD be given special consideration when combining policies. If none
  of the policies contains a <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a></code> directive, adding new
  src directives results in a more restrictive policy. However, if one or
  more of the input policies contain a <code><a data-link-type=dfn href=#default-src title=default-src>default-src</a></code> directive,
  adding new src directives might result in a less restrictive policy, for
  example, if the more specific directive contains a more permissive set of
  allowed origins.</p>

<p>Using a more restrictive policy than the input policy authored by the
  resource owner might prevent the resource from rendering or operating as
  intended.</p>

<p>Note also that migration to <code>HTTPS</code> from <code>HTTP</code>
  may require updates to the policy in order to keep things running as
  before. Source expressions like <code>http://example.com</code> do
  <em>not</em> match <code>HTTPS</code> resources. For example,
  administrators SHOULD carefully examine existing policies before rolling
  out <a href=http://tools.ietf.org/html/rfc6797>HTTP Strict Transport Security</a>
  headers for an application. <a data-biblio-type=informative data-link-type=biblio href=#biblio-rfc6797 title=biblio-RFC6797>[RFC6797]</a></p>
</section>


<section>
  <h2 class="heading settled" data-level=11 id=iana-considerations><span class=secno>11 </span><span class=content>IANA Considerations</span><a class=self-link href=#iana-considerations></a></h2>

<p>The permanent message header field registry should be updated
  with the following registrations: <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc3864 title=biblio-RFC3864>[RFC3864]</a></p>

  <section>
    <h3 class="heading settled" data-level=11.1 id=iana-content-security-policy><span class=secno>11.1 </span><span class=content>Content-Security-Policy</span><a class=self-link href=#iana-content-security-policy></a></h3>

    <dl>
      <dt>Header field name</dt>
      <dd>Content-Security-Policy</dd>

      <dt>Applicable protocol</dt>
      <dd>http</dd>

      <dt>Status</dt>
      <dd>standard</dd>

      <dt>Author/Change controller</dt>
      <dd>W3C</dd>

      <dt>Specification document</dt>
      <dd>This specification (See <code><a data-link-type=dfn href=#content-security-policy title=Content-Security-Policy>Content-Security-Policy</a></code>
      Header Field)</dd>
    </dl>
  </section>

  <section>
    <h3 class="heading settled" data-level=11.2 id=iana-content-security-policy-report-only><span class=secno>11.2 </span><span class=content>Content-Security-Policy-Report-Only</span><a class=self-link href=#iana-content-security-policy-report-only></a></h3>

    <dl>
      <dt>Header field name</dt>
      <dd>Content-Security-Policy-Report-Only</dd>

      <dt>Applicable protocol</dt>
      <dd>http</dd>

      <dt>Status</dt>
      <dd>standard</dd>

      <dt>Author/Change controller</dt>
      <dd>W3C</dd>

      <dt>Specification document</dt>
      <dd>This specification (See
      <code><a data-link-type=dfn href=#content-security-policy-report-only title=Content-Security-Policy-Report-Only>Content-Security-Policy-Report-Only</a></code> Header Field)</dd>
    </dl>
  </section>

  <section>
    <h3 class="heading settled" data-level=11.3 id=iana-ch-csp><span class=secno>11.3 </span><span class=content>CH-CSP</span><a class=self-link href=#iana-ch-csp></a></h3>

    <dl>
      <dt>Header field name</dt>
      <dd>CH-CSP</dd>

      <dt>Applicable protocol</dt>
      <dd>http</dd>

      <dt>Status</dt>
      <dd>standard</dd>

      <dt>Author/Change controller</dt>
      <dd>W3C</dd>

      <dt>Specification document</dt>
      <dd>This specification (See
      <code><a data-link-type=dfn href=#ch-csp title=CH-CSP>CH-CSP</a></code> Client Hint)</dd>
    </dl>
  </section>
</section>

<section>
  <h2 class="heading settled" data-level=12 id=acknowledgements><span class=secno>12 </span><span class=content>Acknowledgements</span><a class=self-link href=#acknowledgements></a></h2>

<p>In addition to the documents in the W3C Web Application Security working
  group, the work on this document is also informed by the work of the
  <a href=http://tools.ietf.org/wg/websec/>IETF websec working group</a>,
  particularly that working group’s requirements document:
  <a href=http://tools.ietf.org/id/draft-hodges-websec-framework-reqs>draft-hodges-websec-framework-reqs</a>.</p>

<p>A portion of the <code><a data-link-type=dfn href=#frame-ancestors title=frame-ancestors>frame-ancestors</a></code> directive was
  originally developed as <code>X-Frame-Options</code>. [RFC7034]</p>
</section>

<h2 class="no-ref no-num heading settled" id=conformance><span class=content>Conformance</span><a class=self-link href=#conformance></a></h2>

<h3 class="no-ref no-num heading settled" id=conventions><span class=content>Document conventions</span><a class=self-link href=#conventions></a></h3>

    <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc2119 title=biblio-RFC2119>[RFC2119]</a></p>

    <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    <div class=example>
        <p>This is an example of an informative example.</p>
    </div>

    <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    <p class=note>Note, this is an informative note.</p>

<h3 class="no-ref no-num heading settled" id=conformant-algorithms><span class=content>Conformant Algorithms</span><a class=self-link href=#conformant-algorithms></a></h3>

    <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>

    <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>

<h3 class="no-ref no-num heading settled" id=conformance-classes><span class=content>Conformance Classes</span><a class=self-link href=#conformance-classes></a></h3>

    <p>A <dfn data-dfn-type=dfn data-noexport="" id=conformant-user-agent>conformant user agent<a class=self-link href=#conformant-user-agent></a></dfn> must implement all the requirements
    listed in this specification that are applicable to user agents.</p>

    <p>A <dfn data-dfn-type=dfn data-noexport="" id=conformant-server>conformant server<a class=self-link href=#conformant-server></a></dfn> must implement all the requirements listed
    in this specification that are applicable to servers.</p>


<h2 class="no-num no-ref heading settled" id=references><span class=content>
References</span><a class=self-link href=#references></a></h2>

<h3 class="no-num no-ref heading settled" id=normative><span class=content>
Normative References</span><a class=self-link href=#normative></a></h3>
<div data-fill-with=normative-references><dl>
<dt id=biblio-abnf title=ABNF><a class=self-link href=#biblio-abnf></a>[ABNF]<dd>Dave Crocker; Paul Overell. <a href=http://www.ietf.org/rfc/rfc5234.txt>Augmented BNF for Syntax Specifications: ABNF</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc5234.txt>http://www.ietf.org/rfc/rfc5234.txt</a></dd>
<dt id=biblio-beacon title=BEACON><a class=self-link href=#biblio-beacon></a>[BEACON]<dd>Jatinder Mann; Alois Reitbauer. <a href=http://www.w3.org/TR/beacon/>Beacon</a>. WD. URL: <a href=http://www.w3.org/TR/beacon/>http://www.w3.org/TR/beacon/</a></dd>
<dt id=biblio-css3-fonts title=CSS3-FONTS><a class=self-link href=#biblio-css3-fonts></a>[CSS3-FONTS]<dd>John Daggett. <a href=http://www.w3.org/TR/2013/WD-css3-fonts-20130212/>CSS Fonts Module Level 3</a>. 12 February 2013. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2013/WD-css3-fonts-20130212/>http://www.w3.org/TR/2013/WD-css3-fonts-20130212/</a></dd>
<dt id=biblio-css4-images title=CSS4-IMAGES><a class=self-link href=#biblio-css4-images></a>[CSS4-IMAGES]<dd>Elika J. Etemad; Tab Atkins Jr.. <a href=http://www.w3.org/TR/2012/WD-css4-images-20120911/>CSS Image Values and Replaced Content Module Level 4</a>. 11 September 2012. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/WD-css4-images-20120911/>http://www.w3.org/TR/2012/WD-css4-images-20120911/</a></dd>
<dt id=biblio-cssom title=CSSOM><a class=self-link href=#biblio-cssom></a>[CSSOM]<dd>Anne van Kesteren. <a href=http://www.w3.org/TR/2011/WD-cssom-20110712/>CSSOM</a>. 12 July 2011. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2011/WD-cssom-20110712/>http://www.w3.org/TR/2011/WD-cssom-20110712/</a></dd>
<dt id=biblio-ecma-262 title=ECMA-262><a class=self-link href=#biblio-ecma-262></a>[ECMA-262]<dd>???. <a href=http://www.ecma-international.org/publications/standards/Ecma-262.htm>ECMAScript Language Specification, Third Edition</a>. December 1999. URL: <a href=http://www.ecma-international.org/publications/standards/Ecma-262.htm>http://www.ecma-international.org/publications/standards/Ecma-262.htm</a></dd>
<dt id=biblio-eventsource title=EVENTSOURCE><a class=self-link href=#biblio-eventsource></a>[EVENTSOURCE]<dd>Ian Hickson. <a href=http://www.w3.org/TR/2012/CR-eventsource-20121211/>Server-Sent Events</a>. 11 December 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-eventsource-20121211/>http://www.w3.org/TR/2012/CR-eventsource-20121211/</a></dd>
<dt id=biblio-html-imports title=HTML-IMPORTS><a class=self-link href=#biblio-html-imports></a>[HTML-IMPORTS]<dd>Dmitri Glazkov; Hajime Morrita. <a href=http://www.w3.org/TR/html-imports/>HTML Imports</a>. WD. URL: <a href=http://www.w3.org/TR/html-imports/>http://www.w3.org/TR/html-imports/</a></dd>
<dt id=biblio-html5 title=HTML5><a class=self-link href=#biblio-html5></a>[HTML5]<dd>Robin Berjon; et al. <a href=http://www.w3.org/TR/2014/WD-html5-20140617/>HTML5</a>. 17 June 2014. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2014/WD-html5-20140617/>http://www.w3.org/TR/2014/WD-html5-20140617/</a></dd>
<dt id=biblio-referrer title=REFERRER><a class=self-link href=#biblio-referrer></a>[REFERRER]<dd>Jochen Eisinger; Mike West. <a href=https://w3c.github.io/webappsec/specs/referrer-policy/>Referrer Policy</a>. FPWD. URL: <a href=https://w3c.github.io/webappsec/specs/referrer-policy/>https://w3c.github.io/webappsec/specs/referrer-policy/</a></dd>
<dt id=biblio-rfc2119 title=RFC2119><a class=self-link href=#biblio-rfc2119></a>[RFC2119]<dd>S. Bradner. <a href=http://www.ietf.org/rfc/rfc2119.txt>Key words for use in RFCs to Indicate Requirement Levels</a>. URL: <a href=http://www.ietf.org/rfc/rfc2119.txt>http://www.ietf.org/rfc/rfc2119.txt</a></dd>
<dt id=biblio-rfc3492 title=RFC3492><a class=self-link href=#biblio-rfc3492></a>[RFC3492]<dd>Adam M. Costello. <a href=http://www.ietf.org/rfc/rfc3492.txt>Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)</a>. REC. URL: <a href=http://www.ietf.org/rfc/rfc3492.txt>http://www.ietf.org/rfc/rfc3492.txt</a></dd>
<dt id=biblio-rfc3864 title=RFC3864><a class=self-link href=#biblio-rfc3864></a>[RFC3864]<dd>Graham Klyne; Mark Nottingham; Jeffrey C. Mogul. <a href=http://www.ietf.org/rfc/rfc3864.txt>Registration Procedures for Message Header Fields</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc3864.txt>http://www.ietf.org/rfc/rfc3864.txt</a></dd>
<dt id=biblio-rfc4627 title=RFC4627><a class=self-link href=#biblio-rfc4627></a>[RFC4627]<dd>Douglas Crockford. <a href=http://www.ietf.org/rfc/rfc4627.txt>The 'application/json' Media Type for JavaScript Object Notation (JSON)</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc4627.txt>http://www.ietf.org/rfc/rfc4627.txt</a></dd>
<dt id=biblio-rfc6454 title=RFC6454><a class=self-link href=#biblio-rfc6454></a>[RFC6454]<dd>Adam Barth. <a href=http://www.ietf.org/rfc/rfc6454.txt>The Web Origin Concept</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc6454.txt>http://www.ietf.org/rfc/rfc6454.txt</a></dd>
<dt id=biblio-rfc7034 title=RFC7034><a class=self-link href=#biblio-rfc7034></a>[RFC7034]<dd>David Ross; Tobias Gondrom. <a href=http://www.ietf.org/rfc/rfc7034.txt>HTTP Header Field X-Frame-Options</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc7034.txt>http://www.ietf.org/rfc/rfc7034.txt</a></dd>
<dt id=biblio-rfc7230 title=RFC7230><a class=self-link href=#biblio-rfc7230></a>[RFC7230]<dd>Roy T. Fielding; Julian F. Reschke. <a href=http://www.ietf.org/rfc/rfc7230.txt>HTTP/1.1 Message Syntax and Routing</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc7230.txt>http://www.ietf.org/rfc/rfc7230.txt</a></dd>
<dt id=biblio-rfc7231 title=RFC7231><a class=self-link href=#biblio-rfc7231></a>[RFC7231]<dd>Roy T. Fielding; Julian F. Reschke. <a href=http://www.ietf.org/rfc/rfc7231.txt>HTTP/1.1 Semantics and Content</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc7231.txt>http://www.ietf.org/rfc/rfc7231.txt</a></dd>
<dt id=biblio-uri title=URI><a class=self-link href=#biblio-uri></a>[URI]<dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href=http://www.ietf.org/rfc/rfc3986.txt>Uniform Resource Identifiers (URI): generic syntax</a>. January 2005. URL: <a href=http://www.ietf.org/rfc/rfc3986.txt>http://www.ietf.org/rfc/rfc3986.txt</a></dd>
<dt id=biblio-webidl title=WEBIDL><a class=self-link href=#biblio-webidl></a>[WEBIDL]<dd>Cameron McCormack. <a href=http://www.w3.org/TR/2012/CR-WebIDL-20120419/>Web IDL</a>. 19 April 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-WebIDL-20120419/>http://www.w3.org/TR/2012/CR-WebIDL-20120419/</a></dd>
<dt id=biblio-websockets title=WEBSOCKETS><a class=self-link href=#biblio-websockets></a>[WEBSOCKETS]<dd>Ian Hickson. <a href=http://www.w3.org/TR/2012/CR-websockets-20120920/>The WebSocket API</a>. 20 September 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-websockets-20120920/>http://www.w3.org/TR/2012/CR-websockets-20120920/</a></dd>
<dt id=biblio-workers title=WORKERS><a class=self-link href=#biblio-workers></a>[WORKERS]<dd>Ian Hickson. <a href=http://www.w3.org/TR/2012/CR-workers-20120501/>Web Workers</a>. 1 May 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-workers-20120501/>http://www.w3.org/TR/2012/CR-workers-20120501/</a></dd>
<dt id=biblio-xml11 title=XML11><a class=self-link href=#biblio-xml11></a>[XML11]<dd>Eve Maler; et al. <a href=http://www.w3.org/TR/2006/REC-xml11-20060816>Extensible Markup Language (XML) 1.1 (Second Edition)</a>. 16 August 2006. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2006/REC-xml11-20060816>http://www.w3.org/TR/2006/REC-xml11-20060816</a></dd>
<dt id=biblio-xmlhttprequest title=XMLHTTPREQUEST><a class=self-link href=#biblio-xmlhttprequest></a>[XMLHTTPREQUEST]<dd>Julian Aubourg; 송정기 (Jungkee Song); Hallvord R. M. Steen. <a href=http://www.w3.org/TR/2012/WD-XMLHttpRequest-20121206/>XMLHttpRequest</a>. 6 December 2012. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/WD-XMLHttpRequest-20121206/>http://www.w3.org/TR/2012/WD-XMLHttpRequest-20121206/</a></dd>
<dt id=biblio-xslt title=XSLT><a class=self-link href=#biblio-xslt></a>[XSLT]<dd>James Clark. <a href=http://www.w3.org/TR/1999/REC-xslt-19991116>XSL Transformations (XSLT) Version 1.0</a>. 16 November 1999. W3C Recommendation. URL: <a href=http://www.w3.org/TR/1999/REC-xslt-19991116>http://www.w3.org/TR/1999/REC-xslt-19991116</a></dd>
</dl></div>

<h3 class="no-num no-ref heading settled" id=informative><span class=content>
Informative References</span><a class=self-link href=#informative></a></h3>
<div data-fill-with=informative-references><dl>
<dt id=biblio-rfc6797 title=RFC6797><a class=self-link href=#biblio-rfc6797></a>[RFC6797]<dd>Jeff Hodges; Collin Jackson; Adam Barth. <a href=http://www.ietf.org/rfc/rfc6797.txt>HTTP Strict Transport Security (HSTS)</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc6797.txt>http://www.ietf.org/rfc/rfc6797.txt</a></dd>
<dt id=biblio-uiredress title=UIREDRESS><a class=self-link href=#biblio-uiredress></a>[UIREDRESS]<dd>Giorgio Maone; et al. <a href=http://www.w3.org/TR/UISecurity/>User Interface Security Directives for Content Security Policy</a>. WD. URL: <a href=http://www.w3.org/TR/UISecurity/>http://www.w3.org/TR/UISecurity/</a></dd>
</dl></div>

<h2 class="no-num no-ref heading settled" id=index><span class=content>
Index</span><a class=self-link href=#index></a></h2>
<div data-fill-with=index><ul class=indexlist>
<li>allowed base URIs, <a href=#allowed-base-uris title="section 7.1">7.1</a>
<li>allowed child sources, <a href=#allowed-child-sources title="section 7.2">7.2</a>
<li>allowed connection targets, <a href=#allowed-connection-targets title="section 7.3">7.3</a>
<li>allowed font sources, <a href=#allowed-font-sources title="section 7.5">7.5</a>
<li>allowed form actions, <a href=#allowed-form-actions title="section 7.6">7.6</a>
<li>allowed frame ancestors, <a href=#allowed-frame-ancestors title="section 7.7">7.7</a>
<li>allowed frame sources, <a href=#allowed-frame-sources title="section 7.8">7.8</a>
<li>allowed image sources, <a href=#allowed-image-sources title="section 7.9">7.9</a>
<li>allowed media sources, <a href=#allowed-media-sources title="section 7.10">7.10</a>
<li>allowed object sources, <a href=#allowed-object-sources title="section 7.11">7.11</a>
<li>allowed plugin media types, <a href=#allowed-plugin-media-types title="section 7.12">7.12</a>
<li>allowed script sources, <a href=#allowed-script-sources title="section 7.17">7.17</a>
<li>allowed style sources, <a href=#allowed-style-sources title="section 7.18">7.18</a>
<li>base64-value, <a href=#base64-value title="section 4.2">4.2</a>
<li>base-uri, <a href=#base-uri title="section 7.1">7.1</a>
<li>blockedURI<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-blockeduri title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-blockeduri title="section 6.2">6.2</a>
</ul><li>callable, <a href=#callable title="section 2">2</a>
<li>callers, <a href=#callers title="section 2">2</a>
<li>CH-CSP, <a href=#ch-csp title="section 3.4">3.4</a>
<li>child-src, <a href=#child-src title="section 7.2">7.2</a>
<li>columnNumber<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-columnnumber title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-columnnumber title="section 6.2">6.2</a>
</ul><li>conformant server, <a href=#conformant-server title="section Unnumbered section">Unnumbered section</a>
<li>conformant user agent, <a href=#conformant-user-agent title="section Unnumbered section">Unnumbered section</a>
<li>connect-src, <a href=#connect-src title="section 7.3">7.3</a>
<li>Content-Security-Policy, <a href=#content-security-policy title="section 3.1">3.1</a>
<li>Content-Security-Policy-Report-Only, <a href=#content-security-policy-report-only title="section 3.2">3.2</a>
<li>Content Security Policy task
          source, <a href=#content-security-policy-task-source title="section 4.4">4.4</a>
<li>default sources, <a href=#default-sources title="section 7.4">7.4</a>
<li>default-src, <a href=#default-src title="section 7.4">7.4</a>
<li>digest of element’s content, <a href=#digest-of-elements-content title="section 4.2.5">4.2.5</a>
<li>directive, <a href=#security-policy-directive title="section 2">2</a>
<li>directive name, <a href=#directive-name0 title="section 2">2</a>
<li>directive-name, <a href=#directive-name title="section 4.1">4.1</a>
<li>directive-token, <a href=#directive-token title="section 4.1">4.1</a>
<li>directive-value, <a href=#directive-value title="section 4.1">4.1</a>
<li>directive value, <a href=#directive-value0 title="section 2">2</a>
<li>documentURI<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-documenturi title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-documenturi title="section 6.2">6.2</a>
</ul><li>effectiveDirective<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-effectivedirective title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-effectivedirective title="section 6.2">6.2</a>
</ul><li>element’s content, <a href=#elements-content title="section 4.2.5">4.2.5</a>
<li>enforce, <a href=#enforce title="section 5">5</a>
<li>eventInitDict, <a href=#dom-securitypolicyviolationevent-securitypolicyviolationevent-eventinitdict title="section 6.1">6.1</a>
<li>fire a violation event, <a href=#fire-a-violation-event title="section 6.3">6.3</a>
<li>font-src, <a href=#font-src title="section 7.5">7.5</a>
<li>form-action, <a href=#form-action title="section 7.6">7.6</a>
<li>frame-ancestors, <a href=#frame-ancestors title="section 7.7">7.7</a>
<li>frame-src, <a href=#frame-src title="section 7.8">7.8</a>
<li>generate a violation report object, <a href=#generate-a-violation-report-object title="section 4.4">4.4</a>
<li>generating a violation report object, <a href=#generate-a-violation-report-object title="section 4.4">4.4</a>
<li>globally unique identifier, <a href=#globally-unique-identifier title="section 2">2</a>
<li>hash-algo, <a href=#hash-algo title="section 4.2">4.2</a>
<li>hash-source, <a href=#hash-source title="section 4.2">4.2</a>
<li>hash-value, <a href=#hash-value title="section 4.2">4.2</a>
<li>hint-value, <a href=#hint-value title="section 3.4">3.4</a>
<li>host-char, <a href=#host-char title="section 4.2">4.2</a>
<li>host-part, <a href=#host-part title="section 4.2">4.2</a>
<li>host-source, <a href=#host-source title="section 4.2">4.2</a>
<li>HTTP 200 response, <a href=#http-200-response title="section 2">2</a>
<li>img-src, <a href=#img-src title="section 7.9">7.9</a>
<li>JSON object, <a href=#json-object title="section 2">2</a>
<li>JSON stringification, <a href=#json-stringification title="section 2">2</a>
<li>keyword-source, <a href=#keyword-source title="section 4.2">4.2</a>
<li>lineNumber<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-linenumber title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-linenumber title="section 6.2">6.2</a>
</ul><li>match a media type list, <a href=#match-a-media-type-list title="section 4.3.2">4.3.2</a>
<li>match a source expression, <a href=#match-a-source-expression title="section 4.2.2">4.2.2</a>
<li>match a source list, <a href=#match-a-source-list title="section 4.2.2">4.2.2</a>
<li>media-src, <a href=#media-src title="section 7.10">7.10</a>
<li>media type, <a href=#media-type0 title="section 4.3">4.3</a>
<li>media-type, <a href=#media-type title="section 4.3">4.3</a>
<li>media type list, <a href=#media-type-list0 title="section 4.3">4.3</a>
<li>media-type-list, <a href=#media-type-list1 title="section 4.3">4.3</a>
<li>monitor, <a href=#monitor title="section 5">5</a>
<li>nonce<ul><li>(element-attr), <a href=#element-attrdef-nonce title="section 4.2.3">4.2.3</a>
<li>attribute for HTMLScriptElement, <a href=#dom-htmlscriptelement-nonce title="section 4.2.3">4.2.3</a>
<li>attribute for HTMLStyleElement, <a href=#dom-htmlstyleelement-nonce title="section 4.2.3">4.2.3</a>
</ul><li>nonce-source, <a href=#nonce-source title="section 4.2">4.2</a>
<li>nonce-value, <a href=#nonce-value title="section 4.2">4.2</a>
<li>object-src, <a href=#object-src title="section 7.11">7.11</a>
<li>origin, <a href=#origin title="section 2">2</a>
<li>originalPolicy<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-originalpolicy title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-originalpolicy title="section 6.2">6.2</a>
</ul><li>parse a media type list, <a href=#parse-a-media-type-list title="section 4.3.1">4.3.1</a>
<li>parse a source list, <a href=#parse-a-source-list title="section 4.2.1">4.2.1</a>
<li>parse the policy, <a href=#parse-the-policy title="section 4.1.1">4.1.1</a>
<li>path-part, <a href=#path-part title="section 4.2">4.2</a>
<li>plugin-types, <a href=#plugin-types title="section 7.12">7.12</a>
<li>policy, <a href=#security-policy title="section 2">2</a>
<li>policy-token, <a href=#policy-token title="section 4.1">4.1</a>
<li>port-part, <a href=#port-part title="section 4.2">4.2</a>
<li>protected resource, <a href=#protected-resource title="section 2">2</a>
<li>referrer<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-referrer title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-referrer title="section 6.2">6.2</a>
<li>definition of, <a href=#referrer title="section 7.13">7.13</a>
</ul><li>reflected-xss, <a href=#reflected-xss title="section 7.14">7.14</a>
<li>report a violation, <a href=#report-a-violation title="section 4.4">4.4</a>
<li>report-uri, <a href=#report-uri title="section 7.15">7.15</a>
<li>resource representation, <a href=#resource-representation title="section 2">2</a>
<li>runs a worker, <a href=#runs-a-worker title="section 2">2</a>
<li>sandbox, <a href=#sandbox title="section 7.16">7.16</a>
<li>sandbox-token, <a href=#sandbox-token title="section 7.16">7.16</a>
<li>scheme-part, <a href=#scheme-part title="section 4.2">4.2</a>
<li>scheme-source, <a href=#scheme-source title="section 4.2">4.2</a>
<li>script-src, <a href=#script-src title="section 7.17">7.17</a>
<li>security policy, <a href=#security-policy title="section 2">2</a>
<li>security policy directive, <a href=#security-policy-directive title="section 2">2</a>
<li>SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent title="section 6.1">6.1</a>
<li>SecurityPolicyViolationEventInit, <a href=#dictdef-securitypolicyviolationeventinit title="section 6.2">6.2</a>
<li>send violation reports, <a href=#send-violation-reports title="section 4.4">4.4</a>
<li>set of report URIs, <a href=#set-of-report-uris title="section 7.15">7.15</a>
<li>SHA-256, <a href=#sha-256 title="section 2">2</a>
<li>SHA-384, <a href=#sha-384 title="section 2">2</a>
<li>SHA-512, <a href=#sha-512 title="section 2">2</a>
<li>source-expression, <a href=#source-expression title="section 4.2">4.2</a>
<li>source expression, <a href=#source-expression0 title="section 4.2">4.2</a>
<li>source-file, <a href=#source-file title="section 4.4">4.4</a>
<li>sourceFile<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-sourcefile title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-sourcefile title="section 6.2">6.2</a>
</ul><li>source-list, <a href=#source-list title="section 4.2">4.2</a>
<li>source
    list, <a href=#source-list0 title="section 4.2">4.2</a>
<li>stripped for reporting, <a href=#strip-uri-for-reporting title="section 4.4">4.4</a>
<li>strip uri for reporting, <a href=#strip-uri-for-reporting title="section 4.4">4.4</a>
<li>style-src, <a href=#style-src title="section 7.18">7.18</a>
<li>type, <a href=#dom-securitypolicyviolationevent-securitypolicyviolationevent-type title="section 6.1">6.1</a>
<li>URI, <a href=#uri title="section 2">2</a>
<li>uri-reference, <a href=#uri-reference title="section 7.15">7.15</a>
<li>valid hash, <a href=#valid-hash title="section 4.2.5">4.2.5</a>
<li>valid nonce, <a href=#valid-nonce title="section 4.2.4">4.2.4</a>
<li>violatedDirective<ul><li>attribute for SecurityPolicyViolationEvent, <a href=#dom-securitypolicyviolationevent-violateddirective title="section 6.1">6.1</a>
<li>attribute for SecurityPolicyViolationEventInit, <a href=#dom-securitypolicyviolationeventinit-violateddirective title="section 6.2">6.2</a>
</ul></ul></div>



