<!doctype html>
<html lang="en">
 <head>
  
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  
  
  <title>Content Security Policy Level 3</title>
  
  
  <link href="../default.css" rel="stylesheet" type="text/css">
  
  
  <style>
  body {
    background: url("https://www.w3.org/StyleSheets/TR/logo-ED") top left no-repeat white;
    background-attachment: fixed;
    color: black;
    font-family: sans-serif;
    margin: 0 auto;
    max-width: 50em;
    padding: 2em 1em 2em 70px;
  }
  :link { color: #00C; background: transparent }
  :visited { color: #609; background: transparent }
  a[href]:active { color: #C00; background: transparent }
  a[href]:hover { background: #ffa }

  a[href] img { border-style: none }

  h1, h2, h3, h4, h5, h6 { text-align: left }
  h1, h2, h3 { color: #005A9C; }
  h1 { font: 170% sans-serif }
  h2 { font: 140% sans-serif }
  h3 { font: 120% sans-serif }
  h4 { font: bold 100% sans-serif }
  h5 { font: italic 100% sans-serif }
  h6 { font: small-caps 100% sans-serif }

  .hide { display: none }

  div.head { margin-bottom: 1em }
  div.head h1 { margin-top: 2em; clear: both }
  div.head table { margin-left: 2em; margin-top: 2em }

  p.copyright { font-size: small }
  p.copyright small { font-size: small }

  pre { margin-left: 2em }
  dt { font-weight: bold }

  ul.toc, ol.toc {
    list-style: none;
  }
  </style>
  

  <meta content="Bikeshed 1.0.0" name="generator">
 </head>
 

 <body class="h-entry">

  <div class="head">
  
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72">
</a>
</p>
  
   <h1 class="p-name no-ref" id="title">Content Security Policy Level 3</h1>
  
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft,
    <time class="dt-updated" datetime="2015-08-13">13 August 2015</time></span></h2>
  
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/webappsec/specs/CSP3/">https://w3c.github.io/webappsec/specs/CSP3/</a>
     <dt>Latest version:
     <dd><a href="http://www.w3.org/TR/CSP3/">http://www.w3.org/TR/CSP3/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BCSP%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[CSP] <var>… message topic …</var></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/w3c/webappsec/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
     <dt>Bug Reports:
     <dd><span><a href="https://github.com/w3c/webappsec/issues/new?title=CSP3:%20">via the w3c/webappsec repository on GitHub</a></span>
    </dl>
   </div>
  
   <div data-fill-with="warning"></div>
  
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.
</p>
  
   <hr title="Separator for header">
</div>


  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>

  <div class="p-summary" data-fill-with="abstract">
   <p>This document defines a mechanism by which web developers can control the

resources which a particular page can fetch or execute, as well as a number
of security-relevant policy decisions.</p>

</div>


  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>

  <div data-fill-with="status">
   <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
   <p>
  <strong>Changes to this document may be tracked at
  <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong>

</p>
   <p>
	The (<a href="http://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list
	<a href="mailto:public-webappsec@w3.org?Subject=%5BCSP%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
	(see <a href="http://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “CSP” in the subject,
	preferably like this:
	“[CSP] <em>…summary of comment…</em>”

</p>
   <p>
	This document was produced by the
  <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>.

</p>
   <p>
	This document was produced by a group operating under
	the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a>
	made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a>
	must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.

</p>
   <p>
  This document is governed by the <a href="http://www.w3.org/2014/Process-20140801/" id="w3c_process_revision">1 August 2014 W3C Process Document</a>.

</p></div>

  <div data-fill-with="at-risk"></div>


  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>

  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li><a href="#examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
       <ul class="toc">
        <li><a href="#example-basic"><span class="secno">1.1.1</span> <span class="content">Control Execution</span></a>
       </ul>
      <li><a href="#goals"><span class="secno">1.2</span> <span class="content">Goals</span></a>
      <li><a href="#changes-from-level-2"><span class="secno">1.3</span> <span class="content">Changes from Level 2</span></a>
     </ul>
    <li><a href="#framework"><span class="secno">2</span> <span class="content">Framework</span></a>
    <li><a href="#policy-delivery"><span class="secno">3</span> <span class="content">
    Policy Delivery
  </span></a>
     <ul class="toc">
      <li><a href="#delivery-declarative"><span class="secno">3.1</span> <span class="content">
    Declarative Delivery
  </span></a>
       <ul class="toc">
        <li><a href="#csp-header"><span class="secno">3.1.1</span> <span class="content">
    The <code>Content-Security-Policy</code> HTTP Response Header Field
  </span></a>
        <li><a href="#cspro-header"><span class="secno">3.1.2</span> <span class="content">
    The <code>Content-Security-Policy-Report-Only</code> HTTP Response Header Field
  </span></a>
        <li><a href="#meta-element"><span class="secno">3.1.3</span> <span class="content">
    The <code>&lt;meta></code> element
  </span></a>
       </ul>
      <li><a href="#delivery-implicit"><span class="secno">3.2</span> <span class="content">
    Implicit Delivery 
  </span></a>
      <li><a href="#javascript-interface"><span class="secno">3.3</span> <span class="content">
    Imperative Delivery
  </span></a>
       <ul class="toc">
        <li><a href="#javascript-application"><span class="secno">3.3.1</span> <span class="content">
    Applying a Policy
  </span></a>
        <li><a href="#idl-securitypolicy"><span class="secno">3.3.2</span> <span class="content">
    <code>SecurityPolicy</code> Interface
  </span></a>
        <li><a href="#idl-securitypolicydirective"><span class="secno">3.3.3</span> <span class="content">
    <code>SecurityPolicyDirective</code> Interface
  </span></a>
        <li><a href="#idl-sourcelistdirective"><span class="secno">3.3.4</span> <span class="content">
    <code>SourceListDirective</code> Interface
  </span></a>
        <li><a href="#idl-sourceexpression"><span class="secno">3.3.5</span> <span class="content">
    <code>SourceExpression</code> Interface
  </span></a>
       </ul>
     </ul>
    <li><a href="#syntax"><span class="secno">4</span> <span class="content">
    Policy Syntax
  </span></a>
     <ul class="toc">
      <li><a href="#syntax-source-list"><span class="secno">4.1</span> <span class="content">
    Source List Syntax
  </span></a>
       <ul class="toc">
        <li><a href="#script-src-the-nonce-attribute"><span class="secno">4.1.1</span> <span class="content">
    The <code>nonce</code> attribute
  </span></a>
       </ul>
     </ul>
    <li><a href="#reporting"><span class="secno">5</span> <span class="content">
    Reporting
  </span></a>
    <li><a href="#csp-directives"><span class="secno">6</span> <span class="content">
    Content Security Policy Directives
  </span></a>
     <ul class="toc">
      <li><a href="#directives-request"><span class="secno">6.1</span> <span class="content">
    Request Directives
  </span></a>
       <ul class="toc">
        <li><a href="#directive-child-src"><span class="secno">6.1.1</span> <span class="content"><code>child-src</code></span></a>
        <li><a href="#directive-connect-src"><span class="secno">6.1.2</span> <span class="content"><code>connect-src</code></span></a>
        <li><a href="#directive-default-src"><span class="secno">6.1.3</span> <span class="content"><code>default-src</code></span></a>
        <li><a href="#directive-font-src"><span class="secno">6.1.4</span> <span class="content"><code>font-src</code></span></a>
        <li><a href="#directive-img-src"><span class="secno">6.1.5</span> <span class="content"><code>img-src</code></span></a>
        <li><a href="#directive-media-src"><span class="secno">6.1.6</span> <span class="content"><code>media-src</code></span></a>
        <li><a href="#directive-object-src"><span class="secno">6.1.7</span> <span class="content"><code>object-src</code></span></a>
        <li><a href="#directive-script-src"><span class="secno">6.1.8</span> <span class="content"><code>script-src</code></span></a>
        <li><a href="#directive-style-src"><span class="secno">6.1.9</span> <span class="content"><code>style-src</code></span></a>
       </ul>
      <li><a href="#directives-other"><span class="secno">6.2</span> <span class="content">
    Grabbag
  </span></a>
       <ul class="toc">
        <li><a href="#directive-base-uri"><span class="secno">6.2.1</span> <span class="content"><code>base-uri</code></span></a>
        <li><a href="#directive-form-action"><span class="secno">6.2.2</span> <span class="content"><code>form-action</code></span></a>
        <li><a href="#directive-frame-ancestors"><span class="secno">6.2.3</span> <span class="content"><code>frame-ancestors</code></span></a>
        <li><a href="#directive-plugin-types"><span class="secno">6.2.4</span> <span class="content"><code>plugin-types</code></span></a>
        <li><a href="#directive-sandbox"><span class="secno">6.2.5</span> <span class="content"><code>sandbox</code></span></a>
       </ul>
      <li><a href="#directives-reporting"><span class="secno">6.3</span> <span class="content">
    Reporting Directives
  </span></a>
       <ul class="toc">
        <li><a href="#directive-report-uri"><span class="secno">6.3.1</span> <span class="content"><code>report-uri</code></span></a>
        <li><a href="#directive-report"><span class="secno">6.3.2</span> <span class="content"><code>reports</code></span></a>
       </ul>
     </ul>
    <li><a href="#algorithms"><span class="secno">7</span> <span class="content">Algorithms</span></a>
     <ul class="toc">
      <li><a href="#algorithms-fetch"><span class="secno">7.1</span> <span class="content">Fetch Interface</span></a>
       <ul class="toc">
        <li><a href="#should-block-request"><span class="secno">7.1.1</span> <span class="content">
    Should <var>request</var> be blocked by Content Security Policy?
  </span></a>
        <li><a href="#should-block-response"><span class="secno">7.1.2</span> <span class="content">
    Should <var>response</var> to <var>request</var> be blocked by Content
    Security Policy?
  </span></a>
       </ul>
      <li><a href="#algorithms-application"><span class="secno">7.2</span> <span class="content">
    Policy Application Algorithms
  </span></a>
       <ul class="toc">
        <li><a href="#apply-to-document"><span class="secno">7.2.1</span> <span class="content">
    Apply policies to a <code>Document</code> created via a <var>response</var>
  </span></a>
        <li><a href="#apply-to-srcdoc-document"><span class="secno">7.2.2</span> <span class="content">
    Apply policies to an <code>IFrame</code> <code>srcdoc</code>
    <code>Document</code>
  </span></a>
        <li><a href="#apply-to-worker"><span class="secno">7.2.3</span> <span class="content">
    Apply policies to a <code>Worker</code>
  </span></a>
        <li><a href="#apply-via-meta"><span class="secno">7.2.4</span> <span class="content">
    Apply policies to <var>document</var> via <code>&lt;meta></code>
  </span></a>
        <li><a href="#apply-to-global-object"><span class="secno">7.2.5</span> <span class="content">
    Apply <var>policy</var> to <var>global object</var>
  </span></a>
        <li><a href="#apply-policy-from-headers"><span class="secno">7.2.6</span> <span class="content">
    Apply policies from <var>header list</var> to <var>environment settings
    object</var>
  </span></a>
       </ul>
      <li><a href="#algorithms-parsing"><span class="secno">7.3</span> <span class="content">Parsing Algorithms</span></a>
       <ul class="toc">
        <li><a href="#parse-policy-string"><span class="secno">7.3.1</span> <span class="content">
    Parse <var>string</var> as a Content Security Policy
  </span></a>
        <li><a href="#parse-source-list"><span class="secno">7.3.2</span> <span class="content">
    Parse <var>string</var> as a source list
  </span></a>
       </ul>
      <li><a href="#algorithms-matching"><span class="secno">7.4</span> <span class="content">Matching Algorithms</span></a>
       <ul class="toc">
        <li><a href="#match-request-to-directive-list"><span class="secno">7.4.1</span> <span class="content">
    Does <var>request</var> match <var>directive list</var>?
  </span></a>
        <li><a href="#match-url-to-source-list"><span class="secno">7.4.2</span> <span class="content">
    Does <var>url</var> match <var>source list</var>?
  </span></a>
        <li><a href="#match-url-to-source-expression"><span class="secno">7.4.3</span> <span class="content">
    Does <var>url</var> match <var>source expression</var>?
  </span></a>
        <li><a href="#match-node-to-directive-list"><span class="secno">7.4.4</span> <span class="content">
    Does <var>node</var> match <var>directive list</var>?
  </span></a>
        <li><a href="#match-node-to-source-list"><span class="secno">7.4.5</span> <span class="content">
    Does <var>node</var> match <var>source list</var>?
  </span></a>
        <li><a href="#match-node-to-source-expression"><span class="secno">7.4.6</span> <span class="content">
    Does <var>node</var> match <var>source expression</var>?
  </span></a>
       </ul>
      <li><a href="#internal-helpers"><span class="secno">7.5</span> <span class="content">Internal Helpers</span></a>
       <ul class="toc">
        <li><a href="#get-policies"><span class="secno">7.5.1</span> <span class="content">
    Gather policies for <var>environment settings object</var> and
    <var>disposition</var>
  </span></a>
        <li><a href="#get-effective-directive"><span class="secno">7.5.2</span> <span class="content">
    Get the effective directive for <var>Request</var> from <var>policy</var>
  </span></a>
       </ul>
     </ul>
    <li><a href="#security-considerations"><span class="secno">8</span> <span class="content">Security Considerations</span></a>
     <ul class="toc">
      <li><a href="#security-nonces"><span class="secno">8.1</span> <span class="content">Nonce Reuse</span></a>
     </ul>
    <li><a href="#authoring-considerations"><span class="secno">9</span> <span class="content">Authoring Considerations</span></a>
     <ul class="toc">
      <li><a href="#multiple-policies"><span class="secno">9.1</span> <span class="content">
    The effect of multiple policies
  </span></a>
     </ul>
    <li><a href="#iana-considerations"><span class="secno">10</span> <span class="content">IANA Considerations</span></a>
     <ul class="toc">
      <li><a href="#iana-csp"><span class="secno">10.1</span> <span class="content">
    Content-Security-Policy
  </span></a>
     </ul>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">Acknowledgements</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ul class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
      <li><a href="#conformance-classes"><span class="secno"></span> <span class="content">Conformance Classes</span></a>
     </ul>
    <li><a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ul>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul></div>

  <main>






   <section>
  
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>


    <p><em>This section is not normative.</em></p>


    <p>[INTRODUCTION GOES HERE]</p>

  
    <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>

  
    <h4 class="heading settled" data-level="1.1.1" id="example-basic"><span class="secno">1.1.1. </span><span class="content">Control Execution</span><a class="self-link" href="#example-basic"></a></h4>

  
    <div class="example" id="example-c13fe0ef"><a class="self-link" href="#example-c13fe0ef"></a>
    The developers at <code>https://example.com</code> want to protect
    themselves against cross-site scripting attacks. They can mitigate the
    risk of script injection by ensuring that their trusted CDN is the only
    origin from which script can load and execute. Moreover, they wish to
    ensure that no plugins can execute in their pages' contexts. The
    following policy has that effect:

    
     <pre>Content-Security-Policy: script-src https://cdn.example.com/scripts/; object-src 'none'
</pre>
     
  
    </div>

  
    <h3 class="heading settled" data-level="1.2" id="goals"><span class="secno">1.2. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>


    <p>Content Security Policy aims to do to a few related things:</p>


    <ol>
     <li data-md="">
      <p>Mitigate the risk of content-injection attacks by giving developers
  fairly granular control over</p>
      


      <ul>
       <li data-md="">
        <p>The resources which can be requested (and subsequently embedded or
  executed) on behalf of a specific <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> or <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/workers/#worker">Worker</a></code></p>
        


       <li data-md="">
        <p>The execution of inline script</p>
        


       <li data-md="">
        <p>Dynamic code execution (via <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-eval-x">eval()</a></code> and similar constructs)</p>
        


       <li data-md="">
        <p>The application of inline style</p>
        
</ul>
      

     <li data-md="">
      <p>Mitigate the risk of attacks which require a resource to be embedded
  in a malicious context ("Pixel Perfect", etc) by giving developers
  granular control over the origins which can embed a given resource.</p>
      


     <li data-md="">
      <p>Provide a policy framework which allows developers to tweak
  security-relevant settings.</p>
      


     <li data-md="">
      <p>Provide a reporting mechanism which allows developers to detect flaws
  being exploited in the wild.</p>
      
</ol>
  
    <h3 class="heading settled" data-level="1.3" id="changes-from-level-2"><span class="secno">1.3. </span><span class="content">Changes from Level 2</span><a class="self-link" href="#changes-from-level-2"></a></h3>


    <p>This document describes an evolution of the
  <a href="http://www.w3.org/TR/CSP2/">Content Security Policy Level 2
  specification</a>. The following is a high-level overview of the changes:</p>


    <ol>
     <li data-md="">
      <p>The specification has been rewritten from the ground up in terms of the
  <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> specification, which should make it simpler to integrate CSP’s
  requirements and restrictions with other specifications (and with
  Service Workers in particular).</p>
      


     <li data-md="">
      <p>The <code>frame-src</code> directive, which was deprecated in CSP Level
  2, has been removed.</p>
      
</ol></section>



   <section>
  
    <h2 class="heading settled" data-level="2" id="framework"><span class="secno">2. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>


    <p>A <dfn data-dfn-type="dfn" data-local-lt="policies" data-noexport="" id="policy">policy<a class="self-link" href="#policy"></a></dfn> defines a set of allowed and
  restricted behaviors, and has the following attributes:</p>


    <dl>
     <dt data-md="">
      <p><dfn data-dfn-for="policy" data-dfn-type="dfn" data-noexport="" id="directive-list">directive list<a class="self-link" href="#directive-list"></a></dfn></p>
      

     <dd data-md="">
      <p>A set of <a data-link-type="dfn" href="#directive">directives</a> that define the behaviors the policy
  allows and restricts. Unless otherwise stated, its value is the empty set.</p>
      

     <dt data-md="">
      <p><dfn data-dfn-for="policy" data-dfn-type="dfn" data-noexport="" id="type">type<a class="self-link" href="#type"></a></dfn></p>
      

     <dd data-md="">
      <p>Either "<code>enforce</code>", meaning that policy violation are actively
  prevented, or "<code>report-only</code>", meaning that policy violations
  are passively reported and allowed to proceed. Unless otherwise stated,
  its value is "<code>enforce</code>".</p>
      
</dl>

    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="directive">directive<a class="self-link" href="#directive"></a></dfn> defines a specific behavior, and has the following
  properties:</p>


    <dl>
     <dt data-md="">
      <p><dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="name">name<a class="self-link" href="#name"></a></dfn></p>
      

     <dd data-md="">
      <p>One of "<code>base-uri</code>", "<code>child-src</code>",
  "<code>connect-src</code>", "<code>default-src</code>",
  "<code>font-src</code>", "<code>form-action</code>",
  "<code>frame-ancestors</code>", "<code>img-src</code>",
  "<code>media-src</code>", "<code>object-src</code>",
  "<code>plugin-types</code>", "<code>report-uri</code>",
  "<code>reports</code>", "<code>sandbox</code>",
  "<code>script-src</code>", "<code>style-src</code>".
  The behaviors associated with each possible value are described in
  <a href="#csp-directives">§6 Content Security Policy Directives</a>.</p>
      

     <dt data-md="">
      <p><dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="value">value<a class="self-link" href="#value"></a></dfn></p>
      

     <dd data-md="">
      <p>A string. Unless otherwise stated, its value is the empty string. Parsing
  rules for <a data-link-type="dfn" href="#directive">directive</a>’s values are described in <a href="#csp-directives">§6 Content Security Policy Directives</a>.</p>
      
</dl>

    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="source-list-directive">source list directive<a class="self-link" href="#source-list-directive"></a></dfn> is a specific type of <a data-link-type="dfn" href="#directive">directive</a>
  whose value is a space-separated list of source expressions.</p>
</section>



   <section>
  
    <h2 class="heading settled" data-level="3" id="policy-delivery"><span class="secno">3. </span><span class="content">
    Policy Delivery
  </span><a class="self-link" href="#policy-delivery"></a></h2>


    <p>This document defines four delivery mechanisms for a resource’s policy:</p>


    <ol>
     <li data-md="">
      <p>An HTTP response header (defined in <a href="#csp-header">§3.1.1 The Content-Security-Policy HTTP Response Header Field</a> and <a href="#cspro-header">§3.1.2 The Content-Security-Policy-Report-Only HTTP Response Header Field</a>)
  which declares a policy as a string and applies it to the resource which
  which the header is delivered. The policy syntax is defined in
  <a href="#syntax">§4 Policy Syntax</a>.</p>
      


     <li data-md="">
      <p>A <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element (defined in <a href="#meta-element">§3.1.3 The &lt;meta> element</a>), which declares a policy
  as a string and applies it to the resource in which the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element
  is embedded. The policy syntax is defined in <a href="#syntax">§4 Policy Syntax</a>.</p>
      


     <li data-md="">
      <p>Inheritance, which applies a policy to a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing context</a>
  in certain circumstances, as defined in <a href="#delivery-implicit">§3.2 Implicit Delivery</a>.</p>
      


     <li data-md="">
      <p>A JavaScript interface (defined in <a href="#javascript-interface">§3.3 Imperative Delivery</a>).</p>
      

</ol>
  
    <h3 class="heading settled" data-level="3.1" id="delivery-declarative"><span class="secno">3.1. </span><span class="content">
    Declarative Delivery
  </span><a class="self-link" href="#delivery-declarative"></a></h3>

  
    <h4 class="heading settled" data-level="3.1.1" id="csp-header"><span class="secno">3.1.1. </span><span class="content">
    The <code>Content-Security-Policy</code> HTTP Response Header Field
  </span><a class="self-link" href="#csp-header"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="content_security_policy"><code>Content-Security-Policy</code><a class="self-link" href="#content_security_policy"></a></dfn> HTTP response header field
  is the preferred mechanism for delivering a policy from a server to a client.
  The header’s value is represented by the following ABNF <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>

  
    <pre>Content-Security-Policy = 1#<a data-link-type="grammar" href="#grammardef-policy-token">policy-token</a>
</pre>

  
    <div class="example" id="example-731af1ba"><a class="self-link" href="#example-731af1ba"></a>
    
     <pre><a data-link-type="dfn" href="#content_security_policy">Content-Security-Policy</a>: script-src 'self';
                         reports /csp-reporting-endpoint
</pre>
     
  
    </div>


    <p>A server MAY send different <code>Content-Security-Policy</code> header field
  values with different <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">representations</a> of the same resource.</p>


    <p>A server SHOULD NOT send more than one HTTP response header field named
  "<code>Content-Security-Policy</code>" with a given <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">resource
  representation</a>. The user agent MUST <a data-link-type="dfn" href="#enforced">enforce</a> each of the policies
  contained in each such header field as described in
  <a href="#algorithms-application">§7.2 Policy Application Algorithms</a>.</p>

  
    <h4 class="heading settled" data-level="3.1.2" id="cspro-header"><span class="secno">3.1.2. </span><span class="content">
    The <code>Content-Security-Policy-Report-Only</code> HTTP Response Header Field
  </span><a class="self-link" href="#cspro-header"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="content_security_policy_report_only"><code>Content-Security-Policy-Report-Only</code><a class="self-link" href="#content_security_policy_report_only"></a></dfn> HTTP response
  header field allows web developers to experiment with policies by monitoring
  (but not enforcing) their effects. The header’s value is represented by the
  following ABNF <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>

  
    <pre>Content-Security-Policy-Report-Only = 1#<a data-link-type="grammar" href="#grammardef-policy-token">policy-token</a>
</pre>


    <p>This header field allows developers to piece together their security policy in
  an iterative fashion, deploying a report-only policy based on their best
  estimate of how their site behaves, watching for violation reports, and then
  moving to an enforced policy once they’ve gained confidence in that behavior.</p>

  
    <div class="example" id="example-89c50ad6"><a class="self-link" href="#example-89c50ad6"></a>
    
     <pre><a data-link-type="dfn" href="#content_security_policy_report_only">Content-Security-Policy-Report-Only</a>: script-src 'self';
                                     reports /csp-reporting-endpoint
</pre>
     
  
    </div>


    <p>A server MAY send different <code>Content-Security-Policy-Report-Only</code>
  header field values with different <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">representations</a> of the same
  resource.</p>


    <p>A server SHOULD NOT send more than one HTTP response header field named
  "<code>Content-Security-Policy-Report-Only</code>" with a given <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">resource
  representation</a>. The user agent MUST <a data-link-type="dfn" href="#monitored">monitor</a> each of the policies
  contained in each such header field as described in
  <a href="#algorithms-application">§7.2 Policy Application Algorithms</a>.</p>


    <p class="note" role="note">Note: The <code><a data-link-type="dfn" href="#content_security_policy_report_only">Content-Security-Policy-Report-Only</a></code> header is
  <strong>not</strong> supported inside a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element.</p>

  
    <h4 class="heading settled" data-level="3.1.3" id="meta-element"><span class="secno">3.1.3. </span><span class="content">
    The <code>&lt;meta></code> element
  </span><a class="self-link" href="#meta-element"></a></h4>


    <p>A <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> may deliver a policy via one or more HTML <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> elements
  whose <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a></code> attributes are an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive
  match</a> for the string "<code>Content-Security-Policy</code>". For example:</p>

  
    <div class="example" id="example-cff5e786"><a class="self-link" href="#example-cff5e786"></a>
    
     <pre>&lt;meta http-equiv="Content-Security-Policy" content="script-src 'self'">
</pre>
     
  
    </div>


    <p>Implementation details can be found in <a href="#apply-via-meta">§7.2.4 Apply policies to document via &lt;meta></a>.</p>


    <p>Authors are <em>strongly encouraged</em> to place <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> elements as early
  in the document as possible, because policies in <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> elements are not
  applied to content which precedes them. In particular, note that resources
  fetched or prefetched using the <code>Link</code> HTTP response header
  field, and resources fetched or prefetched using <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element">link</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code>
  elements which precede a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code>-delivered policy will not be blocked.</p>


    <p class="note" role="note">Note: A policy specified via a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element will be enforced along with
  any other policies active for the protected resource, regardless
  of where they’re specified. The general impact of enforcing multiple
  policies is described in <a href="#multiple-policies">§9.1 The effect of multiple policies</a>.</p>


    <p class="note" role="note">Note: Modifications to the <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content">content</a></code> attribute of a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element
  after the element has been parsed will be ignored.</p>


    <p class="note" role="note">Note: The <code><a data-link-type="dfn" href="#content_security_policy_report_only">Content-Security-Policy-Report-Only</a></code>
  header is <em>not</em> supported inside a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element.</p>

  
    <h3 class="heading settled" data-level="3.2" id="delivery-implicit"><span class="secno">3.2. </span><span class="content">
    Implicit Delivery 
  </span><a class="self-link" href="#delivery-implicit"></a></h3>


    <p>Resources with <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local schemes</a> (e.g. <code>about</code>,
  <code>blob:</code>, <code>data:</code>, and <code>filesystem:</code>), as well
  as resouces embedded via <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a></code>'s <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-srcdoc">srcdoc</a></code> attribute, are
  considered same-origin with the origin that created them, but have no
  mechanism for header-based policy delivery. To ensure that this property
  doesn’t allow a trivial bypass of a page’s policy (by creating a
  <code>blob:</code> and embedding it in an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a></code>, for instance), these
  kinds of resources inherit the policy of their embedding context, as described
  in <a href="#apply-to-document">§7.2.1 Apply policies to a Document created via a response</a>, <a href="#apply-to-worker">§7.2.3 Apply policies to a Worker</a>, and
  <a href="#apply-to-srcdoc-document">§7.2.2 Apply policies to an IFrame srcdoc
    Document</a>.</p>


    <p class="issue" id="issue-e8e29878"><a class="self-link" href="#issue-e8e29878"></a> We should consider extending this to include
  auxiliary browsing contexts, not just nested browsing contexts. <a href="https://github.com/w3c/webappsec/issues/451">&lt;https://github.com/w3c/webappsec/issues/451></a></p>

  
    <h3 class="heading settled" data-level="3.3" id="javascript-interface"><span class="secno">3.3. </span><span class="content">
    Imperative Delivery
  </span><a class="self-link" href="#javascript-interface"></a></h3>


    <p>Developers may manipulate a page’s policy via a JavaScript API which allows
  construction of <code class="idl"><a data-link-type="idl" href="#securitypolicy">SecurityPolicy</a></code> objects, and the application of those
  objects to an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a>.</p>

  
    <h4 class="heading settled" data-level="3.3.1" id="javascript-application"><span class="secno">3.3.1. </span><span class="content">
    Applying a Policy
  </span><a class="self-link" href="#javascript-application"></a></h4>


    <p>A <code class="idl"><a data-link-type="idl" href="#securitypolicy">SecurityPolicy</a></code> can be applied to an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a>
  via the following interfaces:</p>

  
    <pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/browsers.html#window">Window</a> {
  void <a class="idl-code" data-link-type="method" href="#dom-window-applysecuritypolicy">applySecurityPolicy</a>(<a data-link-type="idl-name" href="#securitypolicy">SecurityPolicy</a> <dfn class="idl-code" data-dfn-for="Window/applySecurityPolicy(policy)" data-dfn-type="argument" data-export="" id="dom-window-applysecuritypolicy-policy-policy">policy<a class="self-link" href="#dom-window-applysecuritypolicy-policy-policy"></a></dfn>);
};
</pre>
  
    <dl>
    
     <dt><dfn class="idl-code" data-dfn-for="Window" data-dfn-type="method" data-export="" id="dom-window-applysecuritypolicy">applySecurityPolicy(policy)<a class="self-link" href="#dom-window-applysecuritypolicy"></a></dfn>
     
    
     <dd>
      To execute this method, execute <a href="#apply-to-global-object">§7.2.5 Apply policy to global object</a> on
      <var>policy</var>’s associated <a data-link-type="dfn" href="#policy">policy</a> and the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/browsers.html#window">Window</a></code> object.
    
     
  
    </dl>

  
    <pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a> {
  void <a class="idl-code" data-link-type="method" href="#dom-workerglobalscope-applysecuritypolicy">applySecurityPolicy</a>(<a data-link-type="idl-name" href="#securitypolicy">SecurityPolicy</a> <dfn class="idl-code" data-dfn-for="WorkerGlobalScope/applySecurityPolicy(policy)" data-dfn-type="argument" data-export="" id="dom-workerglobalscope-applysecuritypolicy-policy-policy">policy<a class="self-link" href="#dom-workerglobalscope-applysecuritypolicy-policy-policy"></a></dfn>);
};
</pre>
  
    <dl>
    
     <dt><dfn class="idl-code" data-dfn-for="WorkerGlobalScope" data-dfn-type="method" data-export="" id="dom-workerglobalscope-applysecuritypolicy">applySecurityPolicy(policy)<a class="self-link" href="#dom-workerglobalscope-applysecuritypolicy"></a></dfn>
     
    
     <dd>
      To execute this method, execute <a href="#apply-to-global-object">§7.2.5 Apply policy to global object</a> on
      <var>policy</var>’s associated <a data-link-type="dfn" href="#policy">policy</a> and the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a></code>
      object.
    
     
  
    </dl>

  
    <div class="example" id="example-22bd7aea"><a class="self-link" href="#example-22bd7aea"></a>
    To apply the policy <code>script-src 'self'; object-src 'none'</code> from
    JavaScript inside a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/workers/#worker">Worker</a></code> or <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code>, execute the following code:

    
     <pre>var policy = new SecurityPolicy("script-src 'self'; object-src 'none'");
self.applySecurityPolicy(policy);
</pre>
     
  
    </div>


    <p class="issue" id="issue-2167e343"><a class="self-link" href="#issue-2167e343"></a> Maybe this makes more sense as `window.csp.apply()`? Which would also
  allow `window.csp.enforced` and `window.csp.monitored` as sequences of
  <code class="idl"><a data-link-type="idl" href="#securitypolicy">SecurityPolicy</a></code> objects?</p>

  
    <h4 class="heading settled" data-level="3.3.2" id="idl-securitypolicy"><span class="secno">3.3.2. </span><span class="content">
    <code>SecurityPolicy</code> Interface
  </span><a class="self-link" href="#idl-securitypolicy"></a></h4>


    <p>A policy object is defined via the following IDL:</p>

  
    <pre class="idl">enum <dfn class="idl-code" data-dfn-type="enum" data-export="" id="enumdef-securitypolicytype">SecurityPolicyType<a class="self-link" href="#enumdef-securitypolicytype"></a></dfn> {
  "enforce",
  "report-only"
};

[<a class="idl-code" data-link-type="constructor" href="#dom-securitypolicy-securitypolicy">Constructor</a>(DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicy/SecurityPolicy(policy, type)" data-dfn-type="argument" data-export="" id="dom-securitypolicy-securitypolicy-policy-type-policy">policy<a class="self-link" href="#dom-securitypolicy-securitypolicy-policy-type-policy"></a></dfn>, <a data-link-type="idl-name" href="#enumdef-securitypolicytype">SecurityPolicyType</a> <dfn class="idl-code" data-dfn-for="SecurityPolicy/SecurityPolicy(policy, type)" data-dfn-type="argument" data-export="" id="dom-securitypolicy-securitypolicy-policy-type-type">type<a class="self-link" href="#dom-securitypolicy-securitypolicy-policy-type-type"></a></dfn>), Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="securitypolicy">SecurityPolicy<a class="self-link" href="#securitypolicy"></a></dfn> {
  boolean <a class="idl-code" data-link-type="method" href="#dom-securitypolicy-requestmatches">requestMatches</a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request">Request</a> <dfn class="idl-code" data-dfn-for="SecurityPolicy/requestMatches(request)" data-dfn-type="argument" data-export="" id="dom-securitypolicy-requestmatches-request-request">request<a class="self-link" href="#dom-securitypolicy-requestmatches-request-request"></a></dfn>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-securitypolicy-nodematches">nodeMatches</a>(<a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#interface-node">Node</a> <dfn class="idl-code" data-dfn-for="SecurityPolicy/nodeMatches(node)" data-dfn-type="argument" data-export="" id="dom-securitypolicy-nodematches-node-node">node<a class="self-link" href="#dom-securitypolicy-nodematches-node-node"></a></dfn>);
  
  readonly attribute FrozenArray&lt;<a data-link-type="idl-name" href="#securitypolicydirective">SecurityPolicyDirective</a>> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="FrozenArray<SecurityPolicyDirective> " href="#dom-securitypolicy-directives">directives</a>;
  readonly attribute <a data-link-type="idl-name" href="#enumdef-securitypolicytype">SecurityPolicyType</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="SecurityPolicyType " href="#dom-securitypolicy-type">type</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-securitypolicy-reportingendpoint">reportingEndpoint</a>;
};
</pre>


    <p>A <code class="idl"><a data-link-type="idl" href="#securitypolicy">SecurityPolicy</a></code> object has an internal slot named
  <dfn class="idl-code" data-dfn-for="SecurityPolicy" data-dfn-type="attribute" data-export="" id="dom-securitypolicy-policy-slot">[[policy]]<a class="self-link" href="#dom-securitypolicy-policy-slot"></a></dfn>, which contains a
  <a data-link-type="dfn" href="#policy">policy</a>. Unless otherwise stated, its value is <code>null</code>.</p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicy" data-dfn-type="attribute" data-export="" id="dom-securitypolicy-directives">directives<a class="self-link" href="#dom-securitypolicy-directives"></a></dfn> attribute’s getter
  returns a list of <code class="idl"><a data-link-type="idl" href="#securitypolicydirective">SecurityPolicyDirective</a></code>s corresponding to
  <code class="idl"><a data-link-type="idl" href="#dom-securitypolicy-policy-slot">[[policy]]</a></code>'s <a data-link-type="dfn" href="#directive-list">directive list</a></p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicy" data-dfn-type="attribute" data-export="" id="dom-securitypolicy-type">type<a class="self-link" href="#dom-securitypolicy-type"></a></dfn> attribute’s getter
  returns the value of <code class="idl"><a data-link-type="idl" href="#dom-securitypolicy-policy-slot">[[policy]]</a></code>'s <a data-link-type="dfn" href="#type">type</a>.</p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicy" data-dfn-type="attribute" data-export="" id="dom-securitypolicy-reportingendpoint">reportingEndpoint<a class="self-link" href="#dom-securitypolicy-reportingendpoint"></a></dfn> attribute’s
  getter returns the serialization of the <a data-link-type="dfn" href="#value">value</a> of
  the <a data-link-type="dfn" href="#directive">directive</a> in <code class="idl"><a data-link-type="idl" href="#dom-securitypolicy-policy-slot">[[policy]]</a></code>'s
  <a data-link-type="dfn" href="#directive-list">directive list</a> with a <a data-link-type="dfn" href="#name">name</a> of
  "<code>report-uri</code>", if present. If no such directive is present, the
  empty string is returned.</p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicy" data-dfn-type="constructor" data-export="" id="dom-securitypolicy-securitypolicy">SecurityPolicy(policy, type)<a class="self-link" href="#dom-securitypolicy-securitypolicy"></a></dfn>
  constructor, when invoked, MUST execute the following steps:</p>


    <ol>
     <li data-md="">
      <p>Let <var>policy list</var> be the result of executing
  <a href="#parse-policy-string">§7.3.1 Parse string as a Content Security Policy</a> on <var>policy</var>.</p>
      


     <li data-md="">
      <p>If <var>policy list</var> does not have exactly one element, throw a
  <code>SyntaxError</code> exception, and abort the remaining steps.</p>
      


     <li data-md="">
      <p>Set <code>this@</code><code class="idl"><a data-link-type="idl" href="#dom-securitypolicy-policy-slot">[[policy]]</a></code> to the only element
  in <var>policy list</var>.</p>
      


     <li data-md="">
      <p>Return <code>this</code>.</p>
      
</ol>

    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicy" data-dfn-type="method" data-export="" id="dom-securitypolicy-requestmatches">requestMatches(request)<a class="self-link" href="#dom-securitypolicy-requestmatches"></a></dfn> method
  returns <code>true</code> if <a href="#match-request-to-directive-list">§7.4.1 Does request match directive list?</a> returns
  <code>Matches</code> when executed upon <var>request</var> and
  <code class="idl"><a data-link-type="idl" href="#dom-securitypolicy-policy-slot">[[policy]]</a></code>'s <a data-link-type="dfn" href="#directive-list">directive list</a>, and
  <code>false</code> otherwise.</p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicy" data-dfn-type="method" data-export="" id="dom-securitypolicy-nodematches">nodeMatches(node)<a class="self-link" href="#dom-securitypolicy-nodematches"></a></dfn> method returns
  <code>true</code> if <a href="#match-node-to-directive-list">§7.4.4 Does node match directive list?</a> returns
  <code>Matches</code> when executed upon <var>node</var> and
  <code class="idl"><a data-link-type="idl" href="#dom-securitypolicy-policy-slot">[[policy]]</a></code>'s <a data-link-type="dfn" href="#directive-list">directive list</a>, and
  <code>false</code> otherwise.</p>

  
    <h4 class="heading settled" data-level="3.3.3" id="idl-securitypolicydirective"><span class="secno">3.3.3. </span><span class="content">
    <code>SecurityPolicyDirective</code> Interface
  </span><a class="self-link" href="#idl-securitypolicydirective"></a></h4>


    <p>Policy objects contain a list of directives, each defined according to the
  following IDL:</p>

  
    <pre class="idl">enum <dfn class="idl-code" data-dfn-type="enum" data-export="" id="enumdef-directivename">DirectiveName<a class="self-link" href="#enumdef-directivename"></a></dfn> {
  "base-uri",
  "child-src",
  "connect-src",
  "default-src",
  "font-src",
  "form-action",
  "frame-ancestors",
  "img-src",
  "media-src",
  "object-src",
  "plugin-types",
  "report-uri",
  "reports",
  "sandbox",
  "script-src",
  "style-src"
};

[<a class="idl-code" data-link-type="constructor" href="#dom-securitypolicydirective-securitypolicydirective">Constructor</a>(DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective/SecurityPolicyDirective(name, value)" data-dfn-type="argument" data-export="" id="dom-securitypolicydirective-securitypolicydirective-name-value-name">name<a class="self-link" href="#dom-securitypolicydirective-securitypolicydirective-name-value-name"></a></dfn>, DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective/SecurityPolicyDirective(name, value)" data-dfn-type="argument" data-export="" id="dom-securitypolicydirective-securitypolicydirective-name-value-value">value<a class="self-link" href="#dom-securitypolicydirective-securitypolicydirective-name-value-value"></a></dfn>), Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="securitypolicydirective">SecurityPolicyDirective<a class="self-link" href="#securitypolicydirective"></a></dfn> {
  boolean <a class="idl-code" data-link-type="method" href="#dom-securitypolicydirective-requestmatches">requestMatches</a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request">Request</a> <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective/requestMatches(request)" data-dfn-type="argument" data-export="" id="dom-securitypolicydirective-requestmatches-request-request">request<a class="self-link" href="#dom-securitypolicydirective-requestmatches-request-request"></a></dfn>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-securitypolicydirective-nodematches">nodeMatches</a>(<a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#interface-node">Node</a> <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective/nodeMatches(node)" data-dfn-type="argument" data-export="" id="dom-securitypolicydirective-nodematches-node-node">node<a class="self-link" href="#dom-securitypolicydirective-nodematches-node-node"></a></dfn>);

  readonly attribute <a data-link-type="idl-name" href="#enumdef-directivename">DirectiveName</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DirectiveName " href="#dom-securitypolicydirective-name">name</a>;  
};
</pre>


    <p>A <code class="idl"><a data-link-type="idl" href="#securitypolicydirective">SecurityPolicyDirective</a></code> object has an internal slot named
  <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective" data-dfn-type="attribute" data-export="" id="dom-securitypolicydirective-directive-slot">[[directive]]<a class="self-link" href="#dom-securitypolicydirective-directive-slot"></a></dfn>, which
  contains a <a data-link-type="dfn" href="#directive">directive</a>. Unless otherwise specified, its value is
  <code>null</code>.</p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective" data-dfn-type="attribute" data-export="" id="dom-securitypolicydirective-name">name<a class="self-link" href="#dom-securitypolicydirective-name"></a></dfn> attribute’s
  getter returns <code class="idl"><a data-link-type="idl" href="#dom-securitypolicydirective-directive-slot">[[directive]]</a></code>'s
  <a data-link-type="dfn" href="#name">name</a>.</p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective" data-dfn-type="attribute" data-export="" id="dom-securitypolicydirective-value">value<a class="self-link" href="#dom-securitypolicydirective-value"></a></dfn> attribute’s
  getter returns <code class="idl"><a data-link-type="idl" href="#dom-securitypolicydirective-directive-slot">[[directive]]</a></code>'s
  <a data-link-type="dfn" href="#value">value</a>.</p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective" data-dfn-type="constructor" data-export="" id="dom-securitypolicydirective-securitypolicydirective">SecurityPolicyDirective(name, value)<a class="self-link" href="#dom-securitypolicydirective-securitypolicydirective"></a></dfn>
  constructor, when invoked, MUST execute the following steps:</p>


    <ol>
     <li data-md="">
      <p>If <var>name</var> is not a valid <code class="idl"><a data-link-type="idl" href="#enumdef-directivename">DirectiveName</a></code>, throw a
  <code>SyntaxError</code> exception, and abort the remaining steps.</p>
      


     <li data-md="">
      <p>Let <var>directive</var> be a new <a data-link-type="dfn" href="#directive">directive</a> with a
  <a data-link-type="dfn" href="#name">name</a> of <var>name</var> and a
  <a data-link-type="dfn" href="#value">value</a> of <var>value</var>.</p>
      


     <li data-md="">
      <p>Set <code>this@</code><code class="idl"><a data-link-type="idl" href="#dom-securitypolicydirective-directive-slot">[[directive]]</a></code> to
  <var>directive</var>.</p>
      


     <li data-md="">
      <p>Return <code>this</code>.</p>
      
</ol>

    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective" data-dfn-type="method" data-export="" id="dom-securitypolicydirective-requestmatches">requestMatches(request)<a class="self-link" href="#dom-securitypolicydirective-requestmatches"></a></dfn>
  method returns <code>true</code>.</p>


    <p>The <dfn class="idl-code" data-dfn-for="SecurityPolicyDirective" data-dfn-type="method" data-export="" id="dom-securitypolicydirective-nodematches">nodeMatches(node)<a class="self-link" href="#dom-securitypolicydirective-nodematches"></a></dfn> method
  returns <code>true</code>.</p>


    <p class="note" role="note">Note: Directives which operate on either <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request">Request</a></code>s or <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-node">Node</a></code>s are
  expected to inherit from <code class="idl"><a data-link-type="idl" href="#securitypolicydirective">SecurityPolicyDirective</a></code> and override these
  method implementations. <code class="idl"><a data-link-type="idl" href="#sourcelistdirective">SourceListDirective</a></code> is one example of this.</p>

  
    <h4 class="heading settled" data-level="3.3.4" id="idl-sourcelistdirective"><span class="secno">3.3.4. </span><span class="content">
    <code>SourceListDirective</code> Interface
  </span><a class="self-link" href="#idl-sourcelistdirective"></a></h4>


    <p>Directives whose values are <a data-link-type="dfn" href="#source-list">source lists</a> are parsed into
  <code class="idl"><a data-link-type="idl" href="#sourcelistdirective">SourceListDirective</a></code> objects (which subclass <code class="idl"><a data-link-type="idl" href="#securitypolicydirective">SecurityPolicyDirective</a></code>).
  These are defined according to the following IDL:</p>

  
    <pre class="idl">[<a class="idl-code" data-link-type="constructor" href="#dom-sourcelistdirective-sourcelistdirective">Constructor</a>(DOMString <dfn class="idl-code" data-dfn-for="SourceListDirective/SourceListDirective(name, value)" data-dfn-type="argument" data-export="" id="dom-sourcelistdirective-sourcelistdirective-name-value-name">name<a class="self-link" href="#dom-sourcelistdirective-sourcelistdirective-name-value-name"></a></dfn>, DOMString <dfn class="idl-code" data-dfn-for="SourceListDirective/SourceListDirective(name, value)" data-dfn-type="argument" data-export="" id="dom-sourcelistdirective-sourcelistdirective-name-value-value">value<a class="self-link" href="#dom-sourcelistdirective-sourcelistdirective-name-value-value"></a></dfn>), Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="sourcelistdirective">SourceListDirective<a class="self-link" href="#sourcelistdirective"></a></dfn> : <a data-link-type="idl-name" href="#securitypolicydirective">SecurityPolicyDirective</a> {
  readonly attribute FrozenArray&lt;<a data-link-type="idl-name" href="#sourceexpression">SourceExpression</a>> <dfn class="idl-code" data-dfn-for="SourceListDirective" data-dfn-type="attribute" data-export="" data-readonly="" data-type="FrozenArray<SourceExpression> " id="dom-sourcelistdirective-sources">sources<a class="self-link" href="#dom-sourcelistdirective-sources"></a></dfn>;
};
</pre>


    <p>The <dfn class="idl-code" data-dfn-for="SourceListDirective" data-dfn-type="constructor" data-export="" id="dom-sourcelistdirective-sourcelistdirective">SourceListDirective(name, value)<a class="self-link" href="#dom-sourcelistdirective-sourcelistdirective"></a></dfn>
  constructor, when invoked, MUST execute the following steps:</p>


    <ol>
     <li data-md="">
      <p>If <var>name</var> is not a valid <code class="idl"><a data-link-type="idl" href="#enumdef-directivename">DirectiveName</a></code>, throw a
  <code>SyntaxError</code> exception, and abort the remaining steps.</p>
      


     <li data-md="">
      <p>Let <var>directive</var> be a new <a data-link-type="dfn" href="#directive">directive</a> with a
  <a data-link-type="dfn" href="#name">name</a> of <var>name</var> and a
  <a data-link-type="dfn" href="#value">value</a> of <var>value</var>.</p>
      


     <li data-md="">
      <p>Set <code>this@</code><code class="idl"><a data-link-type="idl" href="#dom-securitypolicydirective-directive-slot">[[directive]]</a></code> to
  <var>directive</var>.</p>
      


     <li data-md="">
      <p><code>this@</code>Set <code class="idl"><a data-link-type="idl" href="#dom-sourcelistdirective-sources">sources</a></code> to the result of
  executing <a href="#parse-source-list">§7.3.2 Parse string as a source list</a> on <var>value</var>.</p>
      


     <li data-md="">
      <p>Return <code>this</code>.</p>
      
</ol>

    <p>The <dfn class="idl-code" data-dfn-for="SourceListDirective" data-dfn-type="method" data-export="" id="dom-sourcelistdirective-requestmatches">requestMatches(request)<a class="self-link" href="#dom-sourcelistdirective-requestmatches"></a></dfn>
  method, when invoked, MUST execute the following steps:</p>


    <ol>
     <li data-md="">
      <p>Let <var>url</var> be <var>request</var>’s <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a></code>.</p>
      


     <li data-md="">
      <p>For each <var>expression</var> in this object’s
  <code class="idl"><a data-link-type="idl" href="#dom-sourcelistdirective-sources">sources</a></code> attribute:</p>
      


      <ol>
       <li data-md="">
        <p>If <var>expression</var>’s <code class="idl"><a data-link-type="idl" href="#dom-sourceexpression-urlmatches">urlMatches(url)</a></code>
  returns <code>true</code> when executed upon <var>url</var>, return
  <code>true</code>.</p>
        
</ol>
      

     <li data-md="">
      <p>Return <code>false</code>.</p>
      
</ol>

    <p>The <dfn class="idl-code" data-dfn-for="SourceListDirective" data-dfn-type="method" data-export="" id="dom-sourcelistdirective-nodematches">nodeMatches(node)<a class="self-link" href="#dom-sourcelistdirective-nodematches"></a></dfn> method,
  when invoked, MUST execute the following steps:</p>


    <ol>
     <li data-md="">
      <p>For each <var>expression</var> in this object’s
  <code class="idl"><a data-link-type="idl" href="#dom-sourcelistdirective-sources">sources</a></code> attribute:</p>
      


      <ol>
       <li data-md="">
        <p>If <var>expression</var>’s <code class="idl"><a data-link-type="idl" href="#dom-sourceexpression-nodematches">nodeMatches(node)</a></code>
  returns <code>true</code> when executed upon <var>node</var>,
  return <code>true</code>.</p>
        
</ol>
      

     <li data-md="">
      <p>Return <code>false</code>.</p>
      
</ol>
  
    <h4 class="heading settled" data-level="3.3.5" id="idl-sourceexpression"><span class="secno">3.3.5. </span><span class="content">
    <code>SourceExpression</code> Interface
  </span><a class="self-link" href="#idl-sourceexpression"></a></h4>


    <p><code class="idl"><a data-link-type="idl" href="#sourcelistdirective">SourceListDirective</a></code> objects' <code class="idl"><a data-link-type="idl" href="#dom-sourcelistdirective-sources">sources</a></code> attribute
  contains the list of <a data-link-type="dfn" href="#source-expression">source expressions</a> that make up the directive’s
  value. These are represented as <code class="idl"><a data-link-type="idl" href="#sourceexpression">SourceExpression</a></code> objects according to
  the following IDL:</p>

  
    <pre class="idl">[<dfn class="idl-code" data-dfn-for="SourceExpression" data-dfn-type="constructor" data-export="" data-lt="SourceExpression(value)" id="dom-sourceexpression-sourceexpression">Constructor<a class="self-link" href="#dom-sourceexpression-sourceexpression"></a></dfn>(DOMString <dfn class="idl-code" data-dfn-for="SourceExpression/SourceExpression(value)" data-dfn-type="argument" data-export="" id="dom-sourceexpression-sourceexpression-value-value">value<a class="self-link" href="#dom-sourceexpression-sourceexpression-value-value"></a></dfn>), Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="sourceexpression">SourceExpression<a class="self-link" href="#sourceexpression"></a></dfn> {
  boolean <a class="idl-code" data-link-type="method" href="#dom-sourceexpression-urlmatches">urlMatches</a>(USVString <a class="idl-code" data-link-type="argument" href="#dom-sourceexpression-urlmatches-url-url">url</a>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-sourceexpression-nodematches">nodeMatches</a>(<a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#interface-node">Node</a> <a class="idl-code" data-link-type="argument" href="#dom-sourceexpression-nodematches-node-node">node</a>);

  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-sourceexpression-value">value</a>;
};
</pre>
  
    <dl>
    
     <dt><dfn class="idl-code" data-dfn-for="SourceExpression" data-dfn-type="attribute" data-export="" id="dom-sourceexpression-value">value<a class="self-link" href="#dom-sourceexpression-value"></a></dfn>, <span> of type <a data-link-type="idl-name" href="http://heycam.github.io/webidl/#idl-DOMString">DOMString</a>, readonly</span>
     
    
     <dd>
      The expression’s value. <code>script-src https://example.com/
      'nonce-abcde'</code> will, for example, produce two <code class="idl"><a data-link-type="idl" href="#sourceexpression">SourceExpression</a></code>
      objects, one with a value of "https://example.com/", the other with a
      value of "'nonce-abcde'".
    
     
    
     <dt><dfn class="idl-code" data-dfn-for="SourceExpression" data-dfn-type="method" data-export="" id="dom-sourceexpression-urlmatches">urlMatches(url)<a class="self-link" href="#dom-sourceexpression-urlmatches"></a></dfn>
     
    
     <dd>
      This method returns <code>true</code> if executing
      <a href="#match-url-to-source-expression">§7.4.3 Does url match source expression?</a> on <var>url</var> and the object’s
      <code class="idl"><a data-link-type="idl" href="#dom-sourceexpression-value">value</a></code> attribute returns <code>Matches</code>, and
      <code>false</code> otherwise.


            
      <table class="argumentdef data definition-table">
                
       <thead>
                    
        <tr>
                        
         <th>Parameter
                        
         <th>Type
                        
         <th>Nullable
                        
         <th>Optional
                        
         <th>Description
                
       <tbody>
                
        <tr>
                    
         <td><dfn class="idl-code" data-dfn-for="SourceExpression/urlMatches(url)" data-dfn-type="argument" data-export="" id="dom-sourceexpression-urlmatches-url-url">url<a class="self-link" href="#dom-sourceexpression-urlmatches-url-url"></a></dfn>
                    
         <td>
                    USVString 
         <td>
                    <span class="no">✘</span>
         <td>
                    <span class="no">✘</span>
         <td>The URL to match against the SourceExpression.
                
       <caption>Arguments for the <a class="idl-code" data-link-type="method" href="#dom-sourceexpression-urlmatches">SourceExpression.urlMatches(url)</a> method.</caption>
       
            
      </table>
      
    
     
    
     <dt><dfn class="idl-code" data-dfn-for="SourceExpression" data-dfn-type="method" data-export="" id="dom-sourceexpression-nodematches">nodeMatches(node)<a class="self-link" href="#dom-sourceexpression-nodematches"></a></dfn>
     
    
     <dd>
      This method returns <code>true</code> if executing
      <a href="#match-node-to-source-expression">§7.4.6 Does node match source expression?</a> on <var>node</var> and the object’s
      <code class="idl"><a data-link-type="idl" href="#dom-sourceexpression-value">value</a></code> attribute returns <code>Matches</code>, and
      <code>false</code> otherwise.


            
      <table class="argumentdef data definition-table">
                
       <thead>
                    
        <tr>
                        
         <th>Parameter
                        
         <th>Type
                        
         <th>Nullable
                        
         <th>Optional
                        
         <th>Description
                
       <tbody>
                
        <tr>
                    
         <td><dfn class="idl-code" data-dfn-for="SourceExpression/nodeMatches(node)" data-dfn-type="argument" data-export="" id="dom-sourceexpression-nodematches-node-node">node<a class="self-link" href="#dom-sourceexpression-nodematches-node-node"></a></dfn>
                    
         <td>
                    Node 
         <td>
                    <span class="no">✘</span>
         <td>
                    <span class="no">✘</span>
         <td>The Node which will be matched against the directive.
                
       <caption>Arguments for the <a class="idl-code" data-link-type="method" href="#dom-sourceexpression-nodematches">SourceExpression.nodeMatches(node)</a> method.</caption>
       
            
      </table>
      
    
     
  
    </dl>
</section>



   <section>
</section>



   <section>
  
    <h2 class="heading settled" data-level="4" id="syntax"><span class="secno">4. </span><span class="content">
    Policy Syntax
  </span><a class="self-link" href="#syntax"></a></h2>


    <p>A <dfn data-dfn-type="dfn" data-local-lt="policy string" data-noexport="" id="serialized-content-security-policy">serialized Content Security Policy<a class="self-link" href="#serialized-content-security-policy"></a></dfn>
  consists of a semicolon-delimited list of directives. Each directive consists
  of a key and (optionally) a value, defined by the following ABNF <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>

  
    <pre><dfn data-dfn-type="grammar" data-export="" id="grammardef-policy-token">policy-token<a class="self-link" href="#grammardef-policy-token"></a></dfn> = <a data-link-type="grammar" href="#grammardef-directive-token">directive-token</a> *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a> ";" [ <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a> <a data-link-type="grammar" href="#grammardef-directive-token">directive-token</a> ] )
<dfn data-dfn-type="grammar" data-export="" id="grammardef-directive-token">directive-token<a class="self-link" href="#grammardef-directive-token"></a></dfn> = <a data-link-type="grammar" href="#grammardef-directive-name">directive-name</a> [ <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> <a data-link-type="grammar" href="#grammardef-directive-value">directive-value</a> ]
<dfn data-dfn-type="grammar" data-export="" id="grammardef-directive-name">directive-name<a class="self-link" href="#grammardef-directive-name"></a></dfn> = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "-" )
<dfn data-dfn-type="grammar" data-export="" id="grammardef-directive-value">directive-value<a class="self-link" href="#grammardef-directive-value"></a></dfn> = *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">WSP</a> / &lt;<a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">VCHAR</a> except ";" and ","> )
</pre>

  
    <div class="note" role="note">
    Note: The <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">BWS</a>, <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a>, and <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> rules are defined in
    <a data-link-type="biblio" href="#biblio-rfc7230">[RFC7230]</a>. <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a>, <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a>, <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">VCHAR</a>, and <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">WSP</a>
    are defined in <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>.
  </div>

  
    <h3 class="heading settled" data-level="4.1" id="syntax-source-list"><span class="secno">4.1. </span><span class="content">
    Source List Syntax
  </span><a class="self-link" href="#syntax-source-list"></a></h3>


    <p>The syntax for individual directives is defined in <a href="#csp-directives">§6 Content Security Policy Directives</a>, though
  many directives share a common <dfn data-dfn-type="dfn" data-noexport="" id="source-list">source list<a class="self-link" href="#source-list"></a></dfn> syntax defined below.</p>


    <p>A source list represents a set of locations from which content of a specified
  type can be fetched and potentially embedded or executed. Locations are
  represented by one of the following types of <dfn data-dfn-type="dfn" data-noexport="" id="source-expression">source expression<a class="self-link" href="#source-expression"></a></dfn>:</p>


    <ol>
     <li data-md="">
      <p>Keywords such as <a data-link-type="grammar" href="#grammardef-none"><code>'none'</code></a> and
  <a data-link-type="grammar" href="#grammardef-self"><code>'self'</code></a> (which match nothing and the current
  URL’s origin, respectively)</p>
      


     <li data-md="">
      <p>Serialized URLs such as <code>https://example.com/path/to/file.js</code>
  (which matches a specific file) or <code>https://example.com/</code>
  (which matches everything on that origin)</p>
      


     <li data-md="">
      <p>Schemes such as <code>https:</code> (which matches any resource having
  the specified scheme)</p>
      


     <li data-md="">
      <p>Hosts such as <code>example.com</code> (which matches any resource on
  the host, regardless of scheme) or <code>*.example.com</code> (which
  matches any resource on the host or any of its subdomains (and any of
  its subdomains' subdomains, and so on))</p>
      


     <li data-md="">
      <p>Nonces such as <code>'nonce-qwertyu12345'</code> (which can match specific
  elements on a page)</p>
      


     <li data-md="">
      <p>Digests such as <code>'sha256-abcd...'</code> (which can match specific
  elements on a page)</p>
      
</ol>

    <p>These representations are defined by the following ABNF <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>

  
    <pre><dfn data-dfn-type="grammar" data-export="" id="grammardef-source-list">source-list<a class="self-link" href="#grammardef-source-list"></a></dfn>       = <a data-link-type="grammar" href="#grammardef-source-expression">source-expression</a> *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> <a data-link-type="grammar" href="#grammardef-source-expression">source-expression</a> )
                    / "<dfn data-dfn-type="grammar" data-export="" id="grammardef-none">'none'<a class="self-link" href="#grammardef-none"></a></dfn>"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-source-expression">source-expression<a class="self-link" href="#grammardef-source-expression"></a></dfn> = <a data-link-type="grammar" href="#grammardef-scheme-source">scheme-source</a> / <a data-link-type="grammar" href="#grammardef-host-source">host-source</a> / <a data-link-type="grammar" href="#grammardef-keyword-source">keyword-source</a>
                    / <a data-link-type="grammar" href="#grammardef-nonce-source">nonce-source</a> / <a data-link-type="grammar" href="#grammardef-hash-source">hash-source</a>

; Schemes: `scheme:`
<dfn data-dfn-type="grammar" data-export="" id="grammardef-scheme-source">scheme-source<a class="self-link" href="#grammardef-scheme-source"></a></dfn> = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a> ":"

; Hosts: `example.com` / `*.example.com` / `https://*.example.com:12/path/to/file.js`
<dfn data-dfn-type="grammar" data-export="" id="grammardef-host-source">host-source<a class="self-link" href="#grammardef-host-source"></a></dfn> = [ <a data-link-type="grammar" href="#grammardef-scheme-part">scheme-part</a> "://" ] <a data-link-type="grammar" href="#grammardef-host-part">host-part</a> [ <a data-link-type="grammar" href="#grammardef-port-part">port-part</a> ] [ <a data-link-type="grammar" href="#grammardef-path-part">path-part</a> ]
<dfn data-dfn-type="grammar" data-export="" id="grammardef-scheme-part">scheme-part<a class="self-link" href="#grammardef-scheme-part"></a></dfn> = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a>
<dfn data-dfn-type="grammar" data-export="" id="grammardef-host-part">host-part<a class="self-link" href="#grammardef-host-part"></a></dfn>   = "*" / [ "*." ] 1*<a data-link-type="grammar" href="#grammardef-host-char">host-char</a> *( "." 1*<a data-link-type="grammar" href="#grammardef-host-char">host-char</a> )
<dfn data-dfn-type="grammar" data-export="" id="grammardef-host-char">host-char<a class="self-link" href="#grammardef-host-char"></a></dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "-"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-port-part">port-part<a class="self-link" href="#grammardef-port-part"></a></dfn>   = ":" ( 1*<a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "*" )
<dfn data-dfn-type="grammar" data-export="" id="grammardef-path-part">path-part<a class="self-link" href="#grammardef-path-part"></a></dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a>
   
; Keywords:
<dfn data-dfn-type="grammar" data-export="" id="grammardef-keyword-source">keyword-source<a class="self-link" href="#grammardef-keyword-source"></a></dfn> = "<dfn data-dfn-type="grammar" data-export="" id="grammardef-self">'self'<a class="self-link" href="#grammardef-self"></a></dfn>" / "<dfn data-dfn-type="grammar" data-export="" id="grammardef-unsafe-inline">'unsafe-inline'<a class="self-link" href="#grammardef-unsafe-inline"></a></dfn>" / "<dfn data-dfn-type="grammar" data-export="" id="grammardef-unsafe-eval">'unsafe-eval'<a class="self-link" href="#grammardef-unsafe-eval"></a></dfn>" 

; Nonces: 'nonce-[nonce goes here]'
<dfn data-dfn-type="grammar" data-export="" id="grammardef-nonce-source">nonce-source<a class="self-link" href="#grammardef-nonce-source"></a></dfn>  = "'nonce-" <a data-link-type="grammar" href="#grammardef-base64-value">base64-value</a> "'"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-base64-value">base64-value<a class="self-link" href="#grammardef-base64-value"></a></dfn>  = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "+" / "/" )*2( "=" ) 

; Digests: 'sha256-[digest goes here]'
<dfn data-dfn-type="grammar" data-export="" id="grammardef-hash-source">hash-source<a class="self-link" href="#grammardef-hash-source"></a></dfn>    = "'" <a data-link-type="grammar" href="#grammardef-hash-algorithm">hash-algorithm</a> "-" <a data-link-type="grammar" href="#grammardef-base64-value">base64-value</a> "'"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-hash-algorithm">hash-algorithm<a class="self-link" href="#grammardef-hash-algorithm"></a></dfn> = "sha256" / "sha384" / "sha512"
</pre>


    <p class="note" role="note">Note: The <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a> and <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a> rules are defined in
  <a data-link-type="biblio" href="#biblio-rfc3986">[RFC3986]</a>.</p>


    <p>The <a data-link-type="grammar" href="#grammardef-host-char">host-char</a> production intentionally contains only ASCII
  characters; internationalized domain names cannot be entered directly into a
  <a data-link-type="dfn" href="#serialized-content-security-policy">policy string</a>, but instead MUST be Punycode-encoded <a data-link-type="biblio" href="#biblio-rfc3492">[RFC3492]</a>. For
  example, the domain <code>üüüüüü.de</code> MUST be represented as
  <code>xn--tdaaaaaa.de</code>.</p>


    <p class="note" role="note">Note: Though IP address do match the grammar above, only
  <code>127.0.0.1</code> will actually match a URL when used in a source
  expression (see <a href="#match-url-to-source-list">§7.4.2 Does url match source list?</a> for details). The security
  properties of IP addresses are suspect, and authors ought to prefer hostnames
  whenever possible.</p>

  
    <h4 class="heading settled" data-level="4.1.1" id="script-src-the-nonce-attribute"><span class="secno">4.1.1. </span><span class="content">
    The <code>nonce</code> attribute
  </span><a class="self-link" href="#script-src-the-nonce-attribute"></a></h4>


    <p>Nonce sources require a new <code>nonce</code> attribute to be added to
  both <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a></code> elements.</p>

  
    <pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/scripting.html#htmlscriptelement">HTMLScriptElement</a> {
  attribute DOMString <a class="idl-code" data-link-type="attribute" data-type="DOMString " href="#dom-htmlscriptelement-nonce">nonce</a>;
};
</pre>
  
    <dl>
    
     <dt><dfn class="idl-code" data-dfn-for="HTMLScriptElement" data-dfn-type="attribute" data-export="" id="dom-htmlscriptelement-nonce">nonce<a class="self-link" href="#dom-htmlscriptelement-nonce"></a></dfn>, <span> of type <a data-link-type="idl-name" href="http://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span>
     
    
     <dd>
      This attribute <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#reflect">reflects</a> the value of the element’s
      <code><dfn data-dfn-for="script" data-dfn-type="element-attr" data-export="" id="element-attrdef-script-nonce">nonce<a class="self-link" href="#element-attrdef-script-nonce"></a></dfn></code>
      content attribute.
    
     
  
    </dl>
  
    <pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/semantics.html#htmlstyleelement">HTMLStyleElement</a> {
  attribute DOMString <a class="idl-code" data-link-type="attribute" data-type="DOMString " href="#dom-htmlstyleelement-nonce">nonce</a>;
};
</pre>
  
    <dl>
    
     <dt><dfn class="idl-code" data-dfn-for="HTMLStyleElement" data-dfn-type="attribute" data-export="" id="dom-htmlstyleelement-nonce">nonce<a class="self-link" href="#dom-htmlstyleelement-nonce"></a></dfn>, <span> of type <a data-link-type="idl-name" href="http://heycam.github.io/webidl/#idl-DOMString">DOMString</a></span>
     
    
     <dd>
      This attribute <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#reflect">reflects</a> the value of the element’s
      <code><dfn data-dfn-for="style" data-dfn-type="element-attr" data-export="" id="element-attrdef-style-nonce">nonce<a class="self-link" href="#element-attrdef-style-nonce"></a></dfn></code>
      content attribute.
    
     
  
    </dl>
</section>



   <section>
  
    <h2 class="heading settled" data-level="5" id="reporting"><span class="secno">5. </span><span class="content">
    Reporting
  </span><a class="self-link" href="#reporting"></a></h2>
</section>



   <section>
  
    <h2 class="heading settled" data-level="6" id="csp-directives"><span class="secno">6. </span><span class="content">
    Content Security Policy Directives
  </span><a class="self-link" href="#csp-directives"></a></h2>


    <p>This specification defines a number of types of <a data-link-type="dfn" href="#directive">directives</a> which allow
  developers to control certain aspects of their sites' behavior. The defined
  directives fall into one of several categories:</p>


    <ol>
     <li data-md="">
      <p><dfn data-dfn-type="dfn" data-noexport="" id="request-directives">Request Directives<a class="self-link" href="#request-directives"></a></dfn> control the locations from which certain
  resource types may be loaded. For instance, <a data-link-type="dfn" href="#script_src">script-src</a> allows
  developers to whitelist trusted sources of script to execute on a page,
  while <a data-link-type="dfn" href="#font_src">font-src</a> controls the sources of web fonts.</p>
      


     <li data-md="">
      <p>...</p>
      
</ol>

    <p>To mitigate the risk of cross-site scripting attacks, web developers SHOULD
  include directives that regulate sources of script and plugins. They can do
  so by including:</p>


    <ul>
     <li data-md="">
      <p>Both the <a data-link-type="dfn" href="#script_src">script-src</a> and <a data-link-type="dfn" href="#object_src">object-src</a> directives, or</p>
      

     <li data-md="">
      <p>a <a data-link-type="dfn" href="#default_src">default-src</a> directive</p>
      
</ul>

    <p>In either case, developers SHOULD NOT include either
  <a data-link-type="grammar" href="#grammardef-unsafe-inline"><code>'unsafe-inline'</code></a>, or <code>data:</code> as valid
  sources in their policies. Both enable XSS attacks by allowing code to be
  included directly in the document itself; they are best avoided completely.</p>

  
    <h3 class="heading settled" data-level="6.1" id="directives-request"><span class="secno">6.1. </span><span class="content">
    Request Directives
  </span><a class="self-link" href="#directives-request"></a></h3>

  
    <h4 class="heading settled" data-level="6.1.1" id="directive-child-src"><span class="secno">6.1.1. </span><span class="content"><code>child-src</code></span><a class="self-link" href="#directive-child-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="child_src">child-src<a class="self-link" href="#child_src"></a></dfn> directive governs the creation of <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing
  contexts</a> and Worker execution contexts. The syntax for the directive’s
  name and value is described by the following ABNF:</p>

  
    <pre>directive-name  = "child-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>

  
    <div class="example" id="example-d4ca96a2"><a class="self-link" href="#example-d4ca96a2"></a>
    Given a page with the following Content Security Policy:

    
     <pre>Content-Security-Policy: child-src https://example.com/
</pre>
     


     <p>Fetches for the following code will all return network errors, as the URLs
    provided do not match <code>child-src</code>’s <a data-link-type="dfn" href="#source-list">source list</a>:</p>
     

    
     <pre>&lt;iframe src="https://not-example.com">&lt;/iframe>
&lt;script>
  var blockedWorker = new Worker("data:application/javascript,...");
&lt;/script>
</pre>
     
  
    </div>

  
    <h4 class="heading settled" data-level="6.1.2" id="directive-connect-src"><span class="secno">6.1.2. </span><span class="content"><code>connect-src</code></span><a class="self-link" href="#directive-connect-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="connect_src">connect-src<a class="self-link" href="#connect_src"></a></dfn> directive restricts the URLs which can be loaded
  using script interfaces such as those defined in <a data-link-type="biblio" href="#biblio-xmlhttprequest">[XMLHttpRequest]</a> and
  <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a>. The syntax for the directive’s name and value is described by
  the following ABNF:</p>

  
    <pre>directive-name  = "connect-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>

  
    <h4 class="heading settled" data-level="6.1.3" id="directive-default-src"><span class="secno">6.1.3. </span><span class="content"><code>default-src</code></span><a class="self-link" href="#directive-default-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="default_src">default-src<a class="self-link" href="#default_src"></a></dfn> directive serves as a fallback for the other
  <a data-link-type="dfn" href="#request-directives">request directives</a>. The syntax for the directive’s name and value is described by
  the following ABNF:</p>

  
    <pre>directive-name  = "default-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>

  
    <h4 class="heading settled" data-level="6.1.4" id="directive-font-src"><span class="secno">6.1.4. </span><span class="content"><code>font-src</code></span><a class="self-link" href="#directive-font-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="font_src">font-src<a class="self-link" href="#font_src"></a></dfn> directive restricts the URLs from which font resources
  may be loaded. The syntax for the directive’s name and value is described by
  the following ABNF:</p>

  
    <pre>directive-name  = "font-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>

  
    <h4 class="heading settled" data-level="6.1.5" id="directive-img-src"><span class="secno">6.1.5. </span><span class="content"><code>img-src</code></span><a class="self-link" href="#directive-img-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="img_src">img-src<a class="self-link" href="#img_src"></a></dfn> directive restricts the URLs from which image resources
  may be loaded. The syntax for the directive’s name and value is described by
  the following ABNF:</p>

  
    <pre>directive-name  = "img-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>

  
    <h4 class="heading settled" data-level="6.1.6" id="directive-media-src"><span class="secno">6.1.6. </span><span class="content"><code>media-src</code></span><a class="self-link" href="#directive-media-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="media_src">media-src<a class="self-link" href="#media_src"></a></dfn> directive restricts the URLs from which video, audio,
  and associated text track resources may be loaded. The syntax for the
  directive’s name and value is described by the following ABNF:</p>

  
    <pre>directive-name  = "media-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>

  
    <h4 class="heading settled" data-level="6.1.7" id="directive-object-src"><span class="secno">6.1.7. </span><span class="content"><code>object-src</code></span><a class="self-link" href="#directive-object-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="object_src">object-src<a class="self-link" href="#object_src"></a></dfn> directive restricts the URLs from which plugins may
  be loaded. The syntax for the directive’s name and value is described by the
  following ABNF:</p>

  
    <pre>directive-name  = "object-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>

  
    <h4 class="heading settled" data-level="6.1.8" id="directive-script-src"><span class="secno">6.1.8. </span><span class="content"><code>script-src</code></span><a class="self-link" href="#directive-script-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="script_src">script-src<a class="self-link" href="#script_src"></a></dfn> directive restricts the locations from which scripts
  may be executed. This includes not only URLs loaded directly into <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code>
  elements, but also things like inline script blocks and XSLT stylesheets
  <a data-link-type="biblio" href="#biblio-xslt">[XSLT]</a> which can trigger script execution. The syntax for the directive’s
  name and value is described by the following ABNF:</p>

  
    <pre>directive-name  = "script-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>


  
    <h4 class="heading settled" data-level="6.1.9" id="directive-style-src"><span class="secno">6.1.9. </span><span class="content"><code>style-src</code></span><a class="self-link" href="#directive-style-src"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="style_src">style-src<a class="self-link" href="#style_src"></a></dfn> directive restricts the locations from which style
  may be applied to a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code>. The syntax for the directive’s name and
  value is described by the following ABNF:</p>

  
    <pre>directive-name  = "style-src"
directive-value = <a data-link-type="grammar" href="#grammardef-source-list">source-list</a>
</pre>

  
    <h3 class="heading settled" data-level="6.2" id="directives-other"><span class="secno">6.2. </span><span class="content">
    Grabbag
  </span><a class="self-link" href="#directives-other"></a></h3>

  
    <h4 class="heading settled" data-level="6.2.1" id="directive-base-uri"><span class="secno">6.2.1. </span><span class="content"><code>base-uri</code></span><a class="self-link" href="#directive-base-uri"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="base_uri">base-uri<a class="self-link" href="#base_uri"></a></dfn> directive restricts the <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code>s which can be used in
  a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code>'s <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-base-element">base</a></code> element. The syntax for the directive’s name and
  value is described by the following ABNF:</p>

  
    <pre>directive-name  = "base-uri"
directive-value = &lt;URL> ; TODO: Figure out what to use here.
</pre>

  
    <h4 class="heading settled" data-level="6.2.2" id="directive-form-action"><span class="secno">6.2.2. </span><span class="content"><code>form-action</code></span><a class="self-link" href="#directive-form-action"></a></h4>
  
    <h4 class="heading settled" data-level="6.2.3" id="directive-frame-ancestors"><span class="secno">6.2.3. </span><span class="content"><code>frame-ancestors</code></span><a class="self-link" href="#directive-frame-ancestors"></a></h4>
  
    <h4 class="heading settled" data-level="6.2.4" id="directive-plugin-types"><span class="secno">6.2.4. </span><span class="content"><code>plugin-types</code></span><a class="self-link" href="#directive-plugin-types"></a></h4>
  
    <h4 class="heading settled" data-level="6.2.5" id="directive-sandbox"><span class="secno">6.2.5. </span><span class="content"><code>sandbox</code></span><a class="self-link" href="#directive-sandbox"></a></h4>

  
    <h3 class="heading settled" data-level="6.3" id="directives-reporting"><span class="secno">6.3. </span><span class="content">
    Reporting Directives
  </span><a class="self-link" href="#directives-reporting"></a></h3>

  
    <h4 class="heading settled" data-level="6.3.1" id="directive-report-uri"><span class="secno">6.3.1. </span><span class="content"><code>report-uri</code></span><a class="self-link" href="#directive-report-uri"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="report_uri">report-uri<a class="self-link" href="#report_uri"></a></dfn> directive is deprecated. Please use the
  <a data-link-type="dfn" href="#reports">reports</a> directive instead.</p>

  
    <h4 class="heading settled" data-level="6.3.2" id="directive-report"><span class="secno">6.3.2. </span><span class="content"><code>reports</code></span><a class="self-link" href="#directive-report"></a></h4>


    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="reports">reports<a class="self-link" href="#reports"></a></dfn> directive defines the endpoint to which violation
  reports are sent. The syntax for the directive’s name and
  value is described by the following ABNF:</p>

  
    <pre>directive-name  = "reports"
directive-value = &lt;URL> ; TODO: Figure out what to use here.
</pre>

</section>



   <section>
  
    <h2 class="heading settled" data-level="7" id="algorithms"><span class="secno">7. </span><span class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>

  
    <h3 class="heading settled" data-level="7.1" id="algorithms-fetch"><span class="secno">7.1. </span><span class="content">Fetch Interface</span><a class="self-link" href="#algorithms-fetch"></a></h3>


    <p>This specification provides two algorithms which allow Fetch to make decisions
  about whether or not a particular <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> should be blocked based on
  its <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a></code>'s Content Security Policy <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a>. The policy check
  occurs twice: once at the top of Fetch, ensuring that outgoing requests
  satisfy the relevant policy; and once at the bottom, ensuring that incoming
  responses match as well (as they could have been modified in interesting ways
  by an intermediate Service Worker). These algorithms can be considered the
  public interface to the Content Security Policy specification:</p>

  
    <h4 class="heading settled" data-level="7.1.1" id="should-block-request"><span class="secno">7.1.1. </span><span class="content">
    Should <var>request</var> be blocked by Content Security Policy?
  </span><a class="self-link" href="#should-block-request"></a></h4>


    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), this algorithm returns
  <code>Blocked</code> or <code>Allowed</code> based on <var>request</var>’s
  <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a></code>'s Content Security Policy.</p>


    <p class="note" role="note">Note: <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> calls this algorithm as step #3 of its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch">Main Fetch</a>
  algorithm.</p>


    <ol>
     <li data-md="">
      <p>Let <var>client</var> be <var>request</var>’s <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a></code>.</p>
      


     <li data-md="">
      <p>Return <code>Blocked</code>.</p>
      
</ol>

    <p class="issue" id="issue-52c2483f"><a class="self-link" href="#issue-52c2483f"></a> We should probably expand on this definition a bit.</p>

  
    <h4 class="heading settled" data-level="7.1.2" id="should-block-response"><span class="secno">7.1.2. </span><span class="content">
    Should <var>response</var> to <var>request</var> be blocked by Content
    Security Policy?
  </span><a class="self-link" href="#should-block-response"></a></h4>


    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>) and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a>
  (<var>request</var>), this algorithm returns <code>Blocked</code> or
  <code>Allowed</code> based on <var>request</var>’s <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a></code>'s
  Content Security Policy.</p>


    <p class="note" role="note">Note: <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> calls this algorithm as step #12 of its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch">Main Fetch</a>
  algorithm.</p>


    <ol>
     <li data-md="">
      <p>Let <var>client</var> be <var>request</var>’s <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a></code>.</p>
      


     <li data-md="">
      <p>Return <code>Blocked</code>.</p>
      
</ol>

    <p class="issue" id="issue-52c2483f0"><a class="self-link" href="#issue-52c2483f0"></a> We should probably expand on this definition a bit.</p>

  
    <h3 class="heading settled" data-level="7.2" id="algorithms-application"><span class="secno">7.2. </span><span class="content">
    Policy Application Algorithms
  </span><a class="self-link" href="#algorithms-application"></a></h3>


    <p class="issue" id="issue-a9d190ea"><a class="self-link" href="#issue-a9d190ea"></a> Monkey patches gonna monkey patch. Talk to WHATWG / WICG.</p>


    <p>Each of the delivery mechanisms specified in <a href="#policy-delivery">§3 Policy Delivery</a> can be used
  to add values to one of three properties this specification adds to
  <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings objects</a> to store the relevant policy data for a
  resource:</p>


    <dl>
     <dt data-md="">
      <p><dfn data-dfn-for="environment settings object" data-dfn-type="dfn" data-export="" id="enforced-content-security-policies">
  enforced Content Security Policies
<a class="self-link" href="#enforced-content-security-policies"></a></dfn></p>
      

     <dd data-md="">
      <p>A set of <a data-link-type="dfn" href="#policy">policies</a> which are to be enforced for the settings object.
 This property’s value is the empty set unless otherwise specified.</p>
      

     <dt data-md="">
      <p><dfn data-dfn-for="environment settings object" data-dfn-type="dfn" data-export="" id="monitored-content-security-policies">
  monitored Content Security Policies
<a class="self-link" href="#monitored-content-security-policies"></a></dfn></p>
      

     <dd data-md="">
      <p>A list of <a data-link-type="dfn" href="#policy">policies</a> which are to be monitored for the settings
 object. This property’s value is the empty list unless otherwise specified.</p>
      

     <dt data-md="">
      <p><dfn data-dfn-for="environment settings object" data-dfn-type="dfn" data-export="" id="inherits-content-security-policies">
  inherits Content Security Policies
<a class="self-link" href="#inherits-content-security-policies"></a></dfn></p>
      

     <dd data-md="">
      <p>A boolean value signifying whether or not the policies of an <a data-link-type="dfn" href="#embedding-documents">embedding
 <code>Document</code></a> ought to be applied (as described in
 <a href="#get-policies">§7.5.1 Gather policies for environment settings object and
    disposition</a>). This property is <code>false</code> unless otherwise
 specified.</p>
      
</dl>

    <p>A <a data-link-type="dfn" href="#policy">policy</a> is <dfn data-dfn-type="dfn" data-export="" data-local-lt="enforcing" id="enforced">enforced<a class="self-link" href="#enforced"></a></dfn> for an
  <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a> by inserting it into the object’s
  <a data-link-type="dfn" href="#enforced-content-security-policies">enforced Content Security Policies</a> list. A string is <a data-link-type="dfn" href="#enforced">enforced</a>
  by <a data-link-type="dfn" href="#enforced">enforcing</a> each result of executing <a href="#parse-policy-string">§7.3.1 Parse string as a Content Security Policy</a> on the
  string.</p>


    <p>A <a data-link-type="dfn" href="#policy">policy</a> is <dfn data-dfn-type="dfn" data-export="" data-local-lt="monitoring" id="monitored">monitored<a class="self-link" href="#monitored"></a></dfn> for an
  <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a> by inserting it into the object’s
  <a data-link-type="dfn" href="#monitored-content-security-policies">monitored Content Security Policies</a> list. A string is <a data-link-type="dfn" href="#monitored">monitored</a>
  by <a data-link-type="dfn" href="#monitored">monitoring</a> each result of executing <a href="#parse-policy-string">§7.3.1 Parse string as a Content Security Policy</a> on the
  string.</p>

  
    <h4 class="heading settled" data-level="7.2.1" id="apply-to-document"><span class="secno">7.2.1. </span><span class="content">
    Apply policies to a <code>Document</code> created via a <var>response</var>
  </span><a class="self-link" href="#apply-to-document"></a></h4>


    <p>When <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#create-a-document-object">creating</a> a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> object
  (<var>document</var>) for a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>):</p>


    <ol>
     <li data-md="">
      <p>If <var>response</var>’s <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a></code>'s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is a
  <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a>:</p>
      


      <ol>
       <li data-md="">
        <p>Set <var>document</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings object</a>’s
  <code><a data-link-type="dfn" href="#inherits-content-security-policies">inherits Content Security Policies</a></code> property to
  <code>true</code>.</p>
        
</ol>
      

     <li data-md="">
      <p>Otherwise:</p>
      


      <ol>
       <li data-md="">
        <p>Execute <a href="#apply-policy-from-headers">§7.2.6 Apply policies from header list to environment settings
    object</a> on
  <var>response</var>’s <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> and
  <var>document</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings object</a>.</p>
        
</ol></ol>
  
    <h4 class="heading settled" data-level="7.2.2" id="apply-to-srcdoc-document"><span class="secno">7.2.2. </span><span class="content">
    Apply policies to an <code>IFrame</code> <code>srcdoc</code>
    <code>Document</code>
  </span><a class="self-link" href="#apply-to-srcdoc-document"></a></h4>


    <p>When <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#create-a-document-object">creating</a> a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> object
  (<var>document</var>) for <a data-link-type="dfn" href="http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document">an iframe srcdoc document</a>:</p>


    <ol>
     <li data-md="">
      <p>Set <var>document</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings object</a>’s
  <code><a data-link-type="dfn" href="#inherits-content-security-policies">inherits Content Security Policies</a></code> property to
  <code>true</code>.</p>
      
</ol>
  
    <h4 class="heading settled" data-level="7.2.3" id="apply-to-worker"><span class="secno">7.2.3. </span><span class="content">
    Apply policies to a <code>Worker</code>
  </span><a class="self-link" href="#apply-to-worker"></a></h4>


    <p>When <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker">running a worker</a> <var>worker</var> for
  <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a> <var>settings</var> successfully
  executes a Fetch in its current step 4:</p>


    <ol>
     <li data-md="">
      <p>If <var>response</var>’s <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a></code>'s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is a
  <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a>:</p>
      


      <ol>
       <li data-md="">
        <p>Set <var>settings</var> <code><a data-link-type="dfn" href="#inherits-content-security-policies">inherits Content Security
  Policies</a></code> property to <code>true</code>.</p>
        
</ol>
      

     <li data-md="">
      <p>Otherwise:</p>
      


      <ol>
       <li data-md="">
        <p>Execute <a href="#apply-policy-from-headers">§7.2.6 Apply policies from header list to environment settings
    object</a> on
  the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>’s <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> and
  <var>settings</var>.</p>
        
</ol></ol>

    <p class="note" role="note">Note: This is using the WHATWG’s definition of "run a worker", because
  the W3C’s version has no concept of environment settings objects.</p>


    <p class="issue" id="issue-91583e37"><a class="self-link" href="#issue-91583e37"></a> Does this cover Service Workers?</p>

  
    <h4 class="heading settled" data-level="7.2.4" id="apply-via-meta"><span class="secno">7.2.4. </span><span class="content">
    Apply policies to <var>document</var> via <code>&lt;meta></code>
  </span><a class="self-link" href="#apply-via-meta"></a></h4>


    <p class="issue" id="issue-4c471074"><a class="self-link" href="#issue-4c471074"></a> Monkey-patching! Move this to HTML.</p>


    <p>Add the following entry to the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/document-metadata.html#pragma-directives">pragma directives</a> for the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code>
  element:</p>

  
    <dl>
    
     <dt>
      Content security policy
      (<code>http-equiv="content-security-policy"</code>)
    
     
    
     <dd>
      
      <ol>
        
       <li>
          If the Document’s <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-head-element">head</a></code> element is not an ancestor of the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code>
          element, abort these steps.
        
       

        
       <li>
          If the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element lacks a <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content">content</a></code> attribute, abort
          these steps.
        
       

        
       <li>
          Let <var>content</var> be the value of the <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content">content</a></code> attribute
          of the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element.
        
       

        
       <li>
          Let <var>policy</var> be the result of executing
          <a href="#parse-policy-string">§7.3.1 Parse string as a Content Security Policy</a> on <var>content</var>.
        
       

        
       <li>
          Remove all occurrences of <code>report-uri</code>,
          <code>frame-ancestors</code>, and <code>sandbox</code>
          directives from <var>policy</var>’s directive set.


        <p class="note" role="note">Note: User agents are encouraged to issue a warning to developers
          if one or more of these directives are included in a policy
          delivered via <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code>.</p>
        


        <p class="issue" id="issue-edbe0d6a"><a class="self-link" href="#issue-edbe0d6a"></a> Wire all this up once the directives exist and the policy
          object is defined.</p>
        
        
       

        
       <li>
          <a data-link-type="dfn" href="#enforced">Enforce</a> <var>policy</var> on the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings
          object</a>.
      
      </ol>
      
    
     
  
    </dl>

  
    <h4 class="heading settled" data-level="7.2.5" id="apply-to-global-object"><span class="secno">7.2.5. </span><span class="content">
    Apply <var>policy</var> to <var>global object</var>
  </span><a class="self-link" href="#apply-to-global-object"></a></h4>


    <ol>
     <li data-md="">
      <p>Let <var>settings</var> be the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant settings object</a> for
  <var>global object</var>.</p>
      


     <li data-md="">
      <p>If <var>policy</var>’s <a data-link-type="dfn" href="#type">type</a> attribute is
  "<code>enforce</code>", <a data-link-type="dfn" href="#enforced">enforce</a> <var>policy</var> for
  <var>settings</var>.</p>
      


     <li data-md="">
      <p>Otherwise, <var>policy</var>’s <a data-link-type="dfn" href="#type">type</a> attribute is
  "<code>report-only</code>", so <a data-link-type="dfn" href="#monitored">monitor</a> <var>policy</var> for
  <var>settings</var>.</p>
      
</ol>
  
    <h4 class="heading settled" data-level="7.2.6" id="apply-policy-from-headers"><span class="secno">7.2.6. </span><span class="content">
    Apply policies from <var>header list</var> to <var>environment settings
    object</var>
  </span><a class="self-link" href="#apply-policy-from-headers"></a></h4>


    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>’s <a class="idl-code" data-link-type="attribute" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> (<var>header
  list</var>) and an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a> (<var>settings</var>),
  this algorithm extracts the policies which ought to be <a data-link-type="dfn" href="#enforced">enforced</a> and
  <a data-link-type="dfn" href="#monitored">monitored</a> for the settings object, and does so:</p>


    <ol>
     <li data-md="">
      <p>Let <var>policy to enforce</var> be the result of
  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-parse">parsing</a>
  <a data-link-type="dfn" href="#content_security_policy"><code>Content-Security-Policy</code></a> in
  <var>header list</var>.</p>
      


     <li data-md="">
      <p>Let <var>policies</var> be the result of executing
  <a href="#parse-policy-string">§7.3.1 Parse string as a Content Security Policy</a> on <var>policy to enforce</var>.</p>
      


     <li data-md="">
      <p><a data-link-type="dfn" href="#enforced">Enforce</a> each policy object in <var>policies</var> on
  <var>settings</var>.</p>
      


     <li data-md="">
      <p>Let <var>policy to monitor</var> be the result of
  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-parse">parsing</a>
  <a data-link-type="dfn" href="#content_security_policy_report_only"><code>Content-Security-Policy-Report-Only</code></a> in
  <var>header list</var>.</p>
      


     <li data-md="">
      <p>Let <var>policies</var> be the result of executing
  <a href="#parse-policy-string">§7.3.1 Parse string as a Content Security Policy</a> on <var>policy to monitor</var>.</p>
      


     <li data-md="">
      <p><a data-link-type="dfn" href="#monitored">Monitor</a> each policy object in <var>policies</var> on
  <var>settings</var>.</p>
      
</ol>
  
    <h3 class="heading settled" data-level="7.3" id="algorithms-parsing"><span class="secno">7.3. </span><span class="content">Parsing Algorithms</span><a class="self-link" href="#algorithms-parsing"></a></h3>

  
    <h4 class="heading settled" data-level="7.3.1" id="parse-policy-string"><span class="secno">7.3.1. </span><span class="content">
    Parse <var>string</var> as a Content Security Policy
  </span><a class="self-link" href="#parse-policy-string"></a></h4>


    <p>Given a <a data-link-type="dfn" href="#serialized-content-security-policy">policy string</a> (<var>string</var>), this algorithm will return a
  list of <a data-link-type="dfn" href="#policy">policies</a>. In the case of a fatal parse error, this list will be
  empty.</p>

  
    <h4 class="heading settled" data-level="7.3.2" id="parse-source-list"><span class="secno">7.3.2. </span><span class="content">
    Parse <var>string</var> as a source list
  </span><a class="self-link" href="#parse-source-list"></a></h4>


    <p>Given a <a data-link-type="dfn" href="#source-list-directive">source list directive</a>’s <a data-link-type="dfn" href="#value">value</a>, this
  algorithm will return a list of <a data-link-type="dfn" href="#source-expression">source expressions</a>. In the case of a
  fatal parse error, this list will be empty.</p>

  
    <h3 class="heading settled" data-level="7.4" id="algorithms-matching"><span class="secno">7.4. </span><span class="content">Matching Algorithms</span><a class="self-link" href="#algorithms-matching"></a></h3>

  
    <h4 class="heading settled" data-level="7.4.1" id="match-request-to-directive-list"><span class="secno">7.4.1. </span><span class="content">
    Does <var>request</var> match <var>directive list</var>?
  </span><a class="self-link" href="#match-request-to-directive-list"></a></h4>


    <p class="issue" id="issue-db7807b9"><a class="self-link" href="#issue-db7807b9"></a> Parse the request to determine which directive applies, find the
  relevant directive in the list, and call <a href="#match-url-to-source-list">§7.4.2 Does url match source list?</a>.</p>

  
    <h4 class="heading settled" data-level="7.4.2" id="match-url-to-source-list"><span class="secno">7.4.2. </span><span class="content">
    Does <var>url</var> match <var>source list</var>?
  </span><a class="self-link" href="#match-url-to-source-list"></a></h4>


    <p>Given a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> (<var>url</var>) and a <a data-link-type="dfn" href="#source-list">source list</a> (<var>list</var>),
  this algorithm returns <code>Matches</code> or <code>Does Not Match</code>.</p>


    <ol>
     <li data-md="">
      <p>For each <var>expression</var> in <var>list</var>:</p>
      


      <ol>
       <li data-md="">
        <p>If <a href="#match-url-to-source-expression">§7.4.3 Does url match source expression?</a> returns <code>Matches</code>
  when executed upon <var>url</var> and <var>expression</var>, then
  return <code>Matches</code></p>
        
</ol>
      

     <li data-md="">
      <p>Return <code>Does Not Match</code>.</p>
      
</ol>
  
    <h4 class="heading settled" data-level="7.4.3" id="match-url-to-source-expression"><span class="secno">7.4.3. </span><span class="content">
    Does <var>url</var> match <var>source expression</var>?
  </span><a class="self-link" href="#match-url-to-source-expression"></a></h4>


    <p>Given a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> (<var>url</var>) and a <a data-link-type="dfn" href="#source-expression">source expression</a>
  (<var>source</var>), this algorithm returns <code>Matches</code> or <code>Does
  Not Match</code>.</p>


    <ol>
     <li data-md="">
      <p>Return <code>Does Not Match</code>.</p>
      
</ol>

    <p class="issue" id="issue-4ba1072f"><a class="self-link" href="#issue-4ba1072f"></a> This might need a bit of polishing.</p>

  
    <h4 class="heading settled" data-level="7.4.4" id="match-node-to-directive-list"><span class="secno">7.4.4. </span><span class="content">
    Does <var>node</var> match <var>directive list</var>?
  </span><a class="self-link" href="#match-node-to-directive-list"></a></h4>


    <p class="issue" id="issue-f302c0a4"><a class="self-link" href="#issue-f302c0a4"></a> Parse the node to determine which directive applies, find the
  relevant directive in the list, and call <a href="#match-node-to-source-list">§7.4.5 Does node match source list?</a>.</p>

  
    <h4 class="heading settled" data-level="7.4.5" id="match-node-to-source-list"><span class="secno">7.4.5. </span><span class="content">
    Does <var>node</var> match <var>source list</var>?
  </span><a class="self-link" href="#match-node-to-source-list"></a></h4>


    <p>Given a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-node">Node</a></code> (<var>node</var>) and a <a data-link-type="dfn" href="#source-list">source list</a> (<var>list</var>),
  this algorithm returns <code>Matches</code> or <code>Does Not Match</code>.</p>


    <ol>
     <li data-md="">
      <p>For each <var>expression</var> in <var>list</var>:</p>
      


      <ol>
       <li data-md="">
        <p>If <a href="#match-node-to-source-expression">§7.4.6 Does node match source expression?</a> returns <code>Matches</code>
  when executed upon <var>node</var> and <var>expression</var>, then
  return <code>Matches</code></p>
        
</ol>
      

     <li data-md="">
      <p>Return <code>Does Not Match</code>.</p>
      
</ol>
  
    <h4 class="heading settled" data-level="7.4.6" id="match-node-to-source-expression"><span class="secno">7.4.6. </span><span class="content">
    Does <var>node</var> match <var>source expression</var>?
  </span><a class="self-link" href="#match-node-to-source-expression"></a></h4>


    <p>Given a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-node">Node</a></code> (<var>url</var>) and a <a data-link-type="dfn" href="#source-expression">source expression</a>
  (<var>source</var>), this algorithm returns <code>Matches</code> or <code>Does
  Not Match</code>.</p>


    <ol>
     <li data-md="">
      <p>Return <code>Does Not Match</code>.</p>
      
</ol>

    <p class="issue" id="issue-4ba1072f0"><a class="self-link" href="#issue-4ba1072f0"></a> This might need a bit of polishing.</p>

  
    <h3 class="heading settled" data-level="7.5" id="internal-helpers"><span class="secno">7.5. </span><span class="content">Internal Helpers</span><a class="self-link" href="#internal-helpers"></a></h3>


    <p>These algorithms are part of the internal processing model of Content Security
  Policy, and are not meant to be called from other specifications.</p>

  
    <h4 class="heading settled" data-level="7.5.1" id="get-policies"><span class="secno">7.5.1. </span><span class="content">
    Gather policies for <var>environment settings object</var> and
    <var>disposition</var>
  </span><a class="self-link" href="#get-policies"></a></h4>


    <p>Given an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a> (<var>settings</var>), and a
  <var>disposition</var> of either <code>Enforce</code> or
  <code>Monitor</code> this algorithm returns a list of <a data-link-type="dfn" href="#policy">policies</a> which
  ought to be considered.</p>


    <p>In order to properly deal with inheritance, this algorithm will walk through
  a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> <var>document</var>’s <dfn data-dfn-type="dfn" data-noexport="" id="embedding-documents">embedding documents<a class="self-link" href="#embedding-documents"></a></dfn>: the
  <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#browsing-context-nested-through">through which</a> <var>document</var>’s
  <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#browsing-context">browsing context</a> is nested.</p>


    <ol>
     <li data-md="">
      <p>Let <var>policies</var> be an empty list.</p>
      


     <li data-md="">
      <p>Let <var>effective policies</var> be <var>settings</var>' <a data-link-type="dfn" href="#enforced-content-security-policies">enforced
  Content Security Policies</a> attribute if <var>disposition</var> is
  <code>Enforce</code>, and <var>settings</var>' <a data-link-type="dfn" href="#monitored-content-security-policies">monitored Content
  Security Policies</a> otherwise.</p>
      


     <li data-md="">
      <p>For each <var>policy</var> in <var>effective policies</var>:</p>
      


      <ol>
       <li data-md="">
        <p>Push <var>policy</var> into <var>policies</var>.</p>
        
</ol>
      

     <li data-md="">
      <p>If <var>settings</var>' <a data-link-type="dfn" href="#inherits-content-security-policies">inherits Content Security Policies</a>
  attribute is <code>true</code>:</p>
      


      <ol>
       <li data-md="">
        <p>If <var>settings</var>' <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/browsers.html#window">Window</a></code>:</p>
        


        <ol>
         <li data-md="">
          <p>Let <var>parent</var> be <var>settings</var>' <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#responsible-browsing-context">responsible
  browsing context</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#active-document">active Document</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#creator-document">creator
  Document</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant settings
  object</a>.</p>
          


         <li data-md="">
          <p>Let <var>policies to inherit</var> be the result of executing
  <a href="#get-policies">§7.5.1 Gather policies for environment settings object and
    disposition</a> on <var>parent</var> and
  <var>disposition</var>.</p>
          


         <li data-md="">
          <p>For each <var>policy</var> in <var>policies to inherit</var>:</p>
          


          <ol>
           <li data-md="">
            <p>Push <var>policy</var> into <var>policies</var>.</p>
            
</ol></ol>
        

       <li data-md="">
        <p>Otherwise, <var>settings</var>' <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> is a
  <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a></code>:</p>
        


        <ol>
         <li data-md="">
          <p class="issue" id="issue-aafbdf7d"><a class="self-link" href="#issue-aafbdf7d"></a> I have no idea what to do here. Anne suggests
  monkey-patching <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker">run a worker</a>.</p>
          
</ol></ol>
      

     <li data-md="">
      <p>Return <var>policies</var>.</p>
      
</ol>
  
    <h4 class="heading settled" data-level="7.5.2" id="get-effective-directive"><span class="secno">7.5.2. </span><span class="content">
    Get the effective directive for <var>Request</var> from <var>policy</var>
  </span><a class="self-link" href="#get-effective-directive"></a></h4>


    <p>Given a <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request">Request</a></code> object (<var>request</var>), and a <a data-link-type="dfn" href="#policy">policy</a>
  (<var>policy</var>), this algorithm returns the <a data-link-type="dfn">effective directive</a>
  which controls the request. If no such directive is present in the
  given policy, this algorithm returns <code>null</code>.</p>


    <ol>
     <li data-md="">
      <p>Return <code>null</code>.</p>
      
</ol></section>



   <section>
  
    <h2 class="heading settled" data-level="8" id="security-considerations"><span class="secno">8. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h2>

  
    <h3 class="heading settled" data-level="8.1" id="security-nonces"><span class="secno">8.1. </span><span class="content">Nonce Reuse</span><a class="self-link" href="#security-nonces"></a></h3>


    <p>Nonces override the other restrictions present in the directive in which
  they’re delivered. It is critical, then, that they remain unguessable, as
  bypassing a resource’s policy is otherwise trivial.</p>


    <p>If a server delivers a <a data-link-type="grammar" href="#grammardef-nonce-source">nonce-source</a> expression as part of a
  <a data-link-type="dfn" href="#serialized-content-security-policy">policy string</a>, the server MUST generate a unique value each time it
  transmits a policy. The generated value SHOULD be at least 128 bits long
  (before encoding), and SHOULD be generated via a cryptographically secure
  random number generator in order to ensure that the value is difficult for
  an attacker to predict.</p>


    <p class="note" role="note">Note: Using a nonce to whitelist inline script or style is less secure than
  not using a nonce, as nonces override the restrictions in the directive in
  which they are present. An attacker who can gain access to the nonce can
  execute whatever script they like, whenever they like. That said, nonces
  provide a substantial improvement over <a data-link-type="grammar" href="#grammardef-unsafe-inline">'unsafe-inline'</a> when
  layering a content security policy on top of old code. When considering
  <a data-link-type="grammar" href="#grammardef-unsafe-inline">'unsafe-inline'</a>, authors are encouraged to consider nonces
  (or hashes) instead.</p>
</section>



   <section>
  
    <h2 class="heading settled" data-level="9" id="authoring-considerations"><span class="secno">9. </span><span class="content">Authoring Considerations</span><a class="self-link" href="#authoring-considerations"></a></h2>

  
    <h3 class="heading settled" data-level="9.1" id="multiple-policies"><span class="secno">9.1. </span><span class="content">
    The effect of multiple policies
  </span><a class="self-link" href="#multiple-policies"></a></h3>


    <p><em>This section is not normative.</em></p>


    <p>The above sections note that when multiple policies are present, each must be
  enforced or reported, according to its type. An example will help clarify how
  that ought to work in practice. The behavior of an <code>XMLHttpRequest</code>
  might seem unclear given a site that, for whatever reason, delivered the
  following HTTP headers:</p>

  
    <div class="example" id="example-ef0bfc7a"><a class="self-link" href="#example-ef0bfc7a"></a>
    
     <pre>Content-Security-Policy: default-src 'self' http://example.com http://example.net;
                         connect-src 'none';
Content-Security-Policy: connect-src http://example.com/;
                         script-src http://example.com/
</pre>
     
  
    </div>


    <p>Is a connection to example.com allowed or not? The short answer is that the
  connection is not allowed. Enforcing both policies means that a potential
  connection would have to pass through both unscathed. Even though the second
  policy would allow this connection, the first policy contains
  <code>connect-src 'none'</code>, so its enforcement blocks the connection. The
  impact is that adding additional policies to the list of policies to enforce
  can <em>only</em> further restrict the capabilities of the protected resource.</p>


    <p>To demonstrate that further, consider a script tag on this page. The first
  policy would lock scripts down to <code>'self'</code>,
  <code>http://example.com</code> and <code>http://example.net</code> via the
  <code>default-src</code> directive. The second, however, would only allow
  script from <code>http://example.com/</code>. Script will only load if it
  meets both policy’s criteria: in this case, the only origin that can match
  is <code>http://example.com</code>, as both policies allow it.</p>
</section>



   <section>
  
    <h2 class="heading settled" data-level="10" id="iana-considerations"><span class="secno">10. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>


    <p>The permanent message header field registry should be updated
  with the following registration: <a data-link-type="biblio" href="#biblio-rfc3864">[RFC3864]</a></p>

  
    <h3 class="heading settled" data-level="10.1" id="iana-csp"><span class="secno">10.1. </span><span class="content">
    Content-Security-Policy
  </span><a class="self-link" href="#iana-csp"></a></h3>

  
    <dl>
    
     <dt>Header field name
     
    
     <dd>Content-Security-Policy
     

    
     <dt>Applicable protocol
     
    
     <dd>http
     

    
     <dt>Status
     
    
     <dd>standard
     

    
     <dt>Author/Change controller
     
    
     <dd>W3C
     

    
     <dt>Specification document
     
    
     <dd>This specification (See <a href="#csp-header">§3.1.1 The Content-Security-Policy HTTP Response Header Field</a>)
     
  
    </dl>
</section>


   <section>
  
    <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>


    <p>Lots of people are awesome.</p>
</section>

</main>

  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>


  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>

    
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>

    
  <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    </p>
  <div class="example" id="example-f839f6c8"><a class="self-link" href="#example-f839f6c8"></a>
        
   <p>This is an example of an informative example.</p>
   
    
  </div>

    
  <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    </p>
  <p class="note" role="note">Note, this is an informative note.</p>


  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>

    
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>

    
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>


  <h3 class="no-ref no-num heading settled" id="conformance-classes"><span class="content">Conformance Classes</span><a class="self-link" href="#conformance-classes"></a></h3>

    
  <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conformant-user-agent">conformant user agent<a class="self-link" href="#conformant-user-agent"></a></dfn> must implement all the requirements
    listed in this specification that are applicable to user agents.</p>

    
  <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conformant-server">conformant server<a class="self-link" href="#conformant-server"></a></dfn> must implement all the requirements listed
    in this specification that are applicable to servers.</p>




  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li>applySecurityPolicy(policy)
    <ul>
     <li><a href="#dom-window-applysecuritypolicy">method for Window</a><span>, in §3.3.1</span>
     <li><a href="#dom-workerglobalscope-applysecuritypolicy">method for WorkerGlobalScope</a><span>, in §3.3.1</span>
    </ul>
   <li><a href="#grammardef-base64-value">base64-value</a><span>, in §4.1</span>
   <li><a href="#base_uri">base-uri</a><span>, in §6.2.1</span>
   <li><a href="#child_src">child-src</a><span>, in §6.1.1</span>
   <li><a href="#conformant-server">conformant server</a><span>, in §Unnumbered section</span>
   <li><a href="#conformant-user-agent">conformant user agent</a><span>, in §Unnumbered section</span>
   <li><a href="#connect_src">connect-src</a><span>, in §6.1.2</span>
   <li><a href="#content_security_policy">Content-Security-Policy</a><span>, in §3.1.1</span>
   <li><a href="#content_security_policy_report_only">Content-Security-Policy-Report-Only</a><span>, in §3.1.2</span>
   <li><a href="#default_src">default-src</a><span>, in §6.1.3</span>
   <li><a href="#directive">directive</a><span>, in §2</span>
   <li><a href="#dom-securitypolicydirective-directive-slot">[[directive]]</a><span>, in §3.3.3</span>
   <li><a href="#directive-list">directive list</a><span>, in §2</span>
   <li><a href="#enumdef-directivename">DirectiveName</a><span>, in §3.3.3</span>
   <li><a href="#grammardef-directive-name">directive-name</a><span>, in §4</span>
   <li><a href="#dom-securitypolicy-directives">directives</a><span>, in §3.3.2</span>
   <li><a href="#grammardef-directive-token">directive-token</a><span>, in §4</span>
   <li><a href="#grammardef-directive-value">directive-value</a><span>, in §4</span>
   <li><a href="#embedding-documents">embedding documents</a><span>, in §7.5.1</span>
   <li><a href="#enforced">enforced</a><span>, in §7.2</span>
   <li><a href="#enforced-content-security-policies">enforced Content Security Policies</a><span>, in §7.2</span>
   <li><a href="#enforced">enforcing</a><span>, in §7.2</span>
   <li><a href="#font_src">font-src</a><span>, in §6.1.4</span>
   <li><a href="#grammardef-hash-algorithm">hash-algorithm</a><span>, in §4.1</span>
   <li><a href="#grammardef-hash-source">hash-source</a><span>, in §4.1</span>
   <li><a href="#grammardef-host-char">host-char</a><span>, in §4.1</span>
   <li><a href="#grammardef-host-part">host-part</a><span>, in §4.1</span>
   <li><a href="#grammardef-host-source">host-source</a><span>, in §4.1</span>
   <li><a href="#img_src">img-src</a><span>, in §6.1.5</span>
   <li><a href="#inherits-content-security-policies">inherits Content Security Policies</a><span>, in §7.2</span>
   <li><a href="#grammardef-keyword-source">keyword-source</a><span>, in §4.1</span>
   <li><a href="#media_src">media-src</a><span>, in §6.1.6</span>
   <li><a href="#monitored">monitored</a><span>, in §7.2</span>
   <li><a href="#monitored-content-security-policies">monitored Content Security Policies</a><span>, in §7.2</span>
   <li><a href="#monitored">monitoring</a><span>, in §7.2</span>
   <li>name
    <ul>
     <li><a href="#name">dfn for directive</a><span>, in §2</span>
     <li><a href="#dom-securitypolicydirective-securitypolicydirective-name-value-name">argument for SecurityPolicyDirective/SecurityPolicyDirective(name, value)</a><span>, in §3.3.3</span>
     <li><a href="#dom-securitypolicydirective-name">attribute for SecurityPolicyDirective</a><span>, in §3.3.3</span>
     <li><a href="#dom-sourcelistdirective-sourcelistdirective-name-value-name">argument for SourceListDirective/SourceListDirective(name, value)</a><span>, in §3.3.4</span>
    </ul>
   <li>node
    <ul>
     <li><a href="#dom-securitypolicy-nodematches-node-node">argument for SecurityPolicy/nodeMatches(node)</a><span>, in §3.3.2</span>
     <li><a href="#dom-securitypolicydirective-nodematches-node-node">argument for SecurityPolicyDirective/nodeMatches(node)</a><span>, in §3.3.3</span>
     <li><a href="#dom-sourceexpression-nodematches-node-node">argument for SourceExpression/nodeMatches(node)</a><span>, in §3.3.5</span>
    </ul>
   <li>nodeMatches(node)
    <ul>
     <li><a href="#dom-securitypolicy-nodematches">method for SecurityPolicy</a><span>, in §3.3.2</span>
     <li><a href="#dom-securitypolicydirective-nodematches">method for SecurityPolicyDirective</a><span>, in §3.3.3</span>
     <li><a href="#dom-sourcelistdirective-nodematches">method for SourceListDirective</a><span>, in §3.3.4</span>
     <li><a href="#dom-sourceexpression-nodematches">method for SourceExpression</a><span>, in §3.3.5</span>
    </ul>
   <li>nonce
    <ul>
     <li><a href="#dom-htmlscriptelement-nonce">attribute for HTMLScriptElement</a><span>, in §4.1.1</span>
     <li><a href="#element-attrdef-script-nonce">element-attr for script</a><span>, in §4.1.1</span>
     <li><a href="#dom-htmlstyleelement-nonce">attribute for HTMLStyleElement</a><span>, in §4.1.1</span>
     <li><a href="#element-attrdef-style-nonce">element-attr for style</a><span>, in §4.1.1</span>
    </ul>
   <li><a href="#grammardef-nonce-source">nonce-source</a><span>, in §4.1</span>
   <li><a href="#grammardef-none">'none'</a><span>, in §4.1</span>
   <li><a href="#object_src">object-src</a><span>, in §6.1.7</span>
   <li><a href="#grammardef-path-part">path-part</a><span>, in §4.1</span>
   <li><a href="#policy">policies</a><span>, in §2</span>
   <li><a href="#dom-securitypolicy-policy-slot">[[policy]]</a><span>, in §3.3.2</span>
   <li>policy
    <ul>
     <li><a href="#policy">definition of</a><span>, in §2</span>
     <li><a href="#dom-window-applysecuritypolicy-policy-policy">argument for Window/applySecurityPolicy(policy)</a><span>, in §3.3.1</span>
     <li><a href="#dom-workerglobalscope-applysecuritypolicy-policy-policy">argument for WorkerGlobalScope/applySecurityPolicy(policy)</a><span>, in §3.3.1</span>
     <li><a href="#dom-securitypolicy-securitypolicy-policy-type-policy">argument for SecurityPolicy/SecurityPolicy(policy, type)</a><span>, in §3.3.2</span>
    </ul>
   <li><a href="#serialized-content-security-policy">policy string</a><span>, in §4</span>
   <li><a href="#grammardef-policy-token">policy-token</a><span>, in §4</span>
   <li><a href="#grammardef-port-part">port-part</a><span>, in §4.1</span>
   <li><a href="#dom-securitypolicy-reportingendpoint">reportingEndpoint</a><span>, in §3.3.2</span>
   <li><a href="#reports">reports</a><span>, in §6.3.2</span>
   <li><a href="#report_uri">report-uri</a><span>, in §6.3.1</span>
   <li>request
    <ul>
     <li><a href="#dom-securitypolicy-requestmatches-request-request">argument for SecurityPolicy/requestMatches(request)</a><span>, in §3.3.2</span>
     <li><a href="#dom-securitypolicydirective-requestmatches-request-request">argument for SecurityPolicyDirective/requestMatches(request)</a><span>, in §3.3.3</span>
    </ul>
   <li><a href="#request-directives">Request Directives</a><span>, in §6</span>
   <li>requestMatches(request)
    <ul>
     <li><a href="#dom-securitypolicy-requestmatches">method for SecurityPolicy</a><span>, in §3.3.2</span>
     <li><a href="#dom-securitypolicydirective-requestmatches">method for SecurityPolicyDirective</a><span>, in §3.3.3</span>
     <li><a href="#dom-sourcelistdirective-requestmatches">method for SourceListDirective</a><span>, in §3.3.4</span>
    </ul>
   <li><a href="#grammardef-scheme-part">scheme-part</a><span>, in §4.1</span>
   <li><a href="#grammardef-scheme-source">scheme-source</a><span>, in §4.1</span>
   <li><a href="#script_src">script-src</a><span>, in §6.1.8</span>
   <li><a href="#securitypolicy">SecurityPolicy</a><span>, in §3.3.2</span>
   <li><a href="#securitypolicydirective">SecurityPolicyDirective</a><span>, in §3.3.3</span>
   <li><a href="#dom-securitypolicydirective-securitypolicydirective">SecurityPolicyDirective(name, value)</a><span>, in §3.3.3</span>
   <li><a href="#dom-securitypolicy-securitypolicy">SecurityPolicy(policy, type)</a><span>, in §3.3.2</span>
   <li><a href="#enumdef-securitypolicytype">SecurityPolicyType</a><span>, in §3.3.2</span>
   <li><a href="#grammardef-self">'self'</a><span>, in §4.1</span>
   <li><a href="#serialized-content-security-policy">serialized Content Security Policy</a><span>, in §4</span>
   <li><a href="#sourceexpression">SourceExpression</a><span>, in §3.3.5</span>
   <li><a href="#source-expression">source expression</a><span>, in §4.1</span>
   <li><a href="#grammardef-source-expression">source-expression</a><span>, in §4.1</span>
   <li><a href="#dom-sourceexpression-sourceexpression">SourceExpression(value)</a><span>, in §3.3.5</span>
   <li><a href="#grammardef-source-list">source-list</a><span>, in §4.1</span>
   <li><a href="#source-list">source list</a><span>, in §4.1</span>
   <li><a href="#sourcelistdirective">SourceListDirective</a><span>, in §3.3.4</span>
   <li><a href="#source-list-directive">source list directive</a><span>, in §2</span>
   <li><a href="#dom-sourcelistdirective-sourcelistdirective">SourceListDirective(name, value)</a><span>, in §3.3.4</span>
   <li><a href="#dom-sourcelistdirective-sources">sources</a><span>, in §3.3.4</span>
   <li><a href="#style_src">style-src</a><span>, in §6.1.9</span>
   <li>type
    <ul>
     <li><a href="#type">dfn for policy</a><span>, in §2</span>
     <li><a href="#dom-securitypolicy-securitypolicy-policy-type-type">argument for SecurityPolicy/SecurityPolicy(policy, type)</a><span>, in §3.3.2</span>
     <li><a href="#dom-securitypolicy-type">attribute for SecurityPolicy</a><span>, in §3.3.2</span>
    </ul>
   <li><a href="#grammardef-unsafe-eval">'unsafe-eval'</a><span>, in §4.1</span>
   <li><a href="#grammardef-unsafe-inline">'unsafe-inline'</a><span>, in §4.1</span>
   <li><a href="#dom-sourceexpression-urlmatches-url-url">url</a><span>, in §3.3.5</span>
   <li><a href="#dom-sourceexpression-urlmatches">urlMatches(url)</a><span>, in §3.3.5</span>
   <li>value
    <ul>
     <li><a href="#value">dfn for directive</a><span>, in §2</span>
     <li><a href="#dom-securitypolicydirective-securitypolicydirective-name-value-value">argument for SecurityPolicyDirective/SecurityPolicyDirective(name, value)</a><span>, in §3.3.3</span>
     <li><a href="#dom-securitypolicydirective-value">attribute for SecurityPolicyDirective</a><span>, in §3.3.3</span>
     <li><a href="#dom-sourcelistdirective-sourcelistdirective-name-value-value">argument for SourceListDirective/SourceListDirective(name, value)</a><span>, in §3.3.4</span>
     <li><a href="#dom-sourceexpression-sourceexpression-value-value">argument for SourceExpression/SourceExpression(value)</a><span>, in §3.3.5</span>
     <li><a href="#dom-sourceexpression-value">attribute for SourceExpression</a><span>, in §3.3.5</span>
    </ul></ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li><a data-link-type="biblio" href="#biblio-dom">[dom]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/dom/#interface-node">Node</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-es2015">[ES2015]</a> defines the following terms:
    <ul>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-eval-x">eval()</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org/#request">Request</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a>
     <li><a href="https://fetch.spec.whatwg.org/#main-fetch">main fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header-parse">parse a header value</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request">request</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response">response</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-url">url</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker">run a worker</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-html5">[html5]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/html5/dom.html#document">Document</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#active-document">active document</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document">an iframe srcdoc document</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ascii case-insensitive match</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-base-element">base</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#browsing-context">browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content">content</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#create-a-document-object">create a document object</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#creator-document">creator document</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#settings-object">environment settings object</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-head-element">head</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings object</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element">link</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#browsing-context-nested-through">nested through</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#pragma-directives">pragma directives</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#reflect">reflect</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant settings object</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#responsible-browsing-context">responsible browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-srcdoc">srcdoc</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-rfc3986">[rfc3986]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-rfc5234">[rfc5234]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">alpha</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">digit</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">vchar</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">wsp</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-rfc7230">[RFC7230]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.3">bws</a>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.3">ows</a>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.3">rws</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-rfc7231">[RFC7231]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7231#section-3">representation</a>
     <li><a href="https://tools.ietf.org/html/rfc7231#section-3">resource representation</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-url">[URL]</a> defines the following terms:
    <ul>
     <li><a href="https://url.spec.whatwg.org/#url">URL</a>
     <li><a href="https://url.spec.whatwg.org/#local-scheme">local scheme</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-workers">[workers]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/workers/#worker">Worker</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/scripting.html#htmlscriptelement">HTMLScriptElement</a>
     <li><a href="https://html.spec.whatwg.org/multipage/semantics.html#htmlstyleelement">HTMLStyleElement</a>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#window">Window</a>
     <li><a href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-webidl">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="http://heycam.github.io/webidl/#idl-DOMString">DOMString</a>
    </ul></ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-es2015"><a class="self-link" href="#biblio-es2015"></a>[ES2015]
   <dd>Allen Wirfs-Brock. <a href="http://www.ecma-international.org/ecma-262/6.0/index.html">ECMAScript® 2015 Language Specification</a>. URL: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html">http://www.ecma-international.org/ecma-262/6.0/index.html</a>
   <dt id="biblio-fetch"><a class="self-link" href="#biblio-fetch"></a>[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-rfc3492"><a class="self-link" href="#biblio-rfc3492"></a>[RFC3492]
   <dd>Adam M. Costello. <a href="http://www.ietf.org/rfc/rfc3492.txt">Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)</a>. REC. URL: <a href="http://www.ietf.org/rfc/rfc3492.txt">http://www.ietf.org/rfc/rfc3492.txt</a>
   <dt id="biblio-rfc3864"><a class="self-link" href="#biblio-rfc3864"></a>[RFC3864]
   <dd>Graham Klyne; Mark Nottingham; Jeffrey C. Mogul. <a href="http://www.ietf.org/rfc/rfc3864.txt">Registration Procedures for Message Header Fields</a>. RFC. URL: <a href="http://www.ietf.org/rfc/rfc3864.txt">http://www.ietf.org/rfc/rfc3864.txt</a>
   <dt id="biblio-rfc7230"><a class="self-link" href="#biblio-rfc7230"></a>[RFC7230]
   <dd>Roy T. Fielding; Julian F. Reschke. <a href="http://www.ietf.org/rfc/rfc7230.txt">HTTP/1.1 Message Syntax and Routing</a>. RFC. URL: <a href="http://www.ietf.org/rfc/rfc7230.txt">http://www.ietf.org/rfc/rfc7230.txt</a>
   <dt id="biblio-rfc7231"><a class="self-link" href="#biblio-rfc7231"></a>[RFC7231]
   <dd>Roy T. Fielding; Julian F. Reschke. <a href="http://www.ietf.org/rfc/rfc7231.txt">HTTP/1.1 Semantics and Content</a>. RFC. URL: <a href="http://www.ietf.org/rfc/rfc7231.txt">http://www.ietf.org/rfc/rfc7231.txt</a>
   <dt id="biblio-url"><a class="self-link" href="#biblio-url"></a>[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/">URL</a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl"><a class="self-link" href="#biblio-webidl"></a>[WebIDL]
   <dd>Cameron McCormack. <a href="http://www.w3.org/TR/WebIDL/">Web IDL</a>. 19 April 2012. CR. URL: <a href="http://www.w3.org/TR/WebIDL/">http://www.w3.org/TR/WebIDL/</a>
   <dt id="biblio-dom"><a class="self-link" href="#biblio-dom"></a>[DOM]
   <dd>Anne van Kesteren; et al. <a href="http://www.w3.org/TR/dom/">W3C DOM4</a>. 18 June 2015. LCWD. URL: <a href="http://www.w3.org/TR/dom/">http://www.w3.org/TR/dom/</a>
   <dt id="biblio-html5"><a class="self-link" href="#biblio-html5"></a>[HTML5]
   <dd>Ian Hickson; et al. <a href="http://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc3986"><a class="self-link" href="#biblio-rfc3986"></a>[RFC3986]
   <dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>. January 2005. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc3986">https://tools.ietf.org/html/rfc3986</a>
   <dt id="biblio-rfc5234"><a class="self-link" href="#biblio-rfc5234"></a>[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-workers"><a class="self-link" href="#biblio-workers"></a>[WORKERS]
   <dd>Ian Hickson. <a href="http://www.w3.org/TR/workers/">Web Workers</a>. 1 May 2012. CR. URL: <a href="http://www.w3.org/TR/workers/">http://www.w3.org/TR/workers/</a></dl>
  <h3 class="no-num heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-xmlhttprequest"><a class="self-link" href="#biblio-xmlhttprequest"></a>[XMLHttpRequest]
   <dd>Anne van Kesteren; et al. <a href="http://www.w3.org/TR/XMLHttpRequest/">XMLHttpRequest Level 1</a>. 30 January 2014. WD. URL: <a href="http://www.w3.org/TR/XMLHttpRequest/">http://www.w3.org/TR/XMLHttpRequest/</a>
   <dt id="biblio-xslt"><a class="self-link" href="#biblio-xslt"></a>[XSLT]
   <dd>James Clark. <a href="http://www.w3.org/TR/xslt">XSL Transformations (XSLT) Version 1.0</a>. 16 November 1999. REC. URL: <a href="http://www.w3.org/TR/xslt">http://www.w3.org/TR/xslt</a></dl>
  <h2 class="no-num heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
  <pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/browsers.html#window">Window</a> {
  void <a class="idl-code" data-link-type="method" href="#dom-window-applysecuritypolicy">applySecurityPolicy</a>(<a data-link-type="idl-name" href="#securitypolicy">SecurityPolicy</a> <a href="#dom-window-applysecuritypolicy-policy-policy">policy</a>);
};

partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a> {
  void <a class="idl-code" data-link-type="method" href="#dom-workerglobalscope-applysecuritypolicy">applySecurityPolicy</a>(<a data-link-type="idl-name" href="#securitypolicy">SecurityPolicy</a> <a href="#dom-workerglobalscope-applysecuritypolicy-policy-policy">policy</a>);
};

enum <a href="#enumdef-securitypolicytype">SecurityPolicyType</a> {
  "enforce",
  "report-only"
};

[<a class="idl-code" data-link-type="constructor" href="#dom-securitypolicy-securitypolicy">Constructor</a>(DOMString <a href="#dom-securitypolicy-securitypolicy-policy-type-policy">policy</a>, <a data-link-type="idl-name" href="#enumdef-securitypolicytype">SecurityPolicyType</a> <a href="#dom-securitypolicy-securitypolicy-policy-type-type">type</a>), Exposed=(Window,Worker)]
interface <a href="#securitypolicy">SecurityPolicy</a> {
  boolean <a class="idl-code" data-link-type="method" href="#dom-securitypolicy-requestmatches">requestMatches</a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request">Request</a> <a href="#dom-securitypolicy-requestmatches-request-request">request</a>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-securitypolicy-nodematches">nodeMatches</a>(<a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#interface-node">Node</a> <a href="#dom-securitypolicy-nodematches-node-node">node</a>);
  
  readonly attribute FrozenArray&lt;<a data-link-type="idl-name" href="#securitypolicydirective">SecurityPolicyDirective</a>> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="FrozenArray<SecurityPolicyDirective> " href="#dom-securitypolicy-directives">directives</a>;
  readonly attribute <a data-link-type="idl-name" href="#enumdef-securitypolicytype">SecurityPolicyType</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="SecurityPolicyType " href="#dom-securitypolicy-type">type</a>;
  readonly attribute USVString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="USVString " href="#dom-securitypolicy-reportingendpoint">reportingEndpoint</a>;
};

enum <a href="#enumdef-directivename">DirectiveName</a> {
  "base-uri",
  "child-src",
  "connect-src",
  "default-src",
  "font-src",
  "form-action",
  "frame-ancestors",
  "img-src",
  "media-src",
  "object-src",
  "plugin-types",
  "report-uri",
  "reports",
  "sandbox",
  "script-src",
  "style-src"
};

[<a class="idl-code" data-link-type="constructor" href="#dom-securitypolicydirective-securitypolicydirective">Constructor</a>(DOMString <a href="#dom-securitypolicydirective-securitypolicydirective-name-value-name">name</a>, DOMString <a href="#dom-securitypolicydirective-securitypolicydirective-name-value-value">value</a>), Exposed=(Window,Worker)]
interface <a href="#securitypolicydirective">SecurityPolicyDirective</a> {
  boolean <a class="idl-code" data-link-type="method" href="#dom-securitypolicydirective-requestmatches">requestMatches</a>(<a data-link-type="idl-name" href="https://fetch.spec.whatwg.org/#request">Request</a> <a href="#dom-securitypolicydirective-requestmatches-request-request">request</a>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-securitypolicydirective-nodematches">nodeMatches</a>(<a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#interface-node">Node</a> <a href="#dom-securitypolicydirective-nodematches-node-node">node</a>);

  readonly attribute <a data-link-type="idl-name" href="#enumdef-directivename">DirectiveName</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DirectiveName " href="#dom-securitypolicydirective-name">name</a>;  
};

[<a class="idl-code" data-link-type="constructor" href="#dom-sourcelistdirective-sourcelistdirective">Constructor</a>(DOMString <a href="#dom-sourcelistdirective-sourcelistdirective-name-value-name">name</a>, DOMString <a href="#dom-sourcelistdirective-sourcelistdirective-name-value-value">value</a>), Exposed=(Window,Worker)]
interface <a href="#sourcelistdirective">SourceListDirective</a> : <a data-link-type="idl-name" href="#securitypolicydirective">SecurityPolicyDirective</a> {
  readonly attribute FrozenArray&lt;<a data-link-type="idl-name" href="#sourceexpression">SourceExpression</a>> <a data-readonly="" data-type="FrozenArray<SourceExpression> " href="#dom-sourcelistdirective-sources">sources</a>;
};

[<a href="#dom-sourceexpression-sourceexpression">Constructor</a>(DOMString <a href="#dom-sourceexpression-sourceexpression-value-value">value</a>), Exposed=(Window,Worker)]
interface <a href="#sourceexpression">SourceExpression</a> {
  boolean <a class="idl-code" data-link-type="method" href="#dom-sourceexpression-urlmatches">urlMatches</a>(USVString <a class="idl-code" data-link-type="argument" href="#dom-sourceexpression-urlmatches-url-url">url</a>);
  boolean <a class="idl-code" data-link-type="method" href="#dom-sourceexpression-nodematches">nodeMatches</a>(<a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#interface-node">Node</a> <a class="idl-code" data-link-type="argument" href="#dom-sourceexpression-nodematches-node-node">node</a>);

  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-sourceexpression-value">value</a>;
};

partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/scripting.html#htmlscriptelement">HTMLScriptElement</a> {
  attribute DOMString <a class="idl-code" data-link-type="attribute" data-type="DOMString " href="#dom-htmlscriptelement-nonce">nonce</a>;
};

partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/semantics.html#htmlstyleelement">HTMLStyleElement</a> {
  attribute DOMString <a class="idl-code" data-link-type="attribute" data-type="DOMString " href="#dom-htmlstyleelement-nonce">nonce</a>;
};

</pre>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> We should consider extending this to include
  auxiliary browsing contexts, not just nested browsing contexts. <a href="https://github.com/w3c/webappsec/issues/451">&lt;https://github.com/w3c/webappsec/issues/451></a><a href="#issue-e8e29878"> ↵ </a></div>
   <div class="issue"> Maybe this makes more sense as `window.csp.apply()`? Which would also
  allow `window.csp.enforced` and `window.csp.monitored` as sequences of
  <code class="idl"><a data-link-type="idl" href="#securitypolicy">SecurityPolicy</a></code> objects?<a href="#issue-2167e343"> ↵ </a></div>
   <div class="issue"> We should probably expand on this definition a bit.<a href="#issue-52c2483f"> ↵ </a></div>
   <div class="issue"> We should probably expand on this definition a bit.<a href="#issue-52c2483f0"> ↵ </a></div>
   <div class="issue"> Monkey patches gonna monkey patch. Talk to WHATWG / WICG.<a href="#issue-a9d190ea"> ↵ </a></div>
   <div class="issue"> Does this cover Service Workers?<a href="#issue-91583e37"> ↵ </a></div>
   <div class="issue"> Monkey-patching! Move this to HTML.<a href="#issue-4c471074"> ↵ </a></div>
   <div class="issue"> Wire all this up once the directives exist and the policy
          object is defined.<a href="#issue-edbe0d6a"> ↵ </a></div>
   <div class="issue"> Parse the request to determine which directive applies, find the
  relevant directive in the list, and call <a href="#match-url-to-source-list">§7.4.2 Does url match source list?</a>.<a href="#issue-db7807b9"> ↵ </a></div>
   <div class="issue"> This might need a bit of polishing.<a href="#issue-4ba1072f"> ↵ </a></div>
   <div class="issue"> Parse the node to determine which directive applies, find the
  relevant directive in the list, and call <a href="#match-node-to-source-list">§7.4.5 Does node match source list?</a>.<a href="#issue-f302c0a4"> ↵ </a></div>
   <div class="issue"> This might need a bit of polishing.<a href="#issue-4ba1072f0"> ↵ </a></div>
   <div class="issue"> I have no idea what to do here. Anne suggests
  monkey-patching <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker">run a worker</a>.<a href="#issue-aafbdf7d"> ↵ </a></div></div></body>
</html>