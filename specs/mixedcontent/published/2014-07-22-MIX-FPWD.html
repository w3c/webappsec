<!DOCTYPE html><html lang=en><head>
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
  <title>Mixed Content</title>
  <link href=default.css rel=stylesheet type=text/css>
  <link href=https://www.w3.org/StyleSheets/TR/W3C-WD rel=stylesheet type=text/css>
</head>
<body class=h-entry>
<div class=head>
  <p data-fill-with=logo><a class=logo href=http://www.w3.org/>
    <img alt=W3C height=48 src=https://www.w3.org/Icons/w3c_home width=72>
</a>
</p>
  <h1 class="p-name no-ref" id=title>Mixed Content</h1>
  <h2 class="no-num no-toc no-ref heading settled heading" id=subtitle><span class=content>W3C First Public Working Draft,
    <span class=dt-updated><span class=value-title title=20140722>22 July 2014</span></span></span></h2>
  <div data-fill-with=spec-metadata><dl>
	<dt>This version:
	<dd><a class=u-url href=http://www.w3.org/TR/2014/WD-mixed-content-20140722/>http://www.w3.org/TR/2014/WD-mixed-content-20140722/</a>
	<dt>Latest version:
	<dd><a class=u-url href=http://www.w3.org/TR/mixed-content/>http://www.w3.org/TR/mixed-content/</a>
	<dt>Editor’s Draft:
	<dd><a href=https://w3c.github.io/webappsec/specs/mixedcontent/>https://w3c.github.io/webappsec/specs/mixedcontent/</a>
	<dt>Version History:
	<dd><a href=https://github.com/w3c/webappsec/commits/master/specs/mixedcontent/index.src.html>https://github.com/w3c/webappsec/commits/master/specs/mixedcontent/index.src.html</a>
	<dt>Feedback:
	<dd><a href="mailto:public-webappsec@w3.org?subject=%5BMIX%5D%20feedback">public-webappsec@w3.org</a>
            with subject line
            “<kbd>[MIX] <var>… message topic …</var></kbd>”(<a href=http://lists.w3.org/Archives/Public/public-webappsec/ rel=discussion>archives</a>)
	<dt>Editor:
	<dd><dd class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:mkwst@google.com>Mike West</a> (<span class="p-org org">Google Inc.</span>)
</dl>
</div>
  <div data-fill-with=warning></div>
  <p class=copyright data-fill-with=copyright><a href=http://www.w3.org/Consortium/Legal/ipr-notice#Copyright>Copyright</a> © 2014
  <a href=http://www.w3.org/><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
  (<a href=http://www.csail.mit.edu/><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
  <a href=http://www.ercim.eu/><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
  <a href=http://www.keio.ac.jp/>Keio</a>, <a href=http://ev.buaa.edu.cn/>Beihang</a>),

  All Rights Reserved.

  <abbr title="World Wide Web Consortium">W3C</abbr> <a href=http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer>liability</a>,
  <a href=http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks>trademark</a> and

  <a href=http://www.w3.org/Consortium/Legal/copyright-documents>document use</a>
  rules apply.
</p>
  <hr title="Separator for header">
</div>

<h2 class="no-num no-toc no-ref heading settled heading" id=abstract><span class=content>Abstract</span></h2>
<div class=p-summary data-fill-with=abstract><p>This specification describes how and why user agents disallow rendering and execution of content loaded over unencrypted or unauthenticated connections in the context of an encrypted and authenticated document.</p>

</div>

<h2 class="no-num no-toc no-ref heading settled heading" id=status><span class=content>Status of this document</span></h2>
<div data-fill-with=status><p>
  <em>This section describes the status of this document at the time of
  its publication. Other documents may supersede this document. A list of
  current W3C publications and the latest revision of this technical report
  can be found in the <a href=http://www.w3.org/TR/>W3C technical reports
  index at http://www.w3.org/TR/.</a></em>

<p>
  This document was published by the
  <a href=http://www.w3.org/2011/webappsec/>Web Application Security Working Group</a>
  as a Working Draft. This document is intended to become a W3C Recommendation. 

<p>
	The (<a href=http://lists.w3.org/Archives/Public/public-webappsec/>archived</a>) public mailing list
	<a href="mailto:public-webappsec@w3.org?Subject=%5BMIX%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
	(see <a href=http://www.w3.org/Mail/Request>instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “MIX” in the subject,
	preferably like this:
	“[MIX] <em>…summary of comment…</em>”
  
<p>
  This document is a <strong>First Public Working Draft</strong>.

<p>
  Publication as a First Public Working Draft does not imply endorsement by the W3C
  Membership. This is a draft document and may be updated, replaced or
  obsoleted by other documents at any time. It is inappropriate to cite this
  document as other than work in progress.

<p>
	This document was produced by the
  <a href=http://www.w3.org/2011/webappsec/>Web Application Security Working Group</a>.

<p>
	This document was produced by a group operating under
	the <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/>5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href=http://www.w3.org/2004/01/pp-impl/49309/status rel=disclosure>public list of any patent disclosures</a>
	made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential>Essential Claim(s)</a>
	must disclose the information in accordance with <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure>section 6 of the W3C Patent Policy</a>.
</div>
<div data-fill-with=at-risk></div>

<h2 class="no-num no-toc no-ref heading settled heading" id=contents><span class=content>Table of Contents</span></h2>
<div data-fill-with=table-of-contents><ul class=toc>
	<li><a href=#intro><span class=secno>1</span> Introduction</a>
	<li><a href=#terms><span class=secno>2</span> Key Concepts and Terminology</a>
		<ul class=toc>
		<li><a href=#terms-defined-here><span class=secno>2.1</span> Terms defined by this specification</a>
		<li><a href=#terms-defined-by-reference><span class=secno>2.2</span> Terms defined by reference</a></ul>
	<li><a href=#categories><span class=secno>3</span> Categories of Content</a>
		<ul class=toc>
		<li><a href=#categories-active><span class=secno>3.1</span> Active Content</a>
		<li><a href=#categories-passive><span class=secno>3.2</span> Passive Content</a>
			<ul class=toc>
			<li><a href=#categories-passive-optionally-blockable><span class=secno>3.2.1</span>          Optionally-blockable Passive Content       </a>
			<li><a href=#categories-passive-blockable><span class=secno>3.2.2</span> Blockable Passive Content</a></ul>
		<li><a href=#categories-unknown-content><span class=secno>3.3</span> Future Contexts</a></ul>
	<li><a href=#requirements><span class=secno>4</span> User Agent Requirements</a>
		<ul class=toc>
		<li><a href=#requirements-fetching><span class=secno>4.1</span> Resource Fetching</a>
		<li><a href=#requirements-script><span class=secno>4.2</span> Script APIs</a>
		<li><a href=#requirements-ux><span class=secno>4.3</span> UI Requirements</a>
		<li><a href=#requirements-user-controls><span class=secno>4.4</span> User Controls</a></ul>
	<li><a href=#algorithms><span class=secno>5</span> Algorithms</a>
		<ul class=toc>
		<li><a href=#categorize-environment><span class=secno>5.1</span>        Is <var>environment</var> a secure context?     </a>
		<li><a href=#should-block-fetch><span class=secno>5.2</span>        Should fetching <var>request</var> be blocked as mixed content?     </a>
		<li><a href=#should-block-response><span class=secno>5.3</span>        Should <var>response</var> to <var>request</var> be blocked as mixed       content?     </a></ul>
	<li><a href=#fetch-integration><span class=secno>6</span> Integration with Fetch</a>
	<li><a href=#websockets-integration><span class=secno>7</span> Modifications to WebSockets</a>
	<li><a href=#acknowledgements><span class=secno>8</span> Acknowledgements</a>
	<li><a href=#conformance><span class=secno></span> Conformance</a>
		<ul class=toc>
		<li><a href=#conventions><span class=secno></span> Document conventions</a>
		<li><a href=#conformant-algorithms><span class=secno></span> Conformant Algorithms</a>
		<li><a href=#conformance-classes><span class=secno></span> Conformance Classes</a></ul>
	<li><a href=#references><span class=secno></span>  References</a>
		<ul class=toc>
		<li><a href=#normative><span class=secno></span>  Normative References</a>
		<li><a href=#informative><span class=secno></span>  Informative References</a></ul>
	<li><a href=#index><span class=secno></span>  Index</a>
	<li><a href=#issues-index><span class=secno></span> Issues Index</a></ul></div>





<section>
  <h2 class="heading settled heading" data-level=1 id=intro><span class=secno>1 </span><span class=content>Introduction</span><a class=self-link href=#intro></a></h2>

<p><em>This section is not normative.</em></p>

<p>When a user successfully loads a resource from example.com over a secure
  channel (HTTPS, for example), the user agent is able to make three assertions
  critical to the user’s security and privacy:</p>

  <ul>
    <li>
      The user is communicating with a server that is allowed to claim to be
      <code>example.com</code>, and not one of the many, many servers through
      which her request has hopped. The connection can be
      <strong>authenticated</strong>.
    </li>
    <li>
      The user’s communications with <code>example.com</code> cannot be
      trivially eavesdropped upon by middlemen, because the requests she makes
      and the responses she receives are <strong>encrypted</strong>.
    </li>
    <li>
      The user’s communications with <code>example.com</code> cannot be
      trivially modified by middlemen, the encryption and authentication
      provide a guarantee of <strong>data integrity</strong>.
    </li>
  </ul>

<p>Together, these assertions give the user some assurance that
  <code>example.com</code> is the only entity that can read and respond to her
  requests (caveat: without shocking amounts of work) and that the bits she’s
  receiving are indeed those that <code>example.com</code> actually sent.</p>

<p>The strength of these assertions is substantially weakened, however, when
  the encrypted and authenticated resource requests subresources (scripts,
  images, etc) over an insecure channel. Those resource requests result in a
  resource whose status is mixed, as insecure requests are wide open for
  man-in-the-middle attacks. This scenario is unfortunately quite common.</p>

<p>Regardless of <code>example.com</code>’s own privacy, users' privacy and
  security can be further impacted if a public resource can generate requests
  to private resources on a local network. For example, public resources must
  not be allowed to generate requests to a user’s router, or an enterprise’s
  internal file server.</p>

<p>This specification details how user agents can mitigate these risks to
  security and privacy by limiting a resource’s ability to inadvertently
  communicate in the clear, or to expose non-public resources to the web at
  large.</p>

<p class=note>Note: Nothing described in this document is really new; everything covered
  here has appeared in one or more user agents over the years: Internet Explorer
  led the way, alerting users to mixed active content since at least version 4.</p>
</section>


<section>
  <h2 class="heading settled heading" data-level=2 id=terms><span class=secno>2 </span><span class=content>Key Concepts and Terminology</span><a class=self-link href=#terms></a></h2>

  <h3 class="heading settled heading" data-level=2.1 id=terms-defined-here><span class=secno>2.1 </span><span class=content>Terms defined by this specification</span><a class=self-link href=#terms-defined-here></a></h3>
  <dl>
    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title=mixed id=mixed-content>mixed content<a class=self-link href=#mixed-content></a></dfn>
    </dt>
    <dd>
      A resource is said to be <strong>mixed content</strong> if either of the
      following conditions holds:

      <ul>
        <li>
          The resource’s <a data-link-type=dfn href=#origin title=origin>origin</a> is <a data-link-type=dfn href=#insecure-origin title=insecure>insecure</a>, <strong>and</strong>
          the <a data-link-type=dfn href=#javascript-global-environment title="javascript global environment">JavaScript global environment</a> into which it is loaded is a
          <a data-link-type=dfn href=#secure-context title="secure context">secure context</a>.
        </li>
        <li>
          The resource’s <a data-link-type=dfn href=#origin title=origin>origin</a> is <a data-link-type=dfn href=#private-origin title=private>private</a> <strong>and</strong>
          the <a data-link-type=dfn href=#origin title=origin>origin</a> of the <a data-link-type=dfn href=#javascript-global-environment title="javascript global environment">JavaScript global environment</a> into
          which it is loaded is <a data-link-type=dfn href=#public-origin title=public>public</a>.
        </li>
      </ul>

      <div class=example>
        The image <code>http://example.com/image.png</code> is <strong>mixed
        content</strong> when loaded by
        <code>https://not.example.com/</code>.

<p>The image <code>http://127.0.0.1/image.png</code> is <strong>mixed
        content</strong> when loaded by <code>http://example.com/</code>.</p>
      </div>
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title=private id=private-origin>private origin<a class=self-link href=#private-origin></a></dfn>
    </dt>
    <dd>
      An <a data-link-type=dfn href=#origin title=origin>origin</a> is considered a <strong>private origin</strong> if any
      of the following conditions holds:

      <ul>
        <li>
          The origin’s <code>scheme</code> component is <code>file</code>.
        </li>
        <li>
          The origin’s <code>host</code> component is <code>localhost</code>,
          or matches one of the CIDR notations <code>127.0.0.0/8</code> or
          <code>::1/128</code> <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc4632 title=biblio-rfc4632>[RFC4632]</a>
        </li>
        <li>
          The origin’s <code>host</code> component matches one of the
          <dfn data-dfn-type=dfn data-noexport="" id=private-address-space>private address space<a class=self-link href=#private-address-space></a></dfn> patterns defined in
          <a href=http://tools.ietf.org/html/rfc1918#section-3>Section 3 of
          RFC1918</a> (<code>10.0.0.0/8</code>, <code>172.16.0.0/12</code>,
          <code>192.168.0.0/16</code>) <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc1918 title=biblio-rfc1918>[RFC1918]</a>.
        </li>
        <li>
          The origin’s <code>host</code> component is an <dfn data-dfn-type=dfn data-noexport="" id=internal-name>Internal
          Name<a class=self-link href=#internal-name></a></dfn>, as defined by the CA/Browser Forum’s Baseline
          Requirements <a data-biblio-type=normative data-link-type=biblio href=#biblio-cab title=biblio-cab>[CAB]</a>.
        </li>
      </ul>
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title=public id=public-origin>public origin<a class=self-link href=#public-origin></a></dfn>
    </dt>
    <dd>
      Any <a data-link-type=dfn href=#origin title=origin>origin</a> which is not <a data-link-type=dfn href=#private-origin title=private>private</a> is said to be a
      <strong>public origin</strong>.
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title="potentially secure" id=potentially-secure-origin>
        potentially secure origin
      <a class=self-link href=#potentially-secure-origin></a></dfn>
    </dt>
    <dd>
      An <a data-link-type=dfn href=#origin title=origin>origin</a> is said to be <strong>potentially secure</strong>
      if one of the following is true:

      <ul>
        <li>
          The origin’s scheme component is <code>HTTPS</code>,
          <code>WSS</code>, or <code>about</code>.
        </li>
        <li>
          The origin is a <a data-link-type=dfn href=#globally-unique-identifier title="globally unique identifier">globally unique identifier</a> (for example,
          a <code>blob</code> URL).
        </li>
      </ul>

<p class=note>Note: The mixed content checks take place <em>after</em> Strict
      Transport Security is applied to resource URLs, which simplifies
      determination of insecurity. <a data-biblio-type=informative data-link-type=biblio href=#biblio-rfc6797 title=biblio-rfc6797>[RFC6797]</a></p>
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title="a priori insecure" id=a-priori-insecure-origin>
        <em>a priori</em> insecure origin
      <a class=self-link href=#a-priori-insecure-origin></a></dfn>
    </dt>
    <dd>
      Any <a data-link-type=dfn href=#origin title=origin>origin</a> which is not <a data-link-type=dfn href=#potentially-secure-origin title="potentially secure">potentially secure</a> is said to
      be <strong><em>a priori</em> insecure</strong>. We know, for example, that
      <code>http://example.com/</code> is insecure just by looking at its scheme
      component.
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title=insecure id=insecure-origin>
        insecure origin
      <a class=self-link href=#insecure-origin></a></dfn>
    </dt>
    <dd>
      An resource’s origin is said to be <strong>insecure</strong> if it is
      either <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure"><em>a priori</em> insecure</a>, or the user agent discovers
      only after performing a TLS-handshake that the TLS-protection offered
      is either <a data-link-type=dfn href=#weakly-tls-protected title=weak>weak</a> or <a data-link-type=dfn href=#deprecated-tls-protection title=deprecated>deprecated</a>.
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title=deprecated id=deprecated-tls-protection>
        deprecated TLS-protection
      <a class=self-link href=#deprecated-tls-protection></a></dfn>
    </dt>
    <dd>
      A resource’s TLS-protection is said to be <strong>deprecated</strong>
      if it is not <a data-link-type=dfn href=#weakly-tls-protected title="weakly tls-protected">weakly TLS-protected</a>, but the user agent chooses to
      refuse it anyway. This determination is vendor-specific.

<p>For example, a user agent may choose to reject resources for which the
      server presented a publicly-trusted certificate for an <a data-link-type=dfn href=#internal-name title="internal name">Internal
      Name</a> (e.g. <code>https://intranet/</code>), a certificate with an
      overly-long validity period, a certificate signed with SHA-1, or a
      certificate which otherwise fails to meet the
      <a href=https://cabforum.org/baseline-requirements-documents/>
      CA/Browser Forum’s Baseline Requirements</a>.</p>
    </dd>
  </dl>

  <h3 class="heading settled heading" data-level=2.2 id=terms-defined-by-reference><span class=secno>2.2 </span><span class=content>Terms defined by reference</span><a class=self-link href=#terms-defined-by-reference></a></h3>
  <dl>
    <dt><dfn data-dfn-type=dfn data-noexport="" id=tls-protected>TLS-protected<a class=self-link href=#tls-protected></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-local-title=weak data-noexport="" id=weakly-tls-protected>weakly TLS-protected<a class=self-link href=#weakly-tls-protected></a></dfn></dt>
    <dd>
      These terms are defined in
      <a href=http://www.w3.org/TR/2010/REC-wsc-ui-20100812/#typesoftls>§5.2
      of "Web Security Context: User Interface Guidelines"</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-wsc-ui title=biblio-wsc-ui>[WSC-UI]</a>.
      A resource is <strong>TLS-protected</strong> when it is delivered over an
      encrypted channel. <strong>Weakly TLS-protected</strong> refers to a
      subset of those resources delivered over a channel that doesn’t offer
      strong protection of the content.

<p>For example, resources would be considered weakly TLS-protected when
      delivered by a server presenting a self-signed certificate, as such a
      certificate only weakly authenticates the server. Similarly, a server
      which negotiates down to a weak cipher suite (such as
      <code>TLS_RSA_WITH_NULL_MD5</code>) would only weakly protect resources
      it serves.</p>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=origin>origin<a class=self-link href=#origin></a></dfn></dt>
    <dd>
      An origin defines the scope of authority or privilege under which a
      resource operates. It is defined in detail in the Origin specification.
      <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc6454 title=biblio-rfc6454>[RFC6454]</a>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=globally-unique-identifier>globally unique identifier<a class=self-link href=#globally-unique-identifier></a></dfn></dt>
    <dd>
      This term is defined in
      <a href=http://tools.ietf.org/html/rfc6454#section-4>Section 4 of
      RFC6454</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc6454 title=biblio-rfc6454>[RFC6454]</a>

<p class=note>Note: URLs that do not use
      <a href=http://tools.ietf.org/html/rfc3986#section-3.2>hierarchical
      elements</a> as naming authorities (for example: <code>blob:</code>, and
      <code>data:</code>) have origins which are globally unique identifiers.
      <a data-biblio-type=informative data-link-type=biblio href=#biblio-uri title=biblio-uri>[URI]</a></p>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=fetch>fetch<a class=self-link href=#fetch></a></dfn></dt>
    <dd>
      "fetching" is the process by which a user agent requests resources, and
      delivers responses. It is defined in detail in the Fetch living standard.
      <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=biblio-fetch>[FETCH]</a>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=request>request<a class=self-link href=#request></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-local-title=client data-noexport="" id=request-client>request client<a class=self-link href=#request-client></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-local-title=context data-noexport="" id=request-context>request context<a class=self-link href=#request-context></a></dfn></dt>
    <dd>
      These terms are defined in
      <a href=http://fetch.spec.whatwg.org/#requests>Section 2.2</a> of the
      Fetch living standard. <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=biblio-fetch>[FETCH]</a>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=response>response<a class=self-link href=#response></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-noexport="" id=network-error>network error<a class=self-link href=#network-error></a></dfn></dt>
    <dd>
      These terms are defined in detail in
      <a href=http://fetch.spec.whatwg.org/#responses>Section 2.3</a> of the
      Fetch living standard. <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=biblio-fetch>[FETCH]</a>
    </dd>

    <dt><dfn data-dfn-type=dfn data-local-title="global environment" data-noexport="" id=javascript-global-environment>JavaScript global environment<a class=self-link href=#javascript-global-environment></a></dfn></dt>
    <dd>
      This term is defined in
      <a href=http://www.w3.org/TR/html5/infrastructure.html#javascript-global-environment>Section
      2.2.2 of the HTML5 specification</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=biblio-html5>[HTML5]</a>
    </dd>
  </dl>
</section>


<section>
  <h2 class="heading settled heading" data-level=3 id=categories><span class=secno>3 </span><span class=content>Categories of Content</span><a class=self-link href=#categories></a></h2>

<p>Categories of content are defined informally directly below. Note that the
  lists in the following three sections attempt to be comprehensive, but the
  platform is huge: in practice, user agents will determine a resource’s
  category based on it’s <a data-link-type=dfn href=#request-context title="request context">request context</a>, which is much simpler to
  exhaustively define.</p>

<p>Fetch defines three <a data-link-type=dfn href=#request-context title="request contexts">request contexts</a> that do not map directly to
  resources which are included in a <a data-link-type=dfn href=#javascript-global-environment title="global environment">global environment</a>:<code>form</code>,
  <code>navigate</code>, and <code>popup</code>. These contexts are
  <dfn data-dfn-type=dfn data-export="" id=navigational-request-contexts>navigational request contexts<a class=self-link href=#navigational-request-contexts></a></dfn>, and cover navigations between
  pages, not content. User agents MAY treat one or more of these contexts as
  either <a data-link-type=dfn href=#active-content title=active>active</a> or <a data-link-type=dfn href=#blockable-passive-content title="blockable passive">blockable passive</a> content if they choose to do
  so: there are reasonable arguments for restricting mixed form submissions, for
  example.</p>

  <section>
    <h3 class="heading settled heading" data-level=3.1 id=categories-active><span class=secno>3.1 </span><span class=content>Active Content</span><a class=self-link href=#categories-active></a></h3>

<p><dfn data-dfn-type=dfn data-export="" id=active-content title="active content|active">Active content<a class=self-link href=#active-content></a></dfn> is content
    which can in some way directly manipulate the resource with which a user
    is interacting. Script and style are the clearest examples: if an attacker
    can manipulate either, she can completely control the activity on a webpage
    and exfiltrate data at will. Active content include the following resource
    types:</p>

    <ul>
      <li>
        Scripts (loaded, for example, via <a data-link-type=element href=http://www.w3.org/TR/html5/scripting-1.html#script title=script>script</a> elements, as
        well as scripts loaded as Workers and SharedWorkers <a data-biblio-type=normative data-link-type=biblio href=#biblio-workers title=biblio-workers>[WORKERS]</a>, or
        ServiceWorkers <a data-biblio-type=normative data-link-type=biblio href=#biblio-serviceworkers title=biblio-serviceworkers>[SERVICEWORKERS]</a>) <a data-biblio-type=normative data-link-type=biblio href=#biblio-ecma-262 title=biblio-ecma-262>[ECMA-262]</a>
      </li>
      <li>Stylesheets <a data-biblio-type=normative data-link-type=biblio href=#biblio-css21 title=biblio-css21>[CSS21]</a></li>
      <li>
        <a data-link-type=dfn href=http://www.w3.org/TR/html5/infrastructure.html#plugin title=plugin>Plugin</a> data (loaded, for example, through
        <a data-link-type=element href=http://www.w3.org/TR/html5/obsolete.html#the-applet-element title=applet>applet</a>, <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element title=embed>embed</a>, or <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element title=object>object</a>
        elements; or through a <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#plugin-document title="plugin document">plugin document</a> loaded into an
        <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element title=iframe>iframe</a> or <a data-link-type=dfn href=http://www.w3.org/TR/html5/obsolete.html#frame title=frame>frame</a> element) <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=biblio-html5>[HTML5]</a>
      </li>
      <li>SVG Documents <a data-biblio-type=normative data-link-type=biblio href=#biblio-svg2 title=biblio-svg2>[SVG2]</a></li>
      <li>XSL Transformations <a data-biblio-type=normative data-link-type=biblio href=#biblio-xslt title=biblio-xslt>[XSLT]</a></li>
      <li>HTML Imports <a data-biblio-type=normative data-link-type=biblio href=#biblio-html-imports title=biblio-html-imports>[HTML-IMPORTS]</a></li>
      <li>HTML Manifests <a data-biblio-type=normative data-link-type=biblio href=#biblio-manifest title=biblio-manifest>[MANIFEST]</a></li>
      <li>Documents rendered in <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element title=iframe>iframe</a> elements</li>
    </ul>

<p>These resource types map to the following Fetch <a data-link-type=dfn href=#request-context title="request contexts">request contexts</a>:
    <code>script</code>, <code>worker</code>, <code>sharedworker</code>,
    <code>serviceworker</code>, <code>style</code>, <code>object</code>,
    <code>manifest</code> and <code>child</code>. These contexts are
    <dfn data-dfn-type=dfn data-export="" id=active-request-contexts>active request contexts<a class=self-link href=#active-request-contexts></a></dfn>.</p>

<p>The contents of an <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element title=iframe>iframe</a> are considered active content
    because same-origin frames can reach up into their <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#parent-browsing-context title="parent browsing context">parent browsing
    context</a> via script, and even cross-origin frames can initiate
    top-level navigations. User agents MAY decide to treat cross-origin
    frames as <a data-link-type=dfn href=#passive-content title=passive>passive</a> content if that capability is removed by applying
    a appropriate <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#sandboxing-flag-set title="sandboxing flag set">sandboxing flag set</a> (e.g. one which does not include
    the <a data-link-type=element-attr href=http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-top-navigation title=allow-top-navigation>allow-top-navigation</a> flag).</p>

<p class=note>Note: <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element title=iframe>iframe</a> elements, as currently implemented in user
    agents do come with risks beyond those mentioned above. For example,
    <a href=http://lcamtuf.blogspot.de/2012/05/yes-you-can-have-fun-with-downloads.html>a
    downloaded file’s origin is often difficult to pinpoint</a>, HTTP
    authentication prompts are sometimes allowed (after a HTTP 401 response,
    for instance), and modal prompts like <code>window.prompt()</code> can
    confuse users. These risks exist even with secure iframes, but attackers
    can more easily inject malicious code into innocent but insecure iframes.</p>

<p class=issue id=issue-967b8a81><a class=self-link href=#issue-967b8a81></a>Should form submissions to an insecure origin be considered active
    content? I suspect they should, though I’m not sure we can get away with
    it in a web-compatible way.</p>
  </section>

  <section>
    <h3 class="heading settled heading" data-level=3.2 id=categories-passive><span class=secno>3.2 </span><span class=content>Passive Content</span><a class=self-link href=#categories-passive></a></h3>

<p><dfn data-dfn-type=dfn data-export="" id=passive-content title="passive content|passive">Passive content<a class=self-link href=#passive-content></a></dfn> includes
    resources which cannot directly interact with or modify other resources on
    a page: images, fonts, audio, and video for example. The risk of rendering a
    manipulated passive resource is significantly lower than executing an
    <a data-link-type=dfn href=#active-content title=active>active</a> resource; passive content can confuse or deceive users, but
    cannot directly manipulate other resources on a page or exfiltrate data.</p>

<p><a data-link-type=dfn href=#active-content title="active content">Active content</a> is clearly dangerous in a <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a> context, and
    must be blocked from executing in those contexts to protect both users and
    site authors, regardless of the risk of breaking insecurely composed
    websites. Passive <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a> content is less directly dangerous to
    users: if an attacker manipulates an image resource, the worst case is that
    the attacker-controlled image is displayed to the user rather than the image
    a site’s author intended.</p>

<p>In a perfect world, user agents would be required to block <em>all</em>
    types of <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a>. Unfortunately, there exists a massive amount
    of passive <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> on the Internet today:
    <a href=http://www.securitee.org/files/mixedinc_isc2013.pdf>according to a
    survey in 2013</a> blocking passive mixed content would break around ~43% of
    secure websites in one way or another. Draconian blocking policies applied to
    passive mixed content are (for the moment) infeasible. User agents must be
    more nuanced in their restrictions.</p>

<p>With that in mind, we’ll split passive content into two categories:
    resources user agents can safely block without breaking the web, and
    resources whose usage in <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a> contexts is simply too high to block
    by default.</p>

<p>Future versions of this specification will update these subcategories with
    the intent of moving towards a world where all <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a> content is
    blocked; that is the end goal, but this is the best we can do for now.</p>

<p class=issue id=issue-8a84ed46><a class=self-link href=#issue-8a84ed46></a>Should the presence of a form with an <a data-link-type=element-attr href=http://www.w3.org/TR/html5/forms.html#attr-fs-action title=action>action</a>
    attribute representing an <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origin"><em>a priori</em> insecure origin</a> be
    considered passive mixed content?</p>

    <section>
      <h4 class="heading settled heading" data-level=3.2.1 id=categories-passive-optionally-blockable><span class=secno>3.2.1 </span><span class=content>
        Optionally-blockable Passive Content
      </span><a class=self-link href=#categories-passive-optionally-blockable></a></h4>

<p>Passive content is
      <dfn data-dfn-type=dfn data-export="" id=optionally-blockable-passive-content title="optionally blockable passive content|optionally blockable passive|optionally blockable">
      optionally blockable<a class=self-link href=#optionally-blockable-passive-content></a></dfn> when the risk of allowing its usage in a <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a>
      context is outweighed by the risk of breaking significant portions of the
      web. This may be because usage of these resource types in <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a>
      contexts is sufficiently high, or because the feature is very clearly
      low-risk in and of itself.</p>

<p>This category includes:</p>

      <ul>
        <li>
          Images loaded via <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element title=img>img</a> or <code>picture</code>

<p class=note>Note: This includes SVG documents loaded as images.</p>
        </li>
        <li>
          Video loaded via <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#video title=video>video</a> and <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element title=source>source</a>
          elements
        </li>
        <li>
          Audio loaded via <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#audio title=audio>audio</a> and <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element title=source>source</a>
          elements
        </li>
        <li>
          <a href=http://www.w3.org/TR/html5/links.html#link-type-prefetch>Prefetched</a>
          content
        </li>
      </ul>

<p>These resource types map to the following Fetch <a data-link-type=dfn href=#request-context title="request contexts">request contexts</a>:
      <code>image</code>, <code>media</code>, and <code>prefetch</code>. These
      contexts are <dfn data-dfn-type=dfn data-export="" id=optionally-blockable-passive-request-contexts>optionally blockable passive request
      contexts<a class=self-link href=#optionally-blockable-passive-request-contexts></a></dfn>.</p>

<p class=note>Note: The fact that these resource types are on the "optionally blockable"
      list does not mean that they are <em>safe</em>, simply that they’re less
      catastrophically dangerous as the resource types on the "active" list.
      For example, images and icons are often the central UI elements in an
      application’s interface. If an attacker reversed the "Delete email"
      and "Reply" icons, there would be real impact on users.</p>
    </section>

    <section>
      <h4 class="heading settled heading" data-level=3.2.2 id=categories-passive-blockable><span class=secno>3.2.2 </span><span class=content>Blockable Passive Content</span><a class=self-link href=#categories-passive-blockable></a></h4>

<p>Passive content is
      <dfn data-dfn-type=dfn data-export="" id=blockable-passive-content title="blockable passive content|blockable passive|blockable">
      blockable<a class=self-link href=#blockable-passive-content></a></dfn> when the risk of allowing its usage in a <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a>
      context outweighs the risk of temporary inconvenience for those site
      authors delivering insecurely composed pages. This may be because usage
      of these features in <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a> contexts is sufficiently low, or
      because the content is close to the boundary between <a data-link-type=dfn href=#active-content title=active>active</a> and
      <a data-link-type=dfn href=#passive-content title=passive>passive</a>.</p>

<p>This category includes all content that is not <a data-link-type=dfn href=#optionally-blockable-passive-content title="optionally blockable">optionally blockable</a>
      or <a data-link-type=dfn href=#active-content title=active>active</a>. For example:</p>

      <ul>
        <li>
          Beacon <a data-biblio-type=normative data-link-type=biblio href=#biblio-beacon title=biblio-beacon>[BEACON]</a>
        </li>
        <li>Custom Filters <a data-biblio-type=normative data-link-type=biblio href=#biblio-filter-effects title=biblio-filter-effects>[FILTER-EFFECTS]</a></li>
        <li>
          Data (loaded, for example, via XMLHttpRequest <a data-biblio-type=normative data-link-type=biblio href=#biblio-xmlhttprequest title=biblio-xmlhttprequest>[XMLHTTPREQUEST]</a>,
          EventSource <a data-biblio-type=normative data-link-type=biblio href=#biblio-eventsource title=biblio-eventsource>[EVENTSOURCE]</a>, or WebSockets <a data-biblio-type=normative data-link-type=biblio href=#biblio-websockets title=biblio-websockets>[WEBSOCKETS]</a>)
        </li>
        <li>
          <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#hyperlink-auditing>hyperlink auditing pings</a>
        </li>
        <li>
          Resources which are not rendered directly in the browser, but
          downloaded to a user’s storage device (either as a result of a
          <a data-link-type=element-attr href=http://www.w3.org/TR/html5/links.html#attr-hyperlink-download title=download>download</a> attribute, or
          <code>Content-Disposition</code> headers)
        </li>
        <li>
          Subtitles and captions loaded via <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-track-element title=track>track</a> elements
        </li>
        <li>Web Fonts <a data-biblio-type=normative data-link-type=biblio href=#biblio-css3-webfonts title=biblio-css3-webfonts>[CSS3-WEBFONTS]</a></li>
      </ul>

      <div class=note>
        Note: In particular, this category includes data loaded via
        <code>XMLHttpRequest</code>, <code>EventSource</code>, or
        <code>WebSockets</code>. While these communication mechanism are
        <em>technically</em> passive, developers very often use them to gather
        data that affects program control flow. Consider a missile silo UI
        that grabs JSON to determine whether to reveal the Big Red Launch Button:

        <pre>{
  showLaunchButton: false
}
</pre>

<p>Or the ever-popular:</p>

        <pre>document.write("&lt;script&gt;" + xhr.responseText + "&lt;/script&gt;");
</pre>
      </div>

<p>These resource types map to the following Fetch <a data-link-type=dfn href=#request-context title="request contexts">request contexts</a>:
      <code>connect</code>, <code>download</code>, <code>ping</code>, and
      <code>font</code>. These contexts are <dfn data-dfn-type=dfn data-export="" id=blockable-passive-request-contexts>blockable passive
      request contexts<a class=self-link href=#blockable-passive-request-contexts></a></dfn>.</p>
    </section>
  </section>
  <section>
    <h3 class="heading settled heading" data-level=3.3 id=categories-unknown-content><span class=secno>3.3 </span><span class=content>Future Contexts</span><a class=self-link href=#categories-unknown-content></a></h3>

<p>This document exhaustively categorizes the <a data-link-type=dfn href=#request-context title="request contexts">request contexts</a> currently
    defined in the Fetch specification. It is the intention of the Working Group
    that any new content types defined in the future be prevented from loading
    as <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a>. To that end, any <a data-link-type=dfn href=#request-context title="request context">request context</a> which is
    not explicitly listed in the preceeding content categories MUST be
    considered an <a data-link-type=dfn href=#active-request-contexts title="active request context">active request context</a> when determining whether or not
    a request should be blocked as mixed content.</p>
  </section>
</section>


<section>
  <h2 class="heading settled heading" data-level=4 id=requirements><span class=secno>4 </span><span class=content>User Agent Requirements</span><a class=self-link href=#requirements></a></h2>

  <section>
    <h3 class="heading settled heading" data-level=4.1 id=requirements-fetching><span class=secno>4.1 </span><span class=content>Resource Fetching</span><a class=self-link href=#requirements-fetching></a></h3>

<p>User agents SHOULD reject <a data-link-type=dfn href=#weakly-tls-protected title="weakly tls-protected">weakly TLS-protected</a> resources entirely
    by failing the TLS handshake, or by requiring explicit user acceptance
    of the risk (for instance, presenting the user with a confirmation screen
    she must click through).</p>

<p>If a <a data-link-type=dfn href=#javascript-global-environment title="global environment">global environment</a> is a <a data-link-type=dfn href=#secure-context title="secure context">secure context</a>, then user agents
    MUST adhere to the following requirements when <a data-link-type=dfn href=#fetch title=fetching>fetching</a> resources in
    response to its requests (including not only requests for a
    <a class=idl-code data-link-type=interface href=http://www.w3.org/TR/html5/infrastructure.html#dom-document title=document>Document</a>’s subresources, but also requests made from
    Workers, SharedWorkers, ServiceWorkers and so on):</p>

    <ol>
      <li>
        <a data-link-type=dfn href=#request title=requests>Requests</a> for <a data-link-type=dfn href=#active-content title=active>active</a> resources and <a data-link-type=dfn href=#blockable-passive-content title="blockable passive">blockable passive</a>
        resources from an <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origin"><em>a priori</em> insecure origin</a> MUST not
        generate network traffic, and MUST instead return a synthetically
        generated <a data-link-type=dfn href=#network-error title="network error">network error</a> response.
      </li>

      <li>
        <a data-link-type=dfn href=#response title=responses>Responses</a> to <a data-link-type=dfn href=#request title=requests>requests</a> for <a data-link-type=dfn href=#active-content title=active>active</a> resources and
        <a data-link-type=dfn href=#blockable-passive-content title="blockable passive">blockable passive</a> resources from an <a data-link-type=dfn href=#insecure-origin title="insecure origin">insecure origin</a> MUST
        not be delivered to the requesting <a data-link-type=dfn href=#javascript-global-environment title="global environment">global environment</a>, but
        instead MUST return a synthetically generated <a data-link-type=dfn href=#network-error title="network error">network error</a>
        response.
      </li>

      <li>
        <a data-link-type=dfn href=#request title=requests>Requests</a> for <a data-link-type=dfn href=#optionally-blockable-passive-content title="optionally blockable passive">optionally blockable passive</a> resources which
        are <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> SHOULD be treated as <a data-link-type=dfn href=#active-content title=active>active</a> (and
        therefore returned as a <a data-link-type=dfn href=#network-error title="network error">network error</a> as described above).

<p class=note>Note: For instance, a user agent could interpret the presence of a
        <code>Strict-Transport-Security</code> header field as forcing all
        content into the <a data-link-type=dfn href=#active-content title=active>active</a> category. <a data-biblio-type=informative data-link-type=biblio href=#biblio-rfc6797 title=biblio-rfc6797>[RFC6797]</a></p>
      </li>

      <li>
        <a data-link-type=dfn href=#request title=requests>Requests</a> for <a data-link-type=dfn href=#optionally-blockable-passive-content title="optionally blockable passive">optionally blockable passive</a> resources which
        are <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a>, but which are <strong>not</strong> treated
        as <a data-link-type=dfn href=#active-content title="active content">active content</a> MAY be modified to reduce the risk to users.
        For example, cookies and other authentication tokens could be stripped
        from the requests, or the user agent could automatically change the
        protocol of the requested URL to <code>HTTPS</code> in certain cases.
      </li>
    </ol>

<p>If a <a data-link-type=dfn href=#javascript-global-environment title="global environment">global environment</a>’s origin is a <a data-link-type=dfn href=#public-origin title="public origin">public origin</a>, then user
    agents MUST adhere to the following requirements when <a data-link-type=dfn href=#fetch title=fetching>fetching</a>
    resources in response to the environment’s requests:</p>

    <ol>
      <li>
        <a data-link-type=dfn href=#request title=requests>Requests</a> to <a data-link-type=dfn href=#private-origin title="private origins">private origins</a> from <a data-link-type=dfn href=#public-origin title="public origins">public origins</a>
        MUST not generate network traffic (including traffic on loopback
        interfaces), and MUST instead return a synthetically generated
        <a data-link-type=dfn href=#network-error title="network error">network error</a> response.
      </li>
    </ol>

<p><a data-section="" href=#fetch-integration>§6 Integration with Fetch</a> and
    <a data-section="" href=#algorithms>§5 Algorithms</a> detail how these fetching
    requirements could be implemented.</p>
  </section>

  <section>
    <h3 class="heading settled heading" data-level=4.2 id=requirements-script><span class=secno>4.2 </span><span class=content>Script APIs</span><a class=self-link href=#requirements-script></a></h3>

<p>If a <a data-link-type=dfn href=#javascript-global-environment title="global environment">global environment</a> is a <a data-link-type=dfn href=#secure-context title="secure context">secure context</a>, then user agents
    MUST adhere to the following requirements when executing the following APIs:</p>

    <ol>
      <li>When processing XMLHttpRequest’s
      <a href=http://www.w3.org/TR/XMLHttpRequest2/#the-open-method><code>open()</code>
      method</a>, throw a <code>SecurityError</code> exception and terminate the
      method’s execution if the <var>request URL</var> provided points to an
      <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origin"><em>a priori</em> insecure origin</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-xmlhttprequest title=biblio-xmlhttprequest>[XMLHTTPREQUEST]</a></li>

      <li>When processing EventSource’s
      <a href=http://www.w3.org/TR/eventsource/#the-eventsource-interface>constructor</a>,
      throw a <code>SecurityError</code> exception and terminate the constructor’s
      execution if the <var>url</var> provided points to an <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origin"><em>a priori</em>
      insecure origin</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-eventsource title=biblio-eventsource>[EVENTSOURCE]</a></li>

      <li>When processing WebSocket’s
      <a href=http://www.w3.org/TR/websockets/#the-websocket-interface>constructor</a>,
      throw a <code>SecurityError</code> exception and terminate the constructor’s
      execution if the <var>url</var> provided points to an <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origin"><em>a priori</em>
      insecure origin</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-websockets title=biblio-websockets>[WEBSOCKETS]</a></li>
    </ol>
  </section>

  <section>
    <h3 class="heading settled heading" data-level=4.3 id=requirements-ux><span class=secno>4.3 </span><span class=content>UI Requirements</span><a class=self-link href=#requirements-ux></a></h3>

<p>If a <a data-link-type=dfn href=#request title=request>request</a> for <a data-link-type=dfn href=#optionally-blockable-passive-content title="optionally blockable passive">optionally blockable passive</a> resources
    which are <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> is <strong>not</strong> treated as <a data-link-type=dfn href=#active-content title="active content">active
    content</a> (per requirement #3 above), then the user agent MUST NOT provide
    the user with a visible indication that the <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing
    context</a> which loaded that resource is secure (for instance, via a green
    lock icon). The user agent SHOULD instead display a visible indication that
    <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> is present.</p>

<p>This requirement explicitly includes any visible indication of the
    <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing context</a>’s
    <a href=https://cabforum.org/about-ev-ssl/>EV status</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-cab title=biblio-cab>[CAB]</a></p>
  </section>

  <section>
    <h3 class="heading settled heading" data-level=4.4 id=requirements-user-controls><span class=secno>4.4 </span><span class=content>User Controls</span><a class=self-link href=#requirements-user-controls></a></h3>

<p>User agents MAY offer users the ability to directly decide whether or not to
    treat <strong>all</strong> <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> as <a data-link-type=dfn href=#active-content title=active>active</a> (meaning
    that even <a data-link-type=dfn href=#optionally-blockable-passive-content title="optionally blockable passive content">optionally blockable passive content</a> would be blocked in a
    mixed context).</p>

<p class=note>Note: It is <em>strongly recommended</em> that users take advantage of such
    an option if provided.</p>

<p>User agents MAY offer users the ability to override its decision to block
    <a data-link-type=dfn href=#blockable-passive-content title="blockable passive">blockable passive</a> mixed content on a particular page.</p>

<p>User agents MAY also offer users the ability to override its decision to
    block <a data-link-type=dfn href=#active-content title=active>active</a> mixed content on a page.</p>

<p class=note>Note: Practically, user agents probably can’t get away with not offering
    such a back door. That said, allowing active mixed content is in
    particular a very dangerous option, and user agents
    <a href=http://tools.ietf.org/html/rfc6919#section-3>REALLY SHOULD
    NOT</a> present such a choice to users without careful consideration and
    communication of the risk involved.</p>
  </section>
</section>


<section>
  <h2 class="heading settled heading" data-level=5 id=algorithms><span class=secno>5 </span><span class=content>Algorithms</span><a class=self-link href=#algorithms></a></h2>

  <section>
    <h3 class="heading settled heading" data-level=5.1 id=categorize-environment><span class=secno>5.1 </span><span class=content>
      Is <var>environment</var> a secure context?
    </span><a class=self-link href=#categorize-environment></a></h3>

<p>Given a <a data-link-type=dfn href=#javascript-global-environment title="javascript global environment">JavaScript global environment</a> <var>environment</var>, the
    user agent determines whether <var>environment</var> is a
    <dfn data-dfn-type=dfn data-export="" id=secure-context>secure context<a class=self-link href=#secure-context></a></dfn> via the following algorithm, which returns
    <strong>true</strong> if <var>environment</var> is a secure context, and
    <strong>false</strong> otherwise.</p>

    <ol>
      <li>
        If <var>environment</var> is <a data-link-type=dfn href=#tls-protected title=tls-protected>TLS-protected</a>, return
        <strong>true</strong>.
      </li>
      <li>
        If <var>environment</var> is a <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#nested-browsing-context title="nested browsing context">nested browsing context</a>, then:

        <ol>
          <li>Let <var>ancestorList</var> be the list of all
          <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#ancestor-browsing-context title=ancestors>ancestors</a> of <var>environment</var>’s <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#browsing-context title="browsing context">browsing
          context</a>.</li>

          <li>
            For each <var>ancestorContext</var> in <var>ancestorList</var>:

            <ol>
              <li>Let <var>ancestorEnvironment</var> be the <a data-link-type=dfn href=#javascript-global-environment title="javascript global environment">JavaScript
              global environment</a> associated with
              <var>ancestorContext</var></li>

              <li>If <var>ancestorEnvironment</var> is <a data-link-type=dfn href=#tls-protected title=tls-protected>TLS-protected</a>,
              return <strong>true</strong>.</li>
            </ol>
          </li>
        </ol>
      </li>

      <li>Return <strong>false</strong>.</li>
    </ol>

    <div class=note>
      If a document is a <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#nested-browsing-context title="nested browsing context">nested browsing context</a>, user agents need to
      check not only the document itself, but also the <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing
      context</a> in which the document is nested, as that is the context
      which controls the user’s expectations regarding the security status of
      the resource she’s loaded. For example:

      <div class=example>
        <code>http://a.com</code> loads <code>http://evil.com</code>. The
        insecure request will be allowed, as <code>a.com</code> was not loaded
        over a secure connection.
      </div>

      <div class=example>
        <code>https://a.com</code> loads <code>http://evil.com</code>. The
        insecure request will be blocked, as <code>a.com</code> was loaded over
        a secure connection.
      </div>

      <div class=example>
        <code>http://a.com</code> frames <code>https://b.com</code>, which
        loads <code>http://evil.com</code>. In this case, the insecure request
        to <code>evil.com</code> will be blocked, as <code>b.com</code> was
        loaded over a secure connection, even though <code>a.com</code> was not.
      </div>

      <div class=example>
        <code>https://a.com</code> frames a <code>data:</code> URL, which loads
        <code>http://evil.com</code>. In this case, the insecure request to
        <code>evil.com</code> will be blocked, as <code>a.com</code> was loaded
        over a secure connection, even though the framed data URL was not.
      </div>
    </div>
  </section>

  <section>
    <h3 class="heading settled heading" data-level=5.2 id=should-block-fetch><span class=secno>5.2 </span><span class=content>
      Should fetching <var>request</var> be blocked as mixed content?
    </span><a class=self-link href=#should-block-fetch></a></h3>

<p class=note>Note: The Fetch specification hooks into this algorithm to determine whether
    a request should be entirely blocked (e.g. because the request would be used
    as <a data-link-type=dfn href=#active-content title="active content">active content</a>, and we can <em>assume</em> that it won’t be
    loaded over a secure connection).</p>

<p>Given a <a data-link-type=dfn href=#request title=request>request</a> <var>request</var>, a user agent determines
    whether the <a data-link-type=dfn href=#request title=request>Request</a> <var>request</var>  should proceed or not via the
    following algorithm:</p>

    <ol>
      <li>
        Let <var>context</var> be <var>request</var>’s <code>context</code>.
      </li>
      <li>
        Let <var>client</var> be <var>request</var>’s <code>client</code>.
      </li>
      <li>
        Let <var>environment</var> be the <a data-link-type=dfn href=#javascript-global-environment title="javascript global environment">JavaScript global environment</a>
        with which <var>client</var> is associated.
      </li>
      <li>
        Let <var>origin</var> be the <a data-link-type=dfn href=#origin title=origin>origin</a> of <var>request</var>’s
        <strong>URL</strong>.
      </li>
      <li>
        If <var>origin</var> is a <a data-link-type=dfn href=#private-origin title="private origin">private origin</a>, and
        <var>environment</var>’s <a data-link-type=dfn href=#origin title=origin>origin</a> is a <a data-link-type=dfn href=#public-origin title="public origin">public origin</a>,
        return <strong>blocked</strong>.
      </li>
      <li>
        If <var>environment</var> is not a <a data-link-type=dfn href=#secure-context title="secure context">secure context</a>, return
        <strong>allowed</strong>.
      </li>
      <li>
        If <var>origin</var> is <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure"><em>a priori</em> insecure</a>:

        <ol>
          <li>
            If <var>context</var> is an <a data-link-type=dfn href=#active-request-contexts title="active request context">active request context</a> or
            <a data-link-type=dfn href=#blockable-passive-request-contexts title="blockable passive request context">blockable passive request context</a>, return
            <strong>blocked</strong>.
          </li>
          <li>
            If the user agent is configured to block <a data-link-type=dfn href=#optionally-blockable-passive-content title="optionally blockable passive">optionally blockable
            passive</a> mixed content, return <strong>blocked</strong>.
          </li>
        </ol>
      </li>
      <li>
        Otherwise, <var>origin</var> is <a data-link-type=dfn href=#potentially-secure-origin title="potentially secure">potentially secure</a>, so
        return <strong>allowed</strong>.
      </li>
    </ol>
  </section>

  <section>
    <h3 class="heading settled heading" data-level=5.3 id=should-block-response><span class=secno>5.3 </span><span class=content>
      Should <var>response</var> to <var>request</var> be blocked as mixed
      content?
    </span><a class=self-link href=#should-block-response></a></h3>

<p class=note>Note: <a href=#should-block-fetch>If a request proceeds</a>, we still
    might want to block the response based on the state of the connection
    that generated the response (e.g. because the response would be used as
    <a data-link-type=dfn href=#active-content title="active content">active content</a>, but the server is <a data-link-type=dfn href=#insecure-origin title=insecure>insecure</a>). This algorithm
    is used to make that determination.</p>

<p>Given a <a data-link-type=dfn href=#request title=request>request</a> <var>request</var> and <a data-link-type=dfn href=#response title=response>response</a>
    <var>response</var>, the user agent determines what response should be
    returned via the following algorithm:</p>

    <ol>
      <li>
        Let <var>client</var> be <var>request</var>’s <code>client</code>.
      </li>
      <li>
        Let <var>environment</var> be the <a data-link-type=dfn href=#javascript-global-environment title="javascript global environment">JavaScript global environment</a>
        with which <var>client</var> is associated.
      </li>
      <li>
        If <var>environment</var> is not a <a data-link-type=dfn href=#secure-context title="secure context">secure context</a>, return
        <strong>allowed</strong>.
      </li>
      <li>
        Let <var>context</var> be the <a data-link-type=dfn href=#request-context title="request context">request context</a> of
        <var>request</var>.
      </li>
      <li>
        If <var>context</var> is an <a data-link-type=dfn href=#active-request-contexts title="active request context">active request context</a> or
        <a data-link-type=dfn href=#blockable-passive-request-contexts title="blockable passive request context">blockable passive request context</a>, or the user agent is
        configured to block <a data-link-type=dfn href=#optionally-blockable-passive-content title="optionally blockable passive">optionally blockable passive</a> mixed content:

        <ol>
          <li>
            If the response is not <a data-link-type=dfn href=#tls-protected title=tls-protected>TLS-protected</a>, return
            <strong>blocked</strong>.

<p class=issue id=issue-7701a1bf><a class=self-link href=#issue-7701a1bf></a>This is intended to cover cases in which a ServiceWorker
            responds to a request with an insecure resource. It’s not clear
            that this is the correct place to do that, however, as the
            integration with Fetch isn’t fully specified. It’s also not really
            clear what "insecure" should mean in a ServiceWorker context. We
            accept <code>blob</code> resources, for instance: should we accept
            responses synthesized by the service worker?</p>
          </li>
          <li>
            If the response is only <a data-link-type=dfn href=#weakly-tls-protected title="weakly tls-protected">weakly TLS-protected</a>, return
            <strong>blocked</strong>.

<p class=note>Note: If a user agent is configured to reject <a data-link-type=dfn href=#weakly-tls-protected title="weakly tls-protected">weakly
            TLS-protected</a> resources, we’ll never hit this condition, as
            <a href=http://fetch.spec.whatwg.org/#fetching>step 6 of the Fetch
            algorithm</a> would have returned a network error.</p>
          </li>
          <li>
            If the response’s TLS-protection is <a data-link-type=dfn href=#deprecated-tls-protection title=deprecated>deprecated</a>, return
            <strong>blocked</strong>.

<p class=note>Note: This covers cases in which the TLS handshake succeeds, and the
            resource exceeds the definition of <a data-link-type=dfn href=#weakly-tls-protected title="weakly tls-protected">weakly TLS-protected</a>, but
            the user agent chooses to hold it to a higher standard. The definition
            of <a data-link-type=dfn href=#deprecated-tls-protection title="deprecated tls-protection">deprecated TLS-protection</a> has some examples of these kinds
            of scenarios.</p>
          </li>
        </ol>
      </li>
      <li>Return <strong>allowed</strong>.</li>
    </ol>
  </section>
</section>


<section>
  <h2 class="heading settled heading" data-level=6 id=fetch-integration><span class=secno>6 </span><span class=content>Integration with Fetch</span><a class=self-link href=#fetch-integration></a></h2>

<p>When fetching resources, the mixed content checks described in the algorithms
  above should be inserted at the top of the Fetch algorithm to block network
  traffic to <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origins"><em>a priori</em> insecure origins</a> and <a data-link-type=dfn href=#private-origin title="private origins">private
  origins</a>, and at the bottom of the algorithm, to block responses from
  <a data-link-type=dfn href=#insecure-origin title="insecure origins">insecure origins</a>.</p>

<p>Fetch calls the algorithm defined in
  <a data-section="" href=#should-block-fetch>§5.2 
      Should fetching <var>request</var> be blocked as mixed content?
    </a> during
  <a href=http://fetch.spec.whatwg.org/#fetching>Step 4 of the Fetching
  algorithm</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=biblio-fetch>[FETCH]</a></p>

<p class=note>Note: Hooking into Fetch here ensures that we catch not only the initial
  request, but all redirects as well. That is certainly the intent.</p>

<p>Further, Fetch calls the algorithm defined in
  <a data-section="" href=#should-block-response>§5.3 
      Should <var>response</var> to <var>request</var> be blocked as mixed
      content?
    </a> during
  <a href=http://fetch.spec.whatwg.org/#fetching>Step 7 of the Fetching
  algorithm</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=biblio-fetch>[FETCH]</a></p>

<p class=note>Note: This hook is necessary to detect resources modified or
  synthesized by a ServiceWorker, as well as to determine whether a
  resource is <a data-link-type=dfn href=#insecure-origin title=insecure>insecure</a> once the TLS-handshake has finished. See
  steps 4.1 and 4.2 of the algorithm defined in
  <a data-section="" href=#should-block-response>§5.3 
      Should <var>response</var> to <var>request</var> be blocked as mixed
      content?
    </a> for detail.</p>
</section>


<section>
  <h2 class="heading settled heading" data-level=7 id=websockets-integration><span class=secno>7 </span><span class=content>Modifications to WebSockets</span><a class=self-link href=#websockets-integration></a></h2>

<p>The <a href=http://www.w3.org/TR/2012/CR-websockets-20120920/#the-websocket-interface><code>WebSocket()</code>
  constructor algorithm</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-websockets title=biblio-websockets>[WEBSOCKETS]</a> is modified as follows:</p>

  <ul>
    <li>
      Replace Step 2 with the following steps:

      <ol>
        <li>
          If <var>secure</var> is <strong>false</strong>, but the <a data-link-type=dfn href=#javascript-global-environment title="javascript global environment">JavaScript
          global environment</a> which the <var>entry script</var> is associated
          with is a <a data-link-type=dfn href=#secure-context title="secure context">secure context</a>, then throw a
          <code>SecurityError</code> exception.
        </li>
        <li>
          If the <a data-link-type=dfn href=#origin title=origin>origin</a> of the <a data-link-type=dfn href=#javascript-global-environment title="javascript global environment">JavaScript global environment</a> with
          which the <var>entry script</var> is associated is a <a data-link-type=dfn href=#public-origin title="public origin">public
          origin</a>, and the <a data-link-type=dfn href=#origin title=origin>origin</a> of the <var>url</var> argument is a
          <a data-link-type=dfn href=#private-origin title="private origin">private origin</a>, then throw a <code>SecurityError</code>
          exception.
        </li>
      </ol>
    </li>
  </ul> 

<p>The <a href=http://tools.ietf.org/html/rfc6455#section-4.1>Establish a
  WebSocket Connection algorithm</a> is modified as follows:</p>

  <ol>
    <li>
      After step 5, perform the following step:

      <ol>
        <li>
          If secure is <strong>true</strong>, and the TLS handshake performed
          in step 5 results in a <a data-link-type=dfn href=#weakly-tls-protected title="weakly tls-protected">weakly TLS-protected</a> connection, or the
          TLS-protection is <a data-link-type=dfn href=#deprecated-tls-protection title=deprecated>deprecated</a>,then the client MUST
          <a href=http://tools.ietf.org/html/rfc6455#section-7.1.7>Fail the
          WebSocket Connection</a> and abort the connection.
        </li>
      </ol>
    </li>
  </ol>
</section>


<section>
  <h2 class="heading settled heading" data-level=8 id=acknowledgements><span class=secno>8 </span><span class=content>Acknowledgements</span><a class=self-link href=#acknowledgements></a></h2>

<p>In addition to the wonderful feedback gathered from the WebAppSec WG, the
  Chrome security team was invaluable in preparing this specification. In
  particular, Chris Palmer, Chris Evans, Ryan Sleevi, Michal Zalewski, Ken
  Buchanan, and Tom Sepez gave lots of early feedback. Anne van Kesteren
  explained Fetch and helped define the interface to this specification.</p>
</section>

<h2 class="no-ref no-num heading settled heading" id=conformance><span class=content>Conformance</span><a class=self-link href=#conformance></a></h2>

<h3 class="no-ref no-num heading settled heading" id=conventions><span class=content>Document conventions</span><a class=self-link href=#conventions></a></h3>

    <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc2119 title=biblio-rfc2119>[RFC2119]</a></p>

    <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    <div class=example>
        <p>This is an example of an informative example.</p>
    </div>

    <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    <p class=note>Note, this is an informative note.</p>

<h3 class="no-ref no-num heading settled heading" id=conformant-algorithms><span class=content>Conformant Algorithms</span><a class=self-link href=#conformant-algorithms></a></h3>

    <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>

    <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>

<h3 class="no-ref no-num heading settled heading" id=conformance-classes><span class=content>Conformance Classes</span><a class=self-link href=#conformance-classes></a></h3>

    <p>A <dfn data-dfn-type=dfn data-noexport="" id=conformant-user-agent>conformant user agent<a class=self-link href=#conformant-user-agent></a></dfn> must implement all the requirements
    listed in this specification that are applicable to user agents.</p>

    <p>A <dfn data-dfn-type=dfn data-noexport="" id=conformant-server>conformant server<a class=self-link href=#conformant-server></a></dfn> must implement all the requirements listed
    in this specification that are applicable to servers.</p>


<h2 class="no-num no-ref heading settled heading" id=references><span class=content>
References</span><a class=self-link href=#references></a></h2>

<h3 class="no-num no-ref heading settled heading" id=normative><span class=content>
Normative References</span><a class=self-link href=#normative></a></h3>
<div data-fill-with=normative-references><dl>
<dt id=biblio-beacon title=BEACON><a class=self-link href=#biblio-beacon></a>[BEACON]<dd>Jatinder Mann; Alois Reitbauer. <a href=http://www.w3.org/TR/beacon/>Beacon</a>. WD. URL: <a href=http://www.w3.org/TR/beacon/>http://www.w3.org/TR/beacon/</a></dd>
<dt id=biblio-cab title=CAB><a class=self-link href=#biblio-cab></a>[CAB]<dd>???. <a href=https://cabforum.org/baseline-requirements-documents/>CA/Browser Forum Baseline Requirements v1.1.8</a>. URL: <a href=https://cabforum.org/baseline-requirements-documents/>https://cabforum.org/baseline-requirements-documents/</a></dd>
<dt id=biblio-css21 title=CSS21><a class=self-link href=#biblio-css21></a>[CSS21]<dd>Bert Bos; et al. <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607>http://www.w3.org/TR/2011/REC-CSS2-20110607</a></dd>
<dt id=biblio-css3-webfonts title=CSS3-WEBFONTS><a class=self-link href=#biblio-css3-webfonts></a>[CSS3-WEBFONTS]<dd>Michel Suignard; Chris Lilley. <a href=http://www.w3.org/TR/2002/WD-css3-webfonts-20020802>CSS3 module: Web Fonts</a>. 2 August 2002. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2002/WD-css3-webfonts-20020802>http://www.w3.org/TR/2002/WD-css3-webfonts-20020802</a></dd>
<dt id=biblio-ecma-262 title=ECMA-262><a class=self-link href=#biblio-ecma-262></a>[ECMA-262]<dd>???. <a href=http://www.ecma-international.org/publications/standards/Ecma-262.htm>ECMAScript Language Specification, Third Edition</a>. December 1999. URL: <a href=http://www.ecma-international.org/publications/standards/Ecma-262.htm>http://www.ecma-international.org/publications/standards/Ecma-262.htm</a></dd>
<dt id=biblio-eventsource title=EVENTSOURCE><a class=self-link href=#biblio-eventsource></a>[EVENTSOURCE]<dd>Ian Hickson. <a href=http://www.w3.org/TR/2012/CR-eventsource-20121211/>Server-Sent Events</a>. 11 December 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-eventsource-20121211/>http://www.w3.org/TR/2012/CR-eventsource-20121211/</a></dd>
<dt id=biblio-fetch title=FETCH><a class=self-link href=#biblio-fetch></a>[FETCH]<dd>Anne van Kesteren. <a href=http://fetch.spec.whatwg.org/>Fetch</a>. Living Standard. URL: <a href=http://fetch.spec.whatwg.org/>http://fetch.spec.whatwg.org/</a></dd>
<dt id=biblio-filter-effects title=FILTER-EFFECTS><a class=self-link href=#biblio-filter-effects></a>[FILTER-EFFECTS]<dd>Dean Jackson; Erik Dahlström; Dirk Schulze. <a href=http://www.w3.org/TR/2013/WD-filter-effects-20130523/>Filter Effects 1.0</a>. 23 May 2013. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2013/WD-filter-effects-20130523/>http://www.w3.org/TR/2013/WD-filter-effects-20130523/</a></dd>
<dt id=biblio-html-imports title=HTML-IMPORTS><a class=self-link href=#biblio-html-imports></a>[HTML-IMPORTS]<dd>Dmitri Glazkov; Hajime Morrita. <a href=http://www.w3.org/TR/html-imports/>HTML Imports</a>. WD. URL: <a href=http://www.w3.org/TR/html-imports/>http://www.w3.org/TR/html-imports/</a></dd>
<dt id=biblio-html5 title=HTML5><a class=self-link href=#biblio-html5></a>[HTML5]<dd>Robin Berjon; et al. <a href=http://www.w3.org/TR/2013/CR-html5-20130806/>HTML5</a>. 6 August 2013. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2013/CR-html5-20130806/>http://www.w3.org/TR/2013/CR-html5-20130806/</a></dd>
<dt id=biblio-manifest title=MANIFEST><a class=self-link href=#biblio-manifest></a>[MANIFEST]<dd>Marcos Caceres; Anssi Kostiainen; Kenneth Rohde Christiansen. <a href=http://w3c.github.io/manifest/>Manifest for web application</a>. WD. URL: <a href=http://w3c.github.io/manifest/>http://w3c.github.io/manifest/</a></dd>
<dt id=biblio-rfc1918 title=RFC1918><a class=self-link href=#biblio-rfc1918></a>[RFC1918]<dd>Yakov Rekhter; et al. <a href=http://www.ietf.org/rfc/rfc1918.txt>Address Allocation for Private Internets</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc1918.txt>http://www.ietf.org/rfc/rfc1918.txt</a></dd>
<dt id=biblio-rfc2119 title=RFC2119><a class=self-link href=#biblio-rfc2119></a>[RFC2119]<dd>S. Bradner. <a href=http://www.ietf.org/rfc/rfc2119.txt>Key words for use in RFCs to Indicate Requirement Levels</a>. URL: <a href=http://www.ietf.org/rfc/rfc2119.txt>http://www.ietf.org/rfc/rfc2119.txt</a></dd>
<dt id=biblio-rfc4632 title=RFC4632><a class=self-link href=#biblio-rfc4632></a>[RFC4632]<dd>Vince Fuller; Tony Li. <a href=http://www.ietf.org/rfc/rfc4632.txt>Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc4632.txt>http://www.ietf.org/rfc/rfc4632.txt</a></dd>
<dt id=biblio-rfc6454 title=RFC6454><a class=self-link href=#biblio-rfc6454></a>[RFC6454]<dd>Adam Barth. <a href=http://www.ietf.org/rfc/rfc6454.txt>The Web Origin Concept</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc6454.txt>http://www.ietf.org/rfc/rfc6454.txt</a></dd>
<dt id=biblio-serviceworkers title=SERVICEWORKERS><a class=self-link href=#biblio-serviceworkers></a>[SERVICEWORKERS]<dd>Alex Russell; Jungkee Song. <a href=http://www.w3.org/TR/service-workers/>Service Workers</a>. WD. URL: <a href=http://www.w3.org/TR/service-workers/>http://www.w3.org/TR/service-workers/</a></dd>
<dt id=biblio-svg2 title=SVG2><a class=self-link href=#biblio-svg2></a>[SVG2]<dd>Nikos Andronikos; et al. <a href=http://www.w3.org/TR/2013/WD-SVG2-20130618/>Scalable Vector Graphics (SVG) 2</a>. 18 June 2013. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2013/WD-SVG2-20130618/>http://www.w3.org/TR/2013/WD-SVG2-20130618/</a></dd>
<dt id=biblio-websockets title=WEBSOCKETS><a class=self-link href=#biblio-websockets></a>[WEBSOCKETS]<dd>Ian Hickson. <a href=http://www.w3.org/TR/2012/CR-websockets-20120920/>The WebSocket API</a>. 20 September 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-websockets-20120920/>http://www.w3.org/TR/2012/CR-websockets-20120920/</a></dd>
<dt id=biblio-workers title=WORKERS><a class=self-link href=#biblio-workers></a>[WORKERS]<dd>Ian Hickson. <a href=http://www.w3.org/TR/2012/CR-workers-20120501/>Web Workers</a>. 1 May 2012. W3C Candidate Recommendation. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/CR-workers-20120501/>http://www.w3.org/TR/2012/CR-workers-20120501/</a></dd>
<dt id=biblio-wsc-ui title=WSC-UI><a class=self-link href=#biblio-wsc-ui></a>[WSC-UI]<dd>Thomas Roessler; Anil Saldhana. <a href=http://www.w3.org/TR/2010/REC-wsc-ui-20100812/>Web Security Context: User Interface Guidelines</a>. 12 August 2010. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2010/REC-wsc-ui-20100812/>http://www.w3.org/TR/2010/REC-wsc-ui-20100812/</a></dd>
<dt id=biblio-xmlhttprequest title=XMLHTTPREQUEST><a class=self-link href=#biblio-xmlhttprequest></a>[XMLHTTPREQUEST]<dd>Julian Aubourg; 송정기 (Jungkee Song); Hallvord R. M. Steen. <a href=http://www.w3.org/TR/2012/WD-XMLHttpRequest-20121206/>XMLHttpRequest</a>. 6 December 2012. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2012/WD-XMLHttpRequest-20121206/>http://www.w3.org/TR/2012/WD-XMLHttpRequest-20121206/</a></dd>
<dt id=biblio-xslt title=XSLT><a class=self-link href=#biblio-xslt></a>[XSLT]<dd>James Clark. <a href=http://www.w3.org/TR/1999/REC-xslt-19991116>XSL Transformations (XSLT) Version 1.0</a>. 16 November 1999. W3C Recommendation. URL: <a href=http://www.w3.org/TR/1999/REC-xslt-19991116>http://www.w3.org/TR/1999/REC-xslt-19991116</a></dd>
</dl></div>

<h3 class="no-num no-ref heading settled heading" id=informative><span class=content>
Informative References</span><a class=self-link href=#informative></a></h3>
<div data-fill-with=informative-references><dl>
<dt id=biblio-rfc6797 title=RFC6797><a class=self-link href=#biblio-rfc6797></a>[RFC6797]<dd>Jeff Hodges; Collin Jackson; Adam Barth. <a href=http://www.ietf.org/rfc/rfc6797.txt>HTTP Strict Transport Security (HSTS)</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc6797.txt>http://www.ietf.org/rfc/rfc6797.txt</a></dd>
<dt id=biblio-uri title=URI><a class=self-link href=#biblio-uri></a>[URI]<dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href=http://www.ietf.org/rfc/rfc3986.txt>Uniform Resource Identifiers (URI): generic syntax</a>. January 2005. URL: <a href=http://www.ietf.org/rfc/rfc3986.txt>http://www.ietf.org/rfc/rfc3986.txt</a></dd>
</dl></div>

<h2 class="no-num no-ref heading settled heading" id=index><span class=content>
Index</span><a class=self-link href=#index></a></h2>
<div data-fill-with=index><ul class=indexlist>
<li>active, <a href=#active-content title="section 3.1">3.1</a>
<li>active content, <a href=#active-content title="section 3.1">3.1</a>
<li>active request contexts, <a href=#active-request-contexts title="section 3.1">3.1</a>
<li>a priori insecure, <a href=#a-priori-insecure-origin title="section 2.1">2.1</a>
<li>a priori insecure origin, <a href=#a-priori-insecure-origin title="section 2.1">2.1</a>
<li>blockable, <a href=#blockable-passive-content title="section 3.2.2">3.2.2</a>
<li>blockable passive, <a href=#blockable-passive-content title="section 3.2.2">3.2.2</a>
<li>blockable passive content, <a href=#blockable-passive-content title="section 3.2.2">3.2.2</a>
<li>blockable passive
      request contexts, <a href=#blockable-passive-request-contexts title="section 3.2.2">3.2.2</a>
<li>client, <a href=#request-client title="section 2.2">2.2</a>
<li>conformant server, <a href=#conformant-server title="section Unnumbered section">Unnumbered section</a>
<li>conformant user agent, <a href=#conformant-user-agent title="section Unnumbered section">Unnumbered section</a>
<li>context, <a href=#request-context title="section 2.2">2.2</a>
<li>deprecated, <a href=#deprecated-tls-protection title="section 2.1">2.1</a>
<li>deprecated TLS-protection, <a href=#deprecated-tls-protection title="section 2.1">2.1</a>
<li>fetch, <a href=#fetch title="section 2.2">2.2</a>
<li>global environment, <a href=#javascript-global-environment title="section 2.2">2.2</a>
<li>globally unique identifier, <a href=#globally-unique-identifier title="section 2.2">2.2</a>
<li>insecure, <a href=#insecure-origin title="section 2.1">2.1</a>
<li>insecure origin, <a href=#insecure-origin title="section 2.1">2.1</a>
<li>Internal
          Name, <a href=#internal-name title="section 2.1">2.1</a>
<li>JavaScript global environment, <a href=#javascript-global-environment title="section 2.2">2.2</a>
<li>mixed, <a href=#mixed-content title="section 2.1">2.1</a>
<li>mixed content, <a href=#mixed-content title="section 2.1">2.1</a>
<li>navigational request contexts, <a href=#navigational-request-contexts title="section 3">3</a>
<li>network error, <a href=#network-error title="section 2.2">2.2</a>
<li>optionally blockable, <a href=#optionally-blockable-passive-content title="section 3.2.1">3.2.1</a>
<li>optionally blockable passive, <a href=#optionally-blockable-passive-content title="section 3.2.1">3.2.1</a>
<li>optionally blockable passive content, <a href=#optionally-blockable-passive-content title="section 3.2.1">3.2.1</a>
<li>optionally blockable passive request
      contexts, <a href=#optionally-blockable-passive-request-contexts title="section 3.2.1">3.2.1</a>
<li>origin, <a href=#origin title="section 2.2">2.2</a>
<li>passive, <a href=#passive-content title="section 3.2">3.2</a>
<li>passive content, <a href=#passive-content title="section 3.2">3.2</a>
<li>potentially secure, <a href=#potentially-secure-origin title="section 2.1">2.1</a>
<li>potentially secure origin, <a href=#potentially-secure-origin title="section 2.1">2.1</a>
<li>private, <a href=#private-origin title="section 2.1">2.1</a>
<li>private address space, <a href=#private-address-space title="section 2.1">2.1</a>
<li>private origin, <a href=#private-origin title="section 2.1">2.1</a>
<li>public, <a href=#public-origin title="section 2.1">2.1</a>
<li>public origin, <a href=#public-origin title="section 2.1">2.1</a>
<li>request, <a href=#request title="section 2.2">2.2</a>
<li>request client, <a href=#request-client title="section 2.2">2.2</a>
<li>request context, <a href=#request-context title="section 2.2">2.2</a>
<li>response, <a href=#response title="section 2.2">2.2</a>
<li>secure context, <a href=#secure-context title="section 5.1">5.1</a>
<li>TLS-protected, <a href=#tls-protected title="section 2.2">2.2</a>
<li>weak, <a href=#weakly-tls-protected title="section 2.2">2.2</a>
<li>weakly TLS-protected, <a href=#weakly-tls-protected title="section 2.2">2.2</a>
</ul></div>



<h2 class="no-num heading settled" id=issues-index><span class=content>Issues Index</span><a class=self-link href=#issues-index></a></h2><div style="counter-reset: issue"><div class=issue>Should form submissions to an insecure origin be considered active
    content? I suspect they should, though I’m not sure we can get away with
    it in a web-compatible way.<a href=#issue-967b8a81> ↵ </a></div>
  <div class=issue>Should the presence of a form with an <a data-link-type=element-attr href=http://www.w3.org/TR/html5/forms.html#attr-fs-action title=action>action</a>
    attribute representing an <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origin"><em>a priori</em> insecure origin</a> be
    considered passive mixed content?<a href=#issue-8a84ed46> ↵ </a></div>

    <div class=issue>This is intended to cover cases in which a ServiceWorker
            responds to a request with an insecure resource. It’s not clear
            that this is the correct place to do that, however, as the
            integration with Fetch isn’t fully specified. It’s also not really
            clear what "insecure" should mean in a ServiceWorker context. We
            accept <code>blob</code> resources, for instance: should we accept
            responses synthesized by the service worker?<a href=#issue-7701a1bf> ↵ </a></div>
          </div>
